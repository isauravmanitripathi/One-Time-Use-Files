Historically, Cox et al. (1979) introduced their binomial option pricing model after the seminal work of Black and Scholes (1973), and also Merton (1973). Surprisingly, the *Cox-Ross-Rubinstein-*model (CRR) is not a further stage of the *Black-Scholes-*model, but a simplification. Cox et al. engineered an option pricing model, based merely on fundamental algebraic operations, which in a certain limit approaches the *Black*-*Scholes*-model, but avoids the advanced mathematical machinery. Thus, the CRR-model seems a natural and pedagogical starting point.

#### 12.1 The Coin Flip Universe

Let's start with the very easiest setting of a financial market we can think of. Such a market is characterized by:

- only two discrete points in time,  $t=0$  (today) and  $t=T$  (in the future), where trading is possible,
- two possible states of the world at time  $T$ , "up" ( $\uparrow$ ) and "down" ( $\downarrow$ ),
- only one stock S with known price at  $t = 0$ ,
- a zero risk-free interest rate.
- no market frictions, trading costs, or short-selling constraints,
- infinite divisibility of assets.

Further assume that the initial price of the stock is  $S_0 = 100$  units of currency, and that the states  $\omega = \uparrow$  and  $\omega = \downarrow$  occur with equal probability  $p = \frac{1}{2}$ . You can think of this setting as a single time coin flip universe. Observe that in such a market all possible option contracts have European exercise right. The price of the stock at  $t = T$  is random, with

$$S_T(\omega) = \begin{cases} 120 & \text{for } \omega = \uparrow \\ 90 & \text{for } \omega = \downarrow. \end{cases} \tag{12.1}$$

The situation is illustrated in Figure 12.1 left. Let us now introduce a call option on the stock S into this market, with an exercise price of  $K = 105$ . The payoff of this option at expiry  $T$  is also random, with

$$C_T(\omega) = \begin{cases} 15 & \text{for } \omega = \uparrow \\ 0 & \text{for } \omega = \downarrow. \end{cases} \tag{12.2}$$

![](_page_1_Figure_1.jpeg)

**Fig. 12.1** One period binomial option pricing model – Stock market (left) and extended market with one derivative (right)

To be a little more precise, the value of the option at *t* =*T* is measurable with respect to the σ-algebra F*T*, generated by *ST*.

**Quick calculation 12.1** What is the σ-algebra F*T*?

The possible values of the call option and the underlying are illustrated in Figure 12.1 right. The big question is, what is the fair price of the call option at *t* = 0? You may be tempted to answer *C*<sup>0</sup> = 7.5, because that is the expected payoff at expiry, but that is the wrong idea. In fact there are two ways to figure out the correct price, both completely equivalent. We have already encountered this duality in Chapter 5.

Let's try to build a hedge-portfolio of one call option and short half a stock,

$$\Pi_t = C_t - \frac{1}{2} S_t. \n$$
(12.3)

At this point it is far from clear, why half a unit of the stock should be shorted, so let's think of it as an educated guess for the moment. What is the value of this portfolio at expiry *T*? Figure 12.2 provides the answer. Obviously, the payoff does not depend on the state of the world at all. If the value of the portfolio at expiry is Π*<sup>T</sup>* = −45 in all possible states, then the initial value has to be also

$$\Pi_0 = C_0 - 50 = -45. \n$$
(12.4)

From this requirement we can easily conclude that *C*<sup>0</sup> = 5 has to hold. Let's now answer the question of how we made our educated guess in the first place. The whole setup only

![](_page_1_Figure_11.jpeg)

**Fig. 12.2** Hedge-portfolio for the call option in the one period binomial model

![](_page_2_Figure_1.jpeg)

**Fig. 12.3** Underlying with call option under the alternative probability measure *Q*

works, if the payoff at expiry is identical in both states of the world. In other words, we are looking for a hedge-ratio ∆, such that

$$C_T(\uparrow) - \Delta \cdot S_T(\uparrow) = C_T(\downarrow) - \Delta \cdot S_T(\downarrow) \tag{12.5}$$

holds. Rearranging (12.5) yields the desired condition

$$\Delta = \frac{C_T(\uparrow) - C_T(\downarrow)}{S_T(\uparrow) - S_T(\downarrow)} = \frac{\Delta C_T}{\Delta S_T}.$$
(12.6)

This hedge-ratio will show up again in a different guise in the *Black–Scholes*-theory. Leave it that way for the moment and let's see how the dual pricing procedure works.

**Quick calculation 12.2** Verify that the hedge-ratio in the above toy market is ∆ = <sup>1</sup> 2 .

Let's again look at the same option valuation problem, but now, just for fun, choose other probabilities. To avoid confusion, call the alternative probability measure *Q*, and choose *q* = 1 3 , as indicated in Figure 12.3. Now, let's make the following observation: Under the probability measure *Q*, the expected terminal stock price is

$$E^{Q}[S_{T}] = \frac{1}{3} \cdot 120 + \frac{2}{3} \cdot 90 = 40 + 60 = 100. \tag{12.7}$$

But that is exactly today's price of the stock, *S*0. This means that *S<sup>t</sup>* is a martingale under the alternative probability measure *Q*. We can emphasize this by including the information set F<sup>0</sup> and writing

$$E^{\mathcal{Q}}[S_T|\mathcal{F}_0] = S_0. \tag{12.8}$$

The deeper meaning of explicitly conditioning on F<sup>0</sup> is that we have to know *S*<sup>0</sup> to be able to determine the probability *q* in the first place. We can obtain *q* by solving

$$S_0 = q \cdot S_T(\uparrow) + (1 - q) \cdot S_T(\downarrow), \tag{12.9}$$

because we can unambiguously tell what value S took at  $t = 0$ . The key advantage of the martingale measure  $Q$  is that it holds for all securities traded in the market. We can check this for the call option

$$E^{Q}[C_{T}|\mathcal{F}_{0}] = \frac{1}{3} \cdot 15 + \frac{2}{3} \cdot 0 = 5 = C_{0}.$$
 (12.10)

Note that once such an equivalent martingale measure is established, it is the same for all contracts that can potentially be traded in the market. In pricing via an arbitrage portfolio, we have to compute an individual hedge-ratio for each contract separately.

## 12.2

## The Multi-Period Rinomial Model

We will now relax some of the restrictions we imposed on our coin flip toy market. In particular, we will allow

- multi-period trading at discrete points in time  $t = 0, \ldots, T$ ,
- a nonzero risk-free interest rate r.

Think of this setup as an independently, T times repeated coin flip. The successive prices of the stock S are given by

$$S_{t+1} = \begin{cases} u \cdot S_t & \text{for } \omega_{t+1} = \uparrow \\ d \cdot S_t & \text{for } \omega_{t+1} = \downarrow, \end{cases}$$
(12.11)

see Figure 12.4, where  $\omega_{t+1}$  is a somewhat sloppy shorthand for all states that are either 'up' or 'down' at  $t + 1$ . The coefficients u and d are just numbers, yet to be determined. The only requirement is the condition

$$0 < d < 1 + r\Delta t < u,\tag{12.12}$$

otherwise we would generate an arbitrage opportunity. Note that in this multi-period setting we can by all means have contracts with American exercise right. Figure 12.5 illustrates a two-period version of the so-called binomial tree. We will indicate the

![](_page_3_Figure_14.jpeg)

Fig. 12.4 Notational conventions in the binomial model

![](_page_4_Figure_1.jpeg)

**Fig. 12.5** Two-period version of the binomial tree

probabilities only on the first branch, because they remain unchanged for the whole tree. Finally, let's introduce a more efficient notation for the vertices of the tree. Let's call *S* (*n*) *t* the price of the stock at time *t* at the *n*-th ascending vertex, for *t* = 1, . . . , *T* and *n* = 0, . . . , *t*; see Figure 12.6. Of course *S*<sup>0</sup> is only a single vertex and we do not need an additional label. We can now easily see that every vertex in the tree is described by

$$S_t^{(n)} = u^n d^{t-n} S_0. \t\t(12.13)$$

Does this remind you of something? It looks almost like a binomial distribution. Indeed *S<sup>t</sup>* is a binomial random variable with probability mass function

$$f_n(S_t) = P(S_t = S_t^{(n)}) = {t \choose n} p^n (1-p)^{t-n}.$$
(12.14)

In order to proceed with the binomial model, we have to discuss equivalent martingale measures in a little more detail.

![](_page_4_Figure_8.jpeg)

**Fig. 12.6** Efficient notation for the two-period version of the binomial tree

What we really need in order to compute security prices, is a traded and strictly positive numéraire quantity  $N$ , and associated with it, a certain equivalent probability measure  $P_N$ , such that the ratio

$$\frac{S_t}{N_t} = E^{P_N} \left[ \frac{S_T}{N_T} \middle| \mathcal{F}_t \right] \tag{12.15}$$

is a martingale under the measure  $P_N$ ; hence the name equivalent martingale measure. Let's for example choose our bank account as the numéraire,

$$N_t = B(t) = e^{rt},\tag{12.16}$$

and let's call the martingale measure associated with it  $O$ . We thus have

$$e^{-rt}S_t = E^{\mathcal{Q}}[e^{-rT}S_T|\mathcal{F}_t].\tag{12.17}$$

Because r is constant and known, it factors out of the conditional expectation and after trivial rearrangements we have

$$S_t = e^{-r(T-t)} E^{\mathcal{Q}}[S_T|\mathcal{F}_t]. \tag{12.18}$$

What the martingale pricing principle says is that under the probability measure O, the price of every security should equal the discounted expected price in the future, based on today's information. Because only a risk-neutral agent would price a security solely based on its expected payoff, the measure  $Q$  is often called the risk-neutral probability measure. Every security, including derivatives, traded in the market, has to obey this relation. The delicate piece of reasoning is to compute this magnificent probability measure. Let's see how this is done in the binomial model.

Traditionally, compounding is done discretely in the binomial model. It mirrors the discrete nature of the model setup. Translating  $(12.18)$  into this framework, we can eventually derive the relation

$$S_t = \frac{1}{1 + r\Delta t} E^{\mathcal{Q}}[S_{t+1}|\mathcal{F}_t]$$
  
= 
$$\frac{1}{1 + r\Delta t} (q \cdot u \cdot S_t + (1 - q) \cdot d \cdot S_t).$$
 (12.19)

The stock price  $S_t$  cancels out of the equation and after a few rearrangements we obtain

$$q = \frac{1 + r\Delta t - d}{u - d}.\tag{12.20}$$

**Quick calculation 12.3** Verify this result.

That is a nice and very powerful result. In particular, we are still free to choose  $u$  and  $d$ , as long as the no-arbitrage condition (12.12) is satisfied. Here are some ideas on choosing  $u$  and  $d$  that may come in handy. You may want the tree to arrive at the same

value after one up and one down turn, or equivalently after one down and one up turn. Let's call such a tree stable. It is easy to see that a stable tree requires the simple condition

$$u \cdot d = 1. \tag{12.21}$$

**Quick calculation 12.4** Confirm that a stable tree implies *S* (*n*) *<sup>t</sup>* = *S* (*n*+1) *t*+2 .

You may also want to choose *u* and *d* such that the magnitude of volatility of the stock is roughly preserved. There are several possible parametrizations, but a particularly neat choice is √

$$u/d = e^{\pm \sigma \sqrt{\Delta t}}.\t(12.22)$$

**Quick calculation 12.5** Convince yourself that this choice is also stable.

Of course we are under no obligation to choose *u* and *d* in any predetermined way, as long as we ensure that the no-arbitrage limits (12.12) are respected.

## **12.3 Valuating a European Call in the Binomial Model**

Finally, we get to valuating our first option contract in the binomial model. To keep the notation compact, remember that the probability to occupy the *n*-th vertex of the tree at time *t* is given by the binomial distribution, and write for the probability mass function

• • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • •

$$\mathcal{B}_n(q,t) = \binom{t}{n} q^n (1-q)^{t-n}.$$
(12.23)

The payoff function of a European plain vanilla call option is *C<sup>T</sup>* = (*S<sup>T</sup>* − *K*) + . In the binomial model this function is approximated by the vertices in the terminal time slice *T*, and we have

$$C_T^{(n)} = (S_T^{(n)} - K)^+ = (u^n d^{T-n} S_0 - K)^+.$$
 (12.24)

The situation is sketched schematically in Figure 12.7, where a small collection of branches and vertices is indicated. Note that *T* is not the expiry date of the option, but merely the discrete number of time slices used in the binomial model. At *t* = 0, the time to expiry is τ = ∆*t* · *T*. We can now price the option contract by calculating the discounted expected payoff of the call option under the probability measure *Q*. We already know how to switch from measure *P* to measure *Q*, once we have fixed *u* and *d*; see (12.20). Once we know *q*, the fair value of the call option at *t* = 0 is

$$C_{0} = \frac{1}{(1+r\Delta t)^{T}} E^{Q}[C_{T}|\mathcal{F}_{0}]$$
  

$$= \frac{1}{(1+r\Delta t)^{T}} \sum_{n=0}^{T} \mathcal{B}_{n}(q,T) \cdot C_{T}^{(n)}$$
  

$$= \frac{1}{(1+r\Delta t)^{T}} \sum_{n=0}^{T} {T \choose n} q^{n} (1-q)^{T-n} \cdot (u^{n} d^{T-n} S_{0} - K)^{+}.$$
  
(12.25)

![](_page_7_Figure_1.jpeg)

**Fig. 12.7** Valuation scheme for a European plain vanilla call option in the binomial model

In principle we are done, because (12.25) is a perfectly explicit formula. But it is not a very efficient one. For all *n*, such that *S* (*n*) *T* ≤ *K*, the payoff is zero, and computation of the associated sum terms is a waste of time. But we can do better. Let *a* be the smallest integer, such that

$$u^a d^{T-a} S_0 > K. \t\t(12.26)$$

Taking logarithms on both sides and solving for *a* yields

$$a > \frac{\log(K/S_0) - T\log d}{\log(u/d)}.\t(12.27)$$

**Quick calculation 12.6** Verify this result.

For all *n* < *a* the payoff vanishes and the sum terms are zero. For all *n* ≥ *a* the payoff function is

$$C_T^{(n)} = u^n d^{T-n} S_0 - K. \t\t(12.28)$$

The maximum function has disappeared, because by definition of *a*, the payoff is positive. So we can write the call price as

$$C_0 = S_0 \sum_{n=a}^{T} \binom{T}{n} q^n (1-q)^{T-n} \frac{u^n d^{T-n}}{(1+r\Delta t)^T} - \frac{K}{(1+r\Delta t)^T} \sum_{n=a}^{T} \binom{T}{n} q^n (1-q)^{T-n}.$$
 (12.29)

There is one more clever move we can make. Focus on the first term on the right hand side of (12.29) and realize that

$$q^{n}(1-q)^{T-n} \cdot \frac{u^{n}d^{T-n}}{(1+r\Delta t)^{T}} = \left(\frac{uq}{1+r\Delta t}\right)^{n} \cdot \left(\frac{d(1-q)}{1+r\Delta t}\right)^{T-n} \tag{12.30}$$

holds, and define

$$q' = \frac{u}{1 + r\Delta t} \cdot q. \tag{12.31}$$

**Quick calculation 12.7** Show that the definition of *q* implies 1 − *q* ′ = *d* 1+*r*∆*t* (1 − *q*).

Putting all the pieces together, we can now write our first option pricing formula in its most efficient form

$$C_0(K,T) = S_0 \sum_{n=a}^{T} \mathcal{B}_n(q',T) - \frac{K}{(1+r\Delta t)^T} \sum_{n=a}^{T} \mathcal{B}_n(q,T), \qquad (12.32)$$

with

$$a = \min\left\{n \in \mathbb{N}_0 : n > \frac{\log(K/S_0) - T\log d}{\log(u/d)}\right\},\$$

$$q = \frac{1 + r\Delta t - d}{u - d}, \quad \text{and} \quad q' = \frac{u}{1 + r\Delta t} \cdot q.$$
(12.33)

Let's see how this works in an example.

## **Example 12.1**

To illustrate the whole pricing procedure let's compute the fair value of a European call option with the following features:

- current price of the underlying *S*<sup>0</sup> = 100,
- exercise price *K* = 105,
- time to expiry τ = 1 year,
- annual risk-free interest rate *r* = 8%.

For the valuation process, we choose ∆*t* = 0.25, which means that we have *T* = τ ∆*t* = 4, and *u*/*d* = 1 ± 0.1.

## Valuation in the binomial model

The first step is the computation of the risk-neutral probability *q*. Plugging in the given quantities, one obtains

$$q = \frac{1 + r\Delta t - d}{u - d} = \frac{1 + 0.02 - 0.9}{1.1 - 0.9} = 0.6.$$

With this, one can immediately compute *q* ′ = 0.647. To identify the exercise threshold *a*, evaluate

$$\frac{\log(K/S_0) - T\log d}{\log(u/d)} = \frac{\log 1.05 - 4\log 0.9}{\log 1.222} = 2.345,$$

from which we can conclude that *a* = 3 is the smallest integer to induce a positive payoff. We have thus the intermediate result

$$C_0(105,4) = 100 \sum_{n=3}^{4} \mathcal{B}_n(0.647,4) - \frac{105}{(1+0.02)^4} \sum_{n=3}^{4} \mathcal{B}_n(0.6,4).$$

The computation of the B*n*s is according to (12.23). One obtains

$$\mathcal{B}_3(0.647, 4) = 0.3824, \quad \mathcal{B}_4(0.647, 4) = 0.1752,$$

and

$$\mathcal{B}_3(0.6, 4) = 0.3456, \quad \mathcal{B}_4(0.6, 4) = 0.1296.$$

Putting all the pieces together, the fair price of the call option is

$$C_0(105, 4) = 100 \cdot 0.5576 - 97 \cdot 0.4752 = 9.67.$$

Consider another kind of European call option, the binary call. Its payoff function in terms of the vertices in the terminal time slice is

$$C_T^{B^{(n)}} = \theta(S_T^{(n)} - K) = \theta(u^n d^{T-n} S_0 - K), \qquad (12.34)$$

where  $\theta(x)$  is the *Heaviside-* $\theta$ -function, defined by

$$\theta(x) = \begin{cases} 1 & \text{if } x \ge 0 \\ 0 & \text{if } x < 0. \end{cases} \tag{12.35}$$

Observe that for  $n < a$ , the payoff is still zero, but for  $n \ge a$ , the payoff is simply one. Thus we can write a very neat option pricing formula for the binary call in the binomial model

$$C_0^B(K,T) = \frac{1}{(1+r\Delta t)^T} \sum_{n=a}^T \mathcal{B}_n(q,T),$$
 (12.36)

where a and q are to be chosen as in (12.33). That is a spectacularly easy formula, so let's see how the option price is computed in a concrete example.

## Example 12.2

To demonstrate the computation of the fair value of a European binary call option, a setup nearly identical to Example 12.1 is used. In particular:

- current price of the underlying  $S_0 = 100$ ,
- exercise price  $K = 105$ ,
- time to expiry  $\tau = 1$  year,
- annual risk-free interest rate  $r = 10\%$ .

The tree structure is again given by  $u/d = 1 \pm 0.1$ , but this time  $\Delta t = 0.5$  is chosen, which means that  $T = \frac{\tau}{\Delta t} = 2$ .

## Valuation in the binomial model

Again, the first step is the computation of the risk-neutral probability  $q$ . Using the given quantities, one obtains

$$q = \frac{1 + r\Delta t - d}{u - d} = \frac{1 + 0.05 - 0.9}{1.1 - 0.9} = 0.75.$$

The exercise boundary *a*, can be found by evaluating

$$\frac{\log(K/S_0) - T\log d}{\log(u/d)} = \frac{\log 1.05 - 2\log 0.9}{\log 1.222} = 1.294,$$

from which one can conclude that *a* = 2 is the smallest integer to be considered. Thus, the desired option value is

$$C_0^{\mathcal{B}}(105,2) = \frac{1}{(1+0.05)^2} \cdot \mathcal{B}_2(0.75,2) = 0.907 \cdot 0.5625 = 0.51.$$

## **12.4 Backward Valuation and American Options**

Options with American exercise right allow the holder to exercise the option at any time during the lifetime of the contract. This feature causes a far reaching problem, because the value of the contract is no longer entirely determined by its payoff at expiry. To price option contracts with American exercise right, we have first to study an alternative valuation method, called "backward valuation" or "valuation down the tree."

• • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • •

Let's stick to a problem we already know. In Example 12.1, we valued a European plain vanilla call option. Take a closer look at the tree we used to compute the fair option price. This tree is illustrated in Figure 12.8. All stock-vertices have been calculated, and we know the payoff of the option at expiry. That means, we also know the option-vertices in the terminal time slice *T*. From our martingale pricing principle, we can write

$$C_{t-1}^{(n)} = \frac{1}{1 + r\Delta t} E^{\mathcal{Q}}[C_t | \mathcal{F}_{t-1}]$$
  
= 
$$\frac{1}{1 + r\Delta t} \cdot \left( q \cdot C_t^{(n+1)} + (1 - q) \cdot C_t^{(n)} \right), \qquad (12.37)$$

![](_page_10_Figure_10.jpeg)

**Fig. 12.8** Complete binomial tree with stock prices and call payoffs at terminal vertices

![](_page_11_Figure_1.jpeg)

**Fig. 12.9** Complete binomial tree with underlying and call option valuated down the tree

and start with *t* =*T*, working backwards down the tree until we reach *t* = 1. Because *S<sup>t</sup>* is adapted to F*<sup>t</sup>* , the conditional expectation in (12.37) keeps track of the appropriate position in the tree. Put another way, if the process is at vertex *n* at time *t* − 1, there is no way it can reach vertices below *n* or above *n* + 1 in the next time slice *t*. Thus, only those two vertices contribute to the option value at vertex *n* at time *t* − 1. Because this conditioning argument holds, valuating down the tree is a completely equivalent strategy and should provide identical results. Figure 12.9 shows the entire tree and the resulting option price *C*0, generated by this procedure. Comparing the results with Example 12.1, the difference of 0.01 is clearly due to rounding errors.

Unlike European contracts, American options can only be valued down the tree. This is because they involve embedded decisions. In pricing such contracts, we make the possibly restrictive assumption that the option holder will follow an optimal exercise policy. This is the only consistent course of action. Suppose we assume the holder does not exercise optimally, then the value of the contract is reduced and we would sell it cheaper. But then another investor would have an arbitrage opportunity, by entering the appropriate positions and simply exercising optimally. Why is the decision embedded in an American contract so delicate? Of course, the right to exercise the option at any time during the lifetime is a reassuring comfort that will make the contract more valuable. But when exactly should it be exercised, if at all? Once again, from the martingale pricing principle we know that the fair value of the option at time *t* is the discounted expected value of the option at time *t* + 1 under the measure *Q*. If we observe that immediate exercise would result in a payoff above this value, we should do so. Let's look at a call option first. From the arbitrage bounds (11.25) on page 220 we can write the following inequalities

![](_page_12_Figure_1.jpeg)

**Fig. 12.10** American put option tree – Dashed branches indicating early exercise boundary

for 0 ≤ *t* ≤ *T*. The first inequality is a lower bound on the value of the ordinary European call option. The last term on the right hand side of (12.38) is the payoff when immediately exercised. From this it is clear that an American call option should never be exercised before expiry.<sup>1</sup> Consequently, the price of an American and European call option is identical. Using a completely analogous argument and (11.26), we can write inequalities for a put option

$$P_t(K,T) \ge (K-S_t)^+ \ge (e^{-r(T-t)}K-S_t)^+, \tag{12.39}$$

again for 0 ≤ *t* ≤ *T*. But this time the price of the European put option is bounded from below by the last term on the right hand side of (12.39). Thus, exercising the put before expiry might as well be advantageous. Therefore, we have to consider the condition

$$P_{t-1}^{(n)} = \max\left(\frac{1}{1+r\Delta t}E^{\mathcal{Q}}[P_t|\mathcal{F}_{t-1}], (K-S_{t-1}^{(n)})^+\right)$$
  
= 
$$\max\left(\frac{1}{1+r\Delta t}\cdot\left(q\cdot P_t^{(n+1)} + (1-q)\cdot P_t^{(n)}\right), (K-S_{t-1}^{(n)})^+\right), \tag{12.40}$$

starting at *t* = *T* and working backwards until *t* = 1. It is actually quite remarkable, how easy an American option can be priced in the binomial model. With the exception of a perpetual put, which means an option with infinite time to expiry, there exists no analytical solution in the *Black–Scholes*-framework. But we will worry about that later. For the moment, let's see how the valuation proceeds.

Figure 12.10 illustrates the complete binomial tree for an American put with exactly the same environmental conditions as in Example 12.1. The vertices where early

<sup>1</sup> Strictly speaking this is only true as long as the underlying stock does not pay a dividend, or in case of an exchange rate, no foreign interests are earned.

exercise is appropriate are marked with a star. The early exercise boundary is indicated by a second dashed line.

**Quick calculation 12.8** Calculate the price for a European put from the result in Example 12.1 and put-call parity. Confirm that the American put option is indeed more valuable.

We can elaborate on our former argument about the higher value of the American put a little more. Imagine you hold such a contract and your exercise policy is very sloppy. Indeed you never exercise early. In this case, you could have chosen a European contract, because you did not plan on taking advantage of your additional early exercise right anyway, and the European contract is cheaper. If you are the one to write the option, there is an extra incentive to make it an American option. You can hope for a buyer to act sloppily and not to exercise optimally. On average, such a buyer will pay too much for the contract.

## **12.5 Stopping Times and Snell-Envelope**

A concept intimately related to the valuation of American options is stopping times. A stopping time τ is a F*t*-measurable random variable, taking values in an index set T. 2 In the binomial model the index set is T = {0, 1, . . . ,*T*}. A stopping event is usually written {τ = *t*} or {τ ≤ *t*}, but this is only a shorthand for the definition

• • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • •

$$\{\tau \le t\} = \{\omega \in \Omega : \tau(\omega) \le t\} \in \mathcal{F}_t, \tag{12.41}$$

for all *t* ∈ T. To understand this definition better, look at an example of a stopping time and afterwards at a counterexample.

## **Example 12.3**

Suppose you give your broker the order to sell a stock *S* you are currently holding, as soon as its price falls below a certain lower limit *S<sup>l</sup>* . Your order is valid for the next four weeks.

## Explanation

The time τ your broker triggers the sale of your stock is clearly random, because you do not know when, if at all, the price of the stock will fall below *S<sup>l</sup>* . But at any time *t* ∈ T, you know if the stock is already sold or if it is still in your portfolio, because the σ-algebra F*<sup>t</sup>* =σ(*St*) contains the information about the stock price to have fallen below *S<sup>l</sup>* or not. ........................................................................................................................

<sup>2</sup> Earlier, we defined τ as the time to expiry. This is again an unfortunate clash of traditional notation. Nevertheless, the potential for confusion is very small, so we continue labeling the stopping time τ in this section.

Such a problem is called a "first passage" problem. Now suppose you try to persuade your broker to take the order to sell your stock for the highest price to be taken over the next four weeks. Would the random time of the sale still be a stopping time? No, because this time  $\tau$  is not  $\mathcal{F}_t$ - but only  $\mathcal{F}_T$ -measurable. Your broker would never take such an order from you. At least as long as she does not know how to deal with lookback options.

We have to examine the requirements of stopping times and their relation to martingales a little bit more closely. Let's ask the question, whether or not we can determine an optimal stopping time to sell a security or liquidate a portfolio. To answer this one, we need the concept of a stopped process and Doob's optional stopping theorem. Let  $X_t$ be an  $\mathcal{F}_t$ -adapted stochastic process, preferably a martingale. Then the stopped process  $Y_t$ , with respect to  $X_t$  and the stopping time  $\tau$ , is defined by

$$Y_t = \begin{cases} X_t & \text{if } t < \tau \\ X_\tau & \text{if } t \ge \tau. \end{cases} \tag{12.42}$$

 $X_t$  could for example be  $e^{-rt}S_t$ , where the bank account was used as numéraire. To avoid formal subtleties, we will restrict ourselves to discrete time processes. Of course all results carry over to the continuous time case, with a little bit of extra technical finesse.

**Theorem 12.1 (Optional stopping)** Let  $\mathcal{T} = \mathbb{N}_0$ ,  $X_t$  a martingale, and  $\tau$  a stopping time, both with respect to the filtration  $\mathcal{F}_t$ . If there exists an arbitrary constant c, such that one of the following conditions holds almost surely

- 1.  $\tau < c$ .
- 2.  $E[\tau] < \infty$  and  $E[|X_{t+1} X_t| | \mathcal{F}_t] \le c$ ,
- 3.  $|Y_t| < c$ .

then  $X_{\tau}$  is almost surely well-defined and  $E[X_{\tau}|\mathcal{F}_0] = X_0$ .

If  $X_t$  and  $\tau$  satisfy the requirements of Theorem 12.1, then  $Y_t$  is also an  $\mathcal{F}_t$ -adapted martingale. To see this, first decompose the stopped process

$$Y_t = X_0 + \sum_{s=1}^t \theta(\tau - s)(X_s - X_{s-1}), \qquad (12.43)$$

where  $\theta(x)$  is again the *Heaviside-* $\theta$ -function. If  $\tau \ge t$ , then all *Heaviside*-factors in the sum are one, and  $Y_t = X_t$ . If  $\tau < t$ , then for all  $s > \tau$  the *Heaviside*-factors vanish and we have  $Y_t = X_{\tau}$ . Because the event  $\{\tau \ge t\} = \{\tau \le t - 1\}^C$  has to be contained already in  $\mathcal{F}_{t-1}$ ,  $\theta(\tau - t)$  has to be  $\mathcal{F}_{t-1}$ -predictable. We can thus write

$$E[Y_{t} - Y_{t-1}|\mathcal{F}_{t-1}] = E[\theta(\tau - t)(X_{t} - X_{t-1})|\mathcal{F}_{t-1}]$$
  
=  $\theta(\tau - t)E[X_{t} - X_{t-1}|\mathcal{F}_{t-1}]$   
= 0. (12.44)

Pulling  $Y_{t-1}$  out of the expectation and using the law of iterated expectations proves the claim. Because we already agreed on the martingale pricing principle in arbitrage free markets, there seems to be no way to beat the market.

You might have heard from people passionately playing roulette in casinos, with a special system called doubling strategy. They make their bet on say rouge and if they lose, successively double their bet, until they finally win. In the next round they start all over again. Let's investigate, if such a strategy could work. Generously neglecting for the moment that only the house wins if the ball plays out zero, there is a  $50\%$  chance of winning and successive trials can be assumed to be independent. The gains from a pure doubling process can be written as

$$X_t = X_{t-1} + 2^{t-1} \epsilon_t \tag{12.45}$$

for  $t \in \mathbb{N}$ , with  $X_0 = 0$  and  $\epsilon_t = \pm 1$  with probability  $p = \frac{1}{2}$ . Clearly such a process is a martingale. Now consider the betting process of the player. In the first round, she bets one dollar. If she wins, she doubles, and her gain is  $Y_1 = 1$ , and the game starts over again. If she loses, she gets nothing, her gain is  $Y_1 = -1$  and she has to bet two dollars in the next round. After say  $t$  unfavorable outcomes the poor player's gain is

$$Y_t = -\sum_{s=1}^t 2^{s-1} = -\sum_{s=0}^{t-1} 2^s = 1 - 2^t.$$
 (12.46)

**Quick calculation 12.9** Verify the last equation by using geometric series' results.

In the next round the player has to bet  $2^t$ , and if she wins, her gain is exactly  $Y_{t+1} = 1$ . Obviously,  $Y_t$  is a stopped process with respect to  $X_t$  and the random stopping time  $\tau = \inf \{t: X_t = 1\}$ . Furthermore, it seems that we finally managed to beat the martingale and the whole strategy looks like an airtight money machine. We can even calculate, how long the player has to wait on average, before she can start all over again<sup>3</sup>

$$E[\tau] = \sum_{t=1}^{\infty} \frac{t}{2^t} = 2. \tag{12.47}$$

This is all very nice, but we missed an important point from Theorem 12.1. Neither of the three required conditions holds and so  $X_{\tau}$  is not a well-defined random process. To see this, realize that our strategy only works, if we are capable of waiting an infinite amount of time and temporarily losing an infinite amount of money, if we have a very unfortunate day.

**Quick calculation 12.10** Show that  $E[|X_{t+1} - X_t| | \mathcal{F}_t] = 2^t$  holds.

 $3$  In evaluating the sum, one has to isolate the first term and then do some manipulations

$$\sum_{t=1}^{\infty} \frac{t}{2^t} = \frac{1}{2} + \sum_{t=2}^{\infty} \frac{t}{2^t} = \frac{1}{2} + \sum_{t=1}^{\infty} \frac{t+1}{2^{t+1}} = \frac{1}{2} + \frac{1}{2} \sum_{t=1}^{\infty} \frac{t}{2^t} + \frac{1}{2} \sum_{t=1}^{\infty} \frac{1}{2^t} = 1 + \frac{1}{2} \sum_{t=1}^{\infty} \frac{t}{2^t}.$$

Multiplying the left and right hand side by two and subtracting the sum on both sides does the trick.

In reality, casinos put limits on the bets, in which case the optional stopping theorem holds,  $Y_t$  is a martingale, and we are back to square one.

Now let's return to our initial problem of pricing American option contracts. We have now nearly all the machinery required to formalize the concepts involved. We continue our discussion in the discrete time setup of the binomial model. The stochastic process

$$X_{t} = \begin{cases} \frac{P_{T}}{(1 + r\Delta t)^{T}} & \text{for } t = T\\ \max\left(\frac{P_{t}}{(1 + r\Delta t)^{t}}, E^{Q}[X_{t+1}|\mathcal{F}_{t}]\right) & \text{for } t < T, \end{cases}$$
(12.48)

with  $P_t = (K - S_t)^+$ , is called the *Snell*-envelope of the American put option. Apart from discounting, this is exactly what we calculated by backward valuation earlier. The *Snell*-envelope is a *Q*-super-martingale, satisfying  $X_t \geq \frac{P_t}{(1+r\Delta t)^t}$  for all  $t \leq T$ . By a super-martingale we mean an  $\mathcal{F}_t$ -adapted process with the property

$$X_t \ge E[X_{t+s}|\mathcal{F}_t],\tag{12.49}$$

for  $s \ge 0$ . Now you understand the financial engineer's joke that the market is a supermartingale. The *Snell*-envelope is also the smallest super-martingale with this property. To see this, take another Q-super-martingale  $Z_t$ , with  $Z_t \geq \frac{\tilde{P}_t}{(1+r\Delta t)^t}$  almost surely, for every  $t \leq T$ . From the definition (12.48), we have that  $Z_T \geq X_T$ . Taking conditional expectations, we can write

$$Z_{T-1} \ge E^{\mathcal{Q}}[Z_T | \mathcal{F}_{T-1}] \ge E^{\mathcal{Q}}[X_T | \mathcal{F}_{T-1}]. \tag{12.50}$$

We also have that  $Z_{T-1} \geq \frac{P_{T-1}}{(1+r\Delta t)^{T-1}}$ , which is what we assumed in the first place. It follows immediately that

$$Z_{T-1} \ge \max\left(\frac{P_{T-1}}{(1+r\Delta t)^{T-1}}, E^{\mathcal{Q}}[X_T|\mathcal{F}_{T-1}]\right) = X_{T-1}$$
(12.51)

has to hold. This argument can be easily iterated backwards until  $t=0$ . In case of the American option, the exercise decision should be made at the first time the *Snell*-envelope hits the floor,

$$\tau^* = \inf \left\{ t \in \mathcal{T} : X_t = \frac{P_t}{(1 + r\Delta t)^t} \right\}.$$
 (12.52)

Clearly,  $\tau^*$  is a stopping time, because the event  $\{\tau^* \le t\}$  is in  $\mathcal{F}_t$ , and the stopped process

$$Y_t = \begin{cases} X_t & \text{if } t < \tau^* \\ X_{\tau^*} & \text{if } t \ge \tau^* \end{cases} \tag{12.53}$$

is a *Q*-martingale, by the same chain of arguments we applied before. Furthermore,  $\tau^*$ solves the problem

$$Y_0 = P_0(K, T) = \sup_{\tau \in \mathcal{T}} E^{\mathcal{Q}} \left[ \frac{1}{(1 + r\Delta t)^{\tau}} (K - S_{\tau})^+ \middle| \mathcal{F}_0 \right]. \tag{12.54}$$

Note that the discounting factor is now inside the expectation. This is because  $\tau$  is a random variable, too. The representation  $(12.54)$  is a little bit deceiving, because we require the *Snell*-envelope to compute the supremum of the expectation value. This problem is essentially an application of the dynamic programming approach of Bellman (1954). This is very abstract and subtle business, so let's see how it works in an actual example.

# Example 12.4

Look at the situation illustrated in Figure 12.11. The *Snell*-envelope has already been computed and the process is stopped with respect to the optimal stopping time  $\tau^*$  as in (12.52). Show that  $\tau^*$  is indeed a stopping time and compute the fair value of the American option at  $t = 0$ .

### Solution

The optimal stopping vertices are indicated by a star in Figure 12.11. From this we conclude that the random variable  $\tau^*$  has to be defined by

$$\tau^*(\omega) = \begin{cases} 1 & \text{if } \omega = (\downarrow, \uparrow) \text{ or } \omega = (\downarrow, \downarrow) \\ 2 & \text{if } \omega = (\uparrow, \uparrow) \text{ or } \omega = (\uparrow, \downarrow). \end{cases}$$

We have thus the stopping events

$$\begin{array}{ll} \{\tau^* \le 0\} = \emptyset \in \mathcal{F}_0 \\ \{\tau^* \le 1\} = \{(\downarrow, \uparrow), (\downarrow, \downarrow)\} \in \mathcal{F}_1 \\ \{\tau^* \le 2\} = \Omega \in \mathcal{F}_2, \end{array}$$

![](_page_17_Figure_9.jpeg)

**Fig. 12.11** American put option tree  $-$  *Snell*-envelope and optimal stopping vertices

and therefore,  $\tau^*$  is an  $\mathcal{F}_t$ -adapted stopping time. The paths to the proper stop events are indicated by solid lines in Figure 12.11. All we have to do is compute the expectation value of the stopped process  $Y_t$ . That means, we have to average over the payoffs at the  $\tau^*$ -stopped vertices

$$\begin{split} Y_0 &= E^{\mathcal{Q}} \bigg[ \frac{1}{(1+r\Delta t)^{r^*}} (K - S_{\tau^*})^+ \bigg| \mathcal{F}_0 \bigg] \\ &= \frac{1-q}{1+r\Delta t} \cdot (K - S_1^{(0)}) + \frac{q^2}{(1+r\Delta t)^2} \cdot 0 + \frac{q(1-q)}{(1+r\Delta t)^2} \cdot (K - S_2^{(1)}). \end{split}$$

Of course  $Y_0$  is the desired fair price  $P_0(K, T)$ .

## **Path Dependent Options**

Path dependent options can be roughly divided into two classes, weakly and strongly path dependent ones. You could also say those that do not cause trouble in valuating them and the other kind. We will eventually learn how to deal with strongly path dependent options, but the binomial setup is not well suited for this class. Typical examples of weak path dependence are barrier options, whereas Asian options are examples of strong path dependence. We will first talk about barrier options.

Barrier options are so liquidly traded that they are barely considered exotics nowadays. They come in certain flavors, adding extra variety to the standard put-call building blocks. Barrier options have the following characteristics:

## Barrier type

- Knockout barrier: The contract expires worthlessly, if the barrier is hit.
- Knockin barrier: The contract does not come into life, before the barrier is hit.

#### Barrier location

- Upper barrier: The underlying has to cross the barrier from below.
- Lower barrier: The underlying has to cross the barrier from above.

Additionally, a rebate can be granted, if a knockout barrier is hit, so that the contract does not expire completely worthlessly.

Why do we consider barrier options weakly path dependent? Let's focus on a European option for the moment. The payoff does by all means depend on the path the underlying has taken up to expiry. Take for example a knockout call option with upper barrier. If the underlying ends up in the money, but below the barrier, it is not guaranteed that the option pays off anything. It all depends on which path the underlying took. If it hit the barrier during the lifetime of the contract, the option was knocked out, if it did not hit the barrier, the usual payoff is due at expiry. But the important point is that the barrier itself does not depend on the path of the underlying. This fact keeps valuation simple, so that we can use backward valuation, as in the case of American options. Only this time, we have not to track the *Snell*-envelope at each vertex, but

## 12.6

![](_page_19_Figure_1.jpeg)

Fig. 12.12 European knockout put option tree – Upper knockout barrier indicated by dashed line

only to check, if the barrier is hit or not. For reasons that will become clear shortly, the subsequent discussion addresses only knockout options.

Imagine you want to floor your portfolio. To this end you can enter a protective put position. But now assume that all goes well, and your portfolio performs extraordinarily favorably. There comes a point, where the floor is no longer needed for insurance. In fact you would probably want to install a new floor, to backup your profits. Unfortunately, you have already paid the option premium for your put. If you had chosen an identical knockout barrier put with an appropriate upper knockout barrier, you would have saved money. Think about it; both contracts have the same payoff function, but the barrier option pays off only in those states of the world, where the underlying has not hit the barrier. Thus, its value has to be smaller than that of the standard put option. Let's see how the valuation procedure works in our familiar setting of Example 12.1, with a European knockout put option with upper knockout barrier  $S_u = 115$ . Figure 12.12 illustrates the whole tree and the fair option price due to backward valuation. The vertices have to be computed as

$$P_{t-1}^{(n)} = \begin{cases} \frac{1}{1+r\Delta t} \cdot \left( q \cdot P_t^{(n+1)} + (1-q) \cdot P_t^{(n)} \right) & \text{if } S_{t-1}^{(n)} < S_u \\ 0 & \text{if } S_{t-1}^{(n)} \ge S_u. \end{cases} \tag{12.55}$$

Here comes a tricky question: A knockout barrier option is a contract contingent on a security. What is the underlying of a knockin barrier option? Realize that if the knockin barrier is hit, you are left with an ordinary call or put option. That means, the knockin barrier option is an option on another option. One would call such a derivative a second order contract. From the perspective of valuation, this is as bad as if the knockin version were a strongly path dependent option. Luckily, we can work around this problem. Ask yourself the following question: What payoff do you generate, if you

hold a knockout barrier option and an identical knockin option, with the same barrier, exercise price, and time to expiry? Correct, you just replicated an ordinary plain vanilla option. If one contract is knocked out, the other knocks in at the same time and you are done with the barrier condition. It does not matter, if we are talking about calls or puts, so let's call the value of the contract  $V_t$ . It also does not matter, if there is an upper or lower barrier, so let's call the barrier  $S_b$ . We can then formulate a parity relation for barrier options

$$V_t^{\odot}(K, T, S_b) + V_t^{\otimes}(K, T, S_b) = V_t(K, T), \tag{12.56}$$

where we have used the somewhat neat superscripts  $\odot$  for knockin, and  $\otimes$  for knockout. Think of an arrow flying towards you ( $\odot \rightarrow$  knockin), or away from you ( $\otimes \rightarrow$ knockout). Furthermore, the parity relation (12.56) provides a formal argument for our earlier claim

$$P_t^{\otimes}(K,T,S_u) \le P_t(K,T). \tag{12.57}$$

Thus, the fair price of a knockin barrier option can be found by valuating the corresponding knockout and plain vanilla options.

Let's now move on to strongly path dependent options. A standard example of such contracts are Asian options. The characteristic property of Asian contracts is that their payoff function always involves some kind of average over the path of the underlying. As in the case of barrier options, there are several permutations of Asian options. The most basic characteristics are:

## Strike type

- Fixed strike: The exercise price is fixed and not affected by the path of the underlying.
- Floating strike: The exercise price itself is calculated by averaging over the path of the underlying.

## Averaging method

• Arithmetic average: The average is computed as

$$\bar{S}_T = \frac{1}{T+1} \sum_{t=0}^T S_t \quad \text{or} \quad \bar{S}_T = \frac{1}{T} \int_0^T S_t dt.$$

• Geometric average: The average is computed as

$$\bar{S}_T = \sqrt[T+1]{\prod_{t=0}^T S_t} \quad \text{or} \quad \bar{S}_T = e^{\frac{1}{T} \int_0^T \log S_t dt}.$$

![](_page_21_Figure_1.jpeg)

**Fig. 12.13** Binomial tree for arithmetic Asian option – Tree grows bushy with 2*<sup>t</sup>* vertices

Thus, an Asian fixed strike call option, with exercise price *K* and expiry date *T* has the payoff function

$$C_T^{\Psi}(K,T,\bar{S}_T) = (\bar{S}_T - K)^{+}.$$
 (12.58)

Obviously, *S*¯ <sup>0</sup> = *S*<sup>0</sup> has to hold, if not specified otherwise. The payoff of the identical floating strike version is

$$C_T^{\Psi}(\bar{S}_T, T) = (S_T - \bar{S}_T)^+.$$
 (12.59)

Now let's see what happens, if we try to price such an option in the binomial model. Figure 12.13 sketches the first two levels of a possible tree. As you immediately see, the problem is that the tree grows bushy, thereby enormously increasing the number of branches and vertices. Until now, our trees generated *t* + 1 vertices in time slice *t*. A tree for an Asian option obviously generates 2*<sup>t</sup>* vertices in the same time slice. This number grows prohibitively large for computational purposes very rapidly. There is another way to price such contracts, via Monte Carlo simulation. But since it is more reasonable to introduce this method when we have a better model for the price process of the underlying, we will postpone the valuation of strongly path dependent contracts.

## **12.7 The Black–Scholes-Limit of the Binomial Model**

The parameters in the binomial model can be chosen such that in the limit *T* → ∞, the price of an arbitrary option converges to the *Black–Scholes*-price of the contract. The appropriate parametrization and the limit process are elaborated for a European binary call option. The whole procedure is best understood, if executed step-by-step.

• • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • •

## **Step 1**

Write an equation for the lower exercise threshold *a*. We have from (12.33) on page 230 that

$$a = \min\left\{n \in \mathbb{N}_0 : n > \frac{\log(K/S_0) - T\log d}{\log(u/d)}\right\}.$$
(12.60)

This merely means that *a* is the first nonnegative integer, greater than the ratio in (12.60). We can write an equation by filling up the gap with a new variable ε > 0,

$$a = \frac{\log(K/S_0) - T\log d}{\log(u/d)} + \varepsilon$$
  
= 
$$\frac{\log(K/S_0) - T\log d + \varepsilon \log(u/d)}{\log(u/d)}.$$
 (12.61)

Eventually, in the limit *T* → ∞, the gap shrinks to zero, which means lim*T*→∞ ε = 0.

## **Step 2**

Compute the moments of the logarithmic return. Because the price of the underlying at vertex *n* in the terminal time slice *T* is *S* (*n*) *T* = *u nd <sup>T</sup>*−*<sup>n</sup>S*0, the logarithmic return at the same vertex is given by

$$\log\left(S_T^{(n)}/S_0\right) = n\log u + (T-n)\log d$$
  
=  $n\log(u/d) + T\log d.$  (12.62)

Observe that in general, the vertex *n* we end up is the realization of a binomially distributed random variable *N* : Ω → {0, 1, . . . , *T*}. We thus have

$$E[\log(S_T/S_0)] = E[N] \log(u/d) + T \log d$$
  
=  $p \cdot T \log(u/d) + T \log d.$  (12.63)

From the same consideration, we can compute the variance of the logarithmic return

$$\text{Var}[\log(S_T/S_0)] = \text{Var}[N] \log^2(u/d)$$
  
=  $p(1-p) \cdot T \log^2(u/d).$  (12.64)

## **Step 3**

Choose a suitable parametrization. Let again τ denote the time to expiry. We want three conditions to be satisfied:

- 1. *u* · *d* = 1 (stable tree),
- 2. lim*T*→∞ *E* [ log( *ST*/*S*<sup>0</sup> )] = µτ,
- 3. lim*T*→∞ Var[ log( *ST*/*S*<sup>0</sup> )] =σ 2 τ,

where µ and σ are the expected (annual) logarithmic return and standard deviation of the underlying. Observe that we have three conditions and three unknowns, *u*, *d*, and *p*. Thus, we can satisfy all requirements. Indeed the parametrization

$$u/d = e^{\pm \sigma} \sqrt{\frac{\tau}{T}}$$
 and  $p = \frac{1}{2} + \frac{\mu}{2\sigma} \sqrt{\frac{\tau}{T}}$  (12.65)

does the trick. Let's prove that for all three conditions:

1. Simply observe that

$$e^{\sigma\sqrt{\frac{\tau}{T}}}e^{-\sigma\sqrt{\frac{\tau}{T}}} = e^0 = 1.$$

2. Plug the parametrization into (12.63) to obtain

$$E[\log(S_T/S_0)] = \left( \left( \frac{1}{2} + \frac{\mu}{2\sigma} \sqrt{\frac{\tau}{T}} \right) \cdot 2\sigma \sqrt{\frac{\tau}{T}} - \sigma \sqrt{\frac{\tau}{T}} \right) \cdot T$$
$$= \frac{\mu}{2\sigma} \sqrt{\frac{\tau}{T}} \cdot 2\sigma \sqrt{\frac{\tau}{T}} \cdot T = \mu\tau.$$

It is not even necessary to take the limit, because the parametrization is exact for every *T* ∈ N.

3. First observe that

$$1 - p = \frac{1}{2} - \frac{\mu}{2\sigma} \sqrt{\frac{\tau}{T}}.$$

One then obtains by using (12.64)

$$\text{Var}[\log(S_T/S_0)] = \left(\frac{1}{4} - \frac{\mu^2}{4\sigma^2}\frac{\tau}{T}\right) \cdot 4\sigma^2 \frac{\tau}{T} \cdot T = \sigma^2 \tau - \mu^2 \frac{\tau^2}{T}.$$

In the limit *T* → ∞ the last term on the right hand side vanishes and the proof is complete.

## **Step 4**

Make preparations for the application of the central limit theorem. Observe that for a binomial random variable *N* ∼*B*(*p*,*T*) the central limit theorem ensures that

$$\frac{N - p \cdot T}{\sqrt{p(1 - p) \cdot T}} \xrightarrow{D} Z \sim N(0, 1) \tag{12.66}$$

for *<sup>T</sup>* → ∞, where the symbol *<sup>D</sup>* −→ indicates convergence in distribution. Now plug in *a* and take the limit

$$\lim_{T \to \infty} \frac{a - p \cdot T}{\sqrt{p(1 - p) \cdot T}} = \lim_{T \to \infty} \frac{\log(K/S_0) - T \log d + \varepsilon \log(u/d) - p \cdot T \log(u/d)}{\sqrt{p(1 - p) \cdot T \log^2(u/d)}}$$

$$= \frac{\log(K/S_0) - \mu \tau}{\sigma \sqrt{\tau}}.$$
(12.67)

Recall that ε log(*u*/*d*) vanishes automatically in the limit.

## **Step 5**

Compute the risk-neutral probability measure. The logarithmic returns in the *Black– Scholes*-model are normally distributed, *R<sup>S</sup>* ∼ *N*(µτ, σ<sup>2</sup> τ). From the martingale pricing principle, we know that

$$S_0 = e^{-r\tau} E^{\mathcal{Q}} [S_0 e^{R_S} | \mathcal{F}_0] \tag{12.68}$$

has to hold. If we evaluate the expectation value under the physical probability measure *P*, we obtain

$$S_0 = e^{-r\tau} E^P [S_0 e^{R_S} | \mathcal{F}_0] = S_0 e^{-\tau (r - \mu - \frac{1}{2}\sigma^2)}, \tag{12.69}$$

from which we can conclude that in going from *P* to *Q*

$$\mu = r - \frac{1}{2}\sigma^2 \tag{12.70}$$

has to hold. Strictly speaking, this conclusion is not yet justified. We have implicitly assumed that the change of measure preserves the normal distribution and only changes its mean. We will back up this claim later in the context of the important *Girsanov*-theorem. However, taking this fact for granted at the moment, we obtain the risk-neutral probability measure

$$q = \frac{1}{2} + \frac{r - \frac{1}{2}\sigma^2}{2\sigma} \sqrt{\frac{\tau}{T}},$$
(12.71)

by substituting (12.70) into (12.65).

## **Step 6**

Apply the central limit theorem. We are now in a position to make the final transition. Recall that in the binomial model the time step is ∆*t* = τ *T* . We then obtain for the fair price of a European binary call option

$$C_0^B(K,\tau) = \lim_{T \to \infty} \frac{1}{\left(1 + \frac{r\tau}{T}\right)^T} \sum_{n=a}^T \mathcal{B}_n(q,T) = e^{-r\tau} \int_a^\infty \phi(z) dz,\tag{12.72}$$

where

$$a = \frac{\log(K/S_0) - \left(r - \frac{1}{2}\sigma^2\right)\tau}{\sigma\sqrt{\tau}} \quad \text{and} \quad \phi(z) = \frac{1}{\sqrt{2\pi}}e^{-\frac{1}{2}z^2}.$$
 (12.73)

We can finally use the symmetry property of the normal distribution to rewrite the result a little bit,

$$\int_{a}^{\infty} \phi(z)dz = \int_{-\infty}^{-a} \phi(z)dz = \Phi(-a). \tag{12.74}$$

Putting all the pieces together, we obtain

$$C_0^B(K,\tau) = e^{-r\tau} \Phi(-a), \tag{12.75}$$

which is precisely the fair price of a European binary call option in the *Black–Scholes*model.

## **12.8 Further Reading**

• • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • • Originally, the binomial model was introduced by Cox et al. (1979). A deep and comprehensive treatment is Shreve (2004a). A very accessible and entertaining introduction

is provided in Wilmott (2006a, chap. 15). Advanced issues and trinomial tree extensions can be found in Haug (2007, chap. 7). Stopping times and early exercise problems are discussed in Bingham and Kiesel (2004, sect. 3.5 & 3.6). An excellent treatment of American contingent claims is provided in Föllmer and Schied (2011, chap. 6). For dynamic programming issues, see the book by Bellman (1957) in various reprints. An impressive collection of exotic options is provided also in Haug (2007).

## Problems

- **12.1** Look at the binomial tree in Figure 12.14. Assume that the risk-free interest rate vanishes,  $r = 0\%$ , and price the European plain vanilla put option by computing the hedge-portfolios  $\hat{\Pi}^{(1)}_1, \Pi^{(0)}_1$ , and  $\hat{\Pi}_0$ .
- **12.2** In Example 12.2 on page 231, a European binary call was valuated with the binomial formula. Price the corresponding put option in the same setting, and check whether or not your result satisfies binary put-call parity.
- **12.3** Let  $\mathcal{F}_t$  be a filtration generated by the stochastic process  $X_t$ , and  $\tau$  a stopping time with respect to  $X_t$ . The stopped σ-algebra  $\mathcal{F}_{\tau}$  is defined by

$$\mathcal{F}_{\tau} = \{ A \in \mathcal{F} : A \cap \{ \tau \le t \} \in \mathcal{F}_t \text{ for all } t \in \mathcal{T} \}.$$

In fact,  $\mathcal{F}_{\tau}$  is the  $\sigma$ -algebra generated by the realizations of the process  $X_t$  at all stopping times,  $\mathcal{F}_{\tau} = \sigma(X_{\tau})$ . What is the stopped  $\sigma$ -algebra for the process in Example 12.4 on page 239?

- **12.4** Imagine the stopping time  $\tau$  is a fixed deterministic time  $\tau = s$ , with  $0 < s < T$ . What are the stopping events?
- 12.5 Show that for the deterministic stopping time of Problem 12.4, the stopped  $\sigma$ -algebra is  $\mathcal{F}_{\tau} = \mathcal{F}_{s}$ .
- **12.6** Consider the environmental conditions of the standard example 12.1 on page 230 and valuate a knockout call option with upper knockout barrier  $S_u = 125$  and American exercise right. Formulate the computation rule for vertex  $n$  in time slice  $t$  and sketch the binomial tree.

![](_page_25_Figure_11.jpeg)

Fig. 12.14 Binomial tree for European plain vanilla put option

## 12.9

**12.7** In demonstrating the transition from the binomial model to the *Black–Scholes*model, the parametrization *u*/*d* = *e* ±σ √ <sup>∆</sup>*<sup>t</sup>* was chosen in step 3, with ∆*t* = τ *T* . Show that the martingale principle results in the same risk-neutral probability

$$q = \frac{1}{2} + \frac{r - \frac{1}{2}\sigma^2}{2\sigma} \sqrt{\Delta t},$$

if the *u*/*d*-parametrization is *Taylor*-expanded to second order.