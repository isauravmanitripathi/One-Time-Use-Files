# Universal Portfolios

The mainstream mathematical approach to investment portfolio selection involves modeling asset prices as a stochastic process, and deriving asset allocation strategies that are optimal with respect to some statistical criteria, such as the mean and variance of returns, or an expected utility. The application of this approach to real-world markets is complicated by the lack of a fully specified stochastic process. It is, in fact, debatable whether an underlying stochastic process exists at all.

The theory of universal portfolios offers an alternative approach that forgoes stochastic models and associated optimality criteria and instead finds universal portfolio selection strategies that perform well relative to *all* strategies in a target class of allocation strategies, for all possible sequences of asset price changes. The term universal portfolio was coined in [3], which first put forth this alternative paradigm for the specific target class of constant rebalanced portfolios. This particular target class, which has also been the focus of much of the subsequent related work, seems to strike a favorable balance between the richness of the class and the degree to which the class performance can be tracked. The theory, in its greatest generality, however, can involve any target class, and would be concerned with finding the degree to which it can be tracked universally. The article focuses on universal portfolios for constant rebalanced portfolios, with only a brief mention of what is known beyond this.

Constant rebalanced portfolios [14] are a wellknown (though under several aliases) class of allocation strategies that, at designated times, buy and sell assets to restore the fractions of wealth invested in each asset to an initial, fixed allocation. For a given sequence of rebalancing times, constant rebalanced portfolios can thus be parameterized by a vector with real valued, nonnegative components summing to one, specifying the fractions of wealth to which asset allocations are rebalanced. For example, given a pair of assets, the constant rebalanced portfolio corresponding to the vector  $(1/3, 2/3)$  initially invests  $1/3$  and  $2/3$  of starting capital, respectively, in each of the assets. Thereafter, as the asset prices change, it buys and sells the assets at each rebalancing time to restore the fractions of cumulative wealth invested in each asset back to the initial  $(1/3, 2/3)$ .

One well-known motivating property of constant rebalanced portfolios is that they maximize the expectation of a variety of utility functions when asset price returns between rebalancing times are statistically independent and identically distributed from one interval to the next. In general, the optimal allocation depends on both the underlying probability distribution and the utility function, making the optimal choice, from this point of view, a challenging one for any given real-world setting. The theory of universal portfolios for constant rebalanced portfolios, which seeks to perform well relative to all portfolios, offers a principled way around this difficulty. It is worth reemphasizing, however, that beyond this motivational aspect, the theory makes  $no$  stochastic assumptions on asset prices.

Given a fixed number of assets and a sequence of asset price changes between  $n$ -designated rebalancing times, let  $S_n^*$  denote the largest return attained by any constant rebalanced portfolio on that sequence of asset price changes. This will be the benchmark for universal portfolio performance. Note that  $S_n^*$  and the (best) constant rebalanced portfolio that achieves it depend on the entire sequence of asset price changes, whereas the allocations of any realizable portfolio selection strategy must be causal, or nonanticipating, depending only on the previously observed price data. As such, the return  $S_n^*$  is not directly realizable. Furthermore, depending on the actual asset returns,  $S_n^*$  may exceed the return of any fixed constant rebalanced portfolio by an exponentially increasing factor. This means that naively using a seemingly safe choice like the uniform allocation might be exponentially suboptimal.

Nonetheless, nonanticipating universal portfolios have been found with returns  $\hat{S}_n$  that approach  $S_n^*$ , in the sense that the exponential rates of return per rebalancing interval,  $\hat{W}_n = (1/n) \log \hat{S}_n$  and  $W_n^* =$  $(1/n) \log \hat{S}_n^*$ , are guaranteed to satisfy  $\hat{W}_n - W_n^* \geq$  $-((m-1)/(2n))\log n - O(1/n)$ , uniformly for all sequences of asset prices. Since this relative exponential rate of return tends to 0 in  $n$ , it follows that if  $S_n^*$  is increasing at some exponential rate of growth (as would be hoped for and expected in practice),  $\hat{S}_n$  will increase at the same exponential rate, asymptotically. The remainder of the article explains the universal portfolios achieving this benchmark performance.

## **Formal Definitions and Notation**

Investments in  $m$  assets are to be adjusted at designated rebalancing times, with the gap between two consecutive such times constituting an investment period. The multiplicative factors by which the respective asset prices change over an investment period (gross returns) are denoted by a price relative vector  $\mathbf{x} = (x_1, \dots, x_m)'$ , with  $x_i \ge 0$  specifying the return factor of asset *i*, and  $\mathbf{v}'$  denoting the transpose of vector  $\mathbf{v}$ . The entire cumulative wealth is assumed to be reinvested at each rebalancing time and a nonnegative portfolio vector  $\mathbf{b} = (b_1, \ldots, b_m)'$ , satisfying  $\sum_{i} b_{i} = 1$ , denotes the fractions of cumulative wealth to invest in each asset (fraction  $b_i$  in asset j). If a rebalancing according to the portfolio vector  $\mathbf{b}$  is followed by asset returns corresponding to the price relative vector  $\mathbf{x}$ , the cumulative wealth is multiplied by a factor of  $\mathbf{b}'\mathbf{x} = \sum_{j=1}^{m} b_j x_j$ , over that investment period. Consequently, a sequence of  $n$  rebalancings according to the portfolios  $\mathbf{b}^n = \mathbf{b}_1, \mathbf{b}_2, \ldots, \mathbf{b}_n$  and a corresponding sequence of ensuing price relatives  $\mathbf{x}^n = \mathbf{x}_1, \ldots, \mathbf{x}_n$  result in an overall return factor (cumulative gross return) of

$$S_n(\mathbf{x}^n, \mathbf{b}^n) = \prod_{i=1}^n \mathbf{b}'_i \mathbf{x}_i \tag{1}$$

A constant rebalanced portfolio reinvests according to a fixed  $\mathbf{b}$  at each rebalancing time, resulting in a return factor of  $S_n(\mathbf{x}^n, \mathbf{b}) = \prod_{i=1}^n \mathbf{b}' \mathbf{x}_i$ . The best constant rebalanced portfolio  $\mathbf{b}^*(\mathbf{x}^n)$  for a price relative sequence achieves  $S_n^*(\mathbf{x}^n) = \max_{\mathbf{b} \in \mathcal{B}} S_n(\mathbf{x}^n, \mathbf{b}),$ where  $\mathcal{B}$  denotes the set of all valid portfolio vectors. A nonanticipating portfolio selection strategy is a sequence of functions  $\hat{\mathbf{b}}_i(\cdot)$  that map previously occurring price relative vectors into portfolio vectors. The corresponding portfolio used at rebalancing time *i* can thus be expressed as  $\mathbf{b}_i(\mathbf{x}_1,\ldots,\mathbf{x}_{i-1})$ . As mentioned, universal portfolio theory for the target class of constant rebalanced portfolios seeks nonanticipating portfolio selection strategies that perform well relative to  $S_n^*(\mathbf{x}^n)$  for all  $\mathbf{x}^n$ .

#### $\mu$ -Weighted Universal Portfolios

For a target class consisting of only two portfolio allocation strategies, a natural corresponding universal portfolio would split the starting capital into two pools and invest each pool according to the respective target portfolios, thereby achieving the average of

the target returns. The class of constant rebalanced portfolios is considerably more complex, since it is a continuum of portfolio selection strategies, but an extension of this idea still works well. Given a measure or distribution  $\mu$  on the space of valid portfolio vectors  $\mathcal{B}$  satisfying  $\mu(\mathcal{B}) = 1$ , the  $\mu$ -weighted universal portfolio can be thought of as investing an infinitesimal fraction  $d\mu(\mathbf{b})$  of initial capital according to each constant rebalanced portfolio  $\mathbf{b}$ , where  $d\mu(\mathbf{b})$ , informally, is the differential measure at **b**. The return factor  $\hat{S}_{n,\mu}(\mathbf{x}^n)$  of such a strategy for a sequence of price relatives  $\mathbf{x}^n$ , is the average, with respect to  $\mu$ , of the returns of the underlying constant rebalanced portfolios, or more precisely,

$$\hat{S}_{n,\mu}(\mathbf{x}^n) = \int_{\mathcal{B}} S_n(\mathbf{x}^n, \mathbf{b}) \, \mathrm{d}\mu(\mathbf{b}) \tag{2}$$

A more rigorous formulation of the  $\mu$ -weighted universal portfolio is that at time  $i$  it uses the portfolio function,

$$\hat{\mathbf{b}}_{i}(\mathbf{x}^{i-1}) = \frac{\int_{\mathcal{B}} S_{i-1}(\mathbf{x}^{i-1}, \mathbf{b}) \mathbf{b} \, \mathrm{d}\mu(\mathbf{b})}{\int_{\mathcal{B}} S_{i-1}(\mathbf{x}^{i-1}, \mathbf{b}) \, \mathrm{d}\mu(\mathbf{b})} \tag{3}$$

which can be interpreted as a past performance weighted average of constant rebalanced portfolios. Setting  $S_0(\mathbf{x}^0, \mathbf{b}) = 1$  and incorporating these portfolio vectors into equation  $(1)$ , results in a telescoping product, with the overall return factor simplifying to equation  $(2)$ .

The  $\mu$ -weighted universal portfolio was first proposed in [3] for the special case of  $\mu$  equal to the uniform distribution, or Lebesgue measure, on the set of valid portfolio vectors  $\mathcal{B}$ . Later, Cover and Ordentlich [5] refined the performance bounds for the uniform case and found that a different  $\mu$  corresponding to the Dirichlet $(1/2, \ldots, 1/2)$  distribution with density proportional to  $1/\sqrt{b_1b_2\ldots b_m}$  exhibits a better worst case performance against the benchmark  $S_n^*(\mathbf{x}^n)$ . Letting  $S_{n,U}(\mathbf{x}^n)$  and  $S_{n,D}(\mathbf{x}^n)$ , respectively, denote the return factors of the uniform and Dirichlet-weighted universal portfolios, the following performance bounds were derived in [5]:

$$\min_{\mathbf{x}^n} \frac{\hat{S}_{n,U}(\mathbf{x}^n)}{S_n^*(\mathbf{x}^n)} = \left[ \binom{n+m-1}{m-1} \right]^{-1},$$
$$\min_{\mathbf{x}^n} \frac{\hat{S}_{n,D}(\mathbf{x}^n)}{S_n^*(\mathbf{x}^n)} = \frac{\Gamma(m/2)\Gamma(n+1/2)}{\Gamma(1/2)\Gamma(n+m/2)} \tag{4}$$

where the minimizations are over all sequences of price relative vectors. Stirling's approximation of the Gamma function applied to the performance bound for the Dirichlet-weighted universal portfolio shows that it decreases in *n* as  $c_m/n^{(m-1)/2}$ , with  $c_m$  depending only on the number of assets  $m$  (and not  $n$ ). After taking logarithms and normalizing by  $n$ , this gives the worst-case exponential rate of return of  $\hat{S}_{n,D}$  relative to  $S_n^*$  mentioned in the introduction section of the article. Exact algorithms for computing (3) for the uniform and Dirichlet-weighted universal portfolios are given in [5]. Lower complexity approximate algorithms based on quantization [3] and randomization [2, 11] have also been proposed.

## Max-min Universal Portfolios

It was shown in  $[16]$  that the maximum over all nonanticipating portfolio strategies of the minimum return relative to the benchmark best constant rebalanced portfolio is given by

$$\max_{\{\hat{\mathbf{b}}_i(\cdot)\}} \min_{\mathbf{x}^n} \frac{\hat{S}_n(\mathbf{x}^n, \{\hat{\mathbf{b}}_i(\cdot)\})}{S_n^*(\mathbf{x}^n)}$$

$$= \left[ \sum_{n_1 + \dots + n_m = n} \left( \frac{n!}{n^m} \prod_{j=1}^m \frac{n_j^n}{n_j!} \right) \right]^{-1} \tag{5}$$

where the maximization is over all nonanticipating portfolio strategies, with  $\hat{S}_n(\mathbf{x}^n, \{\hat{\mathbf{b}}_i(\cdot)\})$  denoting the return factor of such a strategy, and the summation on the right is over  $m$ -tuples of nonnegative integers summing to  $n$ . The max-min universal portfolio for horizon  $n$  achieves the game theoretic optimum of equation (5). Letting  $\hat{S}_{n,\text{max-min}}(\mathbf{x}^n)$  denote its return factor, the ratio  $\hat{S}_{n,\text{max-min}}(\mathbf{x}^n)/S_n^*(\mathbf{x}^n)$  at time *n* is, therefore, guaranteed to not fall below the right-hand side of equation (5). As for the Dirichlet-weighted universal portfolio, this relative return factor behaves like  $\tilde{c}_m/n^{(m-1)/2}$ , where  $\tilde{c}_m$  improves on (is larger than) the corresponding constant for the Dirichlet case

The max-min universal portfolio for horizon  $n$  can also be expressed as splitting the pool of starting capital among a collection of constituent strategies. In this case, there are  $m^n$  such strategies, identified with the sequences of length  $n$  of elements from the set  $\{1, \ldots, m\}$ . The strategy corresponding

to the sequence  $j^n = j_1, \ldots, j_n$  invests the entire cumulative wealth at time *i* in asset  $j_i$ . The fraction of starting capital allocated to the constituent strategy corresponding to  $j^n$  is  $V \prod_{j=1}^m (n_j/n)^{n_j}$  where V ensures that the fractions add up to one. It turns out that  $V$  equals the right-hand side of equation (5). The portfolio function  $\hat{\mathbf{b}}_i(\mathbf{x}^{i-1})$  to use at each time *i* can be computed efficiently (polynomially in  $n$ ) using an algorithm similar to that proposed in [5] (see also [16]) for the uniform and Dirichlet-weighted universal portfolios. Note that unlike these universal portfolios, the max-min universal portfolio entails a different sequence of portfolio functions for each horizon  $n$ .

The worst case sequences of price relatives that pin the ratio  $\hat{S}_{n,\text{max-min}}(\mathbf{x}^n)/S_n^*(\mathbf{x}^n)$  to the righthand side of equation (5) are those in which each price relative vector  $\mathbf{x}_i$  has exactly one nonzero component.<sup>a</sup> These are characteristic of horse race or gambling markets [5]. A conditionally max-min universal portfolio is proposed in [15] that "locks in" potential improvements in the relative performance ratio if  $\mathbf{x}^n$  is more benign. The max-min universal portfolio and its performance bound is extended to a constrained set of price relative vectors in [4].

## Extensions

Other universal portfolios for the target class of constant rebalanced portfolios that trade-off the above performance bounds for lower computational complexity are proposed in  $[1, 8, 13]$ . The uniformweighted universal portfolio and the performance bound of  $[3]$  are extended to continuous time in  $[10]$ . In [16], a different continuous time universal portfolio is proposed that corresponds to the dynamic hedging strategy of a derivative security, termed the *hindsightallocation option*, that pays the return of the best constant rebalanced portfolio computed in hindsight. Universal portfolios under transactions costs are pursued in  $[2, 9]$ . The former extends the performance bounds of the uniform-weighted universal portfolio to incorporate linear transactions costs and the latter considers an alternative target class (for  $m = 2$ assets) of no-trade-region strategies that are known to be optimal under linear transactions costs in certain probabilistic settings.

Universal portfolios for alternative target classes are also proposed in [5] for side-informationdependent constant rebalanced portfolios, in [12, 17] for piecewise constant rebalanced portfolios, and in [7] for a class of portfolio strategies that can depend on past asset prices. Finally, universal portfolios incorporating short sales and margin are considered in [6].

# **End Notes**

a*.* The max–min relative performance (5) continues to hold if the minimization over nonnegative sequences of price relatives is replaced by an infimum over strictly positive sequences. This also applies to (4).

# **References**

- [1] Agarwal, A., Hazan, E., Kale, S. & Schapire, R.E. (2006). Algorithms for portfolio management based on the Newton method, in *Proceedings of the 23rd International Conference on Machine Learning (ICML)*, Pittsburgh, PA, pp. 9–14.
- [2] Blum, A. & Kalai, A. (1999). Universal portfolios with and without transaction costs, *Machine Learning* **35**(3), 193–205.
- [3] Cover, T.M. (1991). Universal portfolios, *Mathematical Finance* **1**(1), 1–29.
- [4] Cover, T.M. (2004). Minimax regret portfolios for restricted stock sequences, *Proceedings of the IEEE Symposium on Information Theory*, Jun 2004, Chicago, IL, p. 140.
- [5] Cover, T.M. & Ordentlich, E. (1996). Universal portfolios with side information, *IEEE Transactions on Information Theory* **42**(2), 348–363.
- [6] Cover, T.M. & Ordentlich, E. (1998). Universal portfolios with short sales and margin, *Proceedings of the IEEE Symposium on Information Theory*, Aug 1998, Cambridge, MA, p. 174.

- [7] Cross, J.E. & Barron, A.R. (2003). Efficient universal portfolios for past-dependent target classes, *Mathematical Finance* **13**(2), 245–276.
- [8] Helmbold, D.P., Schapire, R.E., Singer, Y. & Warmuth, M.K. (1998). On-line portfolio selection using multiplicative updates, *Mathematical Finance* **8**(4), 325–347.
- [9] Iyengar, G. (2005). Universal investment in markets with transaction costs, *Mathematical Finance* **15**(2), 359–371.
- [10] Jamshidian, F. (1992). Asymptotically optimal portfolios, *Mathematical Finance* **2**(2), 131–150.
- [11] Kalai, A.T. & Vempala, S. (2002). Efficient algorithms for universal portfolios, *The Journal of Machine Learning Research* **3**(3), 423–440.
- [12] Kozat, S.S. & Singer, A.C. (2007). Universal constant rebalanced portfolios with switching, *Proceedings of the IEEE International Conference on Acoustics, Speech, and Signal Processing*, Honolulu, HI, Vol. 3, pp. 1129–1132.
- [13] Merhav, N. & Feder, M. (1993). Universal schemes for sequential decision from individual data sequences, *IEEE Transactions on Information Theory* **39**(4), 1280–1292.
- [14] Mulvey, J. (2009). Constantly rebalanced portfolios, *Encyclopedia of Quantitative Finance* **1**, 346.
- [15] Ordentlich, E. (1996). *Universal Investment and Universal Data Compression*, Ph.D. Thesis, Stanford University.
- [16] Ordentlich, E. & Cover, T.M. (1998). The cost of achieving the best portfolio in hindsight, *Mathematics of Operations Research* **23**(4), 960–982.
- [17] Singer, Y. (1997). Switching portfolios, *International Journal of Neural Systems* **8**(4), 445–455.

#### ERIK ORDENTLICH