<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
 </head>
 <body>
  <h1>
   <b>
    Credit Portfolio
   </b>
   Simulation&lt;sup&gt;a&lt;/sup&gt;
  </h1>
  <h2>
   <b>
    Portfolio Modeling
   </b>
  </h2>
  <p block-type="Text">
   In risk management, quantitative techniques are mainly used for measuring the risk in a portfolio of assets rather than computing the prices of individual securities. The quantification of portfolio risk is traditionally split into separate calculations for market and credit risk, which are performed in different types of portfolio models. This article focuses on credit risk, more precisely on simulation techniques in structural credit portfolio models. We refer to [4] for a comprehensive exposition of Monte Carlo (MC) methods in quantitative finance including applications in market risk models.
  </p>
  <p block-type="TextInlineMath">
   In a typical bank, risk capital for credit risk far outweighs capital requirements for any other risk class. Key drivers of credit risk are concentrations in a bank's credit portfolio. Depending on their formulation, credit portfolio models can be divided into reduced-form models and structural (or firm-value) models (see Reduced Form Credit Risk Models; Structural Default Risk Models). The progenitor of all structural models is the model of Merton [13], which links the default of a firm to the relationship between its assets and the liabilities that it faces at the end of a given time period
   <math display="inline">
    [0, T]
   </math>
   . More precisely, in a structural credit portfolio model, the
   <math display="inline">
    i
   </math>
   th counterparty defaults if its ability-to-pay variable
   <math display="inline">
    A_i
   </math>
   falls below a default threshold
   <math display="inline">
    D_i
   </math>
   : the default event at time T is defined as
   <math display="inline">
    \{A_i \leq D_i\} \subseteq \Omega
   </math>
   , where
   <math display="inline">
    A_i
   </math>
   is a real-valued random variable on the probability space
   <math display="inline">
    (\Omega, \mathcal{A}, \mathbb{P})
   </math>
   and
   <math display="inline">
    D_i \in \mathbb{R}
   </math>
   . The portfolio loss variable is defined by
  </p>
  <p block-type="Equation">
   <math display="block">
    L := \sum_{i=1}^{n} l_i \cdot \mathbf{1}_{\{A_i \le D_i\}} \tag{1}
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <i>
    n
   </i>
   denotes the number of counterparties and
   <math display="inline">
    l_i
   </math>
   is the loss-at-default of the
   <math display="inline">
    i
   </math>
   th counterparty. To reflect risk concentrations, each
   <math display="inline">
    A_i
   </math>
   is decomposed into a sum of systematic factors
   <math display="inline">
    X_1, \ldots, X_m
   </math>
   , which are often identified with geographic regions or industries, and an idiosyncratic (or firm-specific) factor
   <math display="inline">
    Z_i
   </math>
   , that
  </p>
  <p block-type="Text">
   is
   <math display="inline">
    A_i
   </math>
   has the representation
  </p>
  <p block-type="Equation">
   <math display="block">
    A_i = \sqrt{R_i^2} \sum_{j=1}^m w_{ij} X_j + \sqrt{1 - R_i^2} Z_i \qquad (2)
   </math>
  </p>
  <p block-type="TextInlineMath">
   The idiosyncratic factors are independent of each other as well as independent of the systematic factors. It is usually assumed that the factors follow a multivariate Gaussian distribution. We refer to this class of models as
   <i>
    Gaussian multifactor models
   </i>
   .&lt;sup&gt;b&lt;/sup&gt; The impact of the risk factors on
   <math display="inline">
    A_i
   </math>
   is determined by
   <math display="inline">
    R_i^2 \in [0, 1]
   </math>
   and the factor weights
   <math display="inline">
    w_{ii} \in \mathbb{R}
   </math>
   .
  </p>
  <p block-type="TextInlineMath">
   To quantify portfolio risk, measures of risk are applied to the portfolio loss distribution
   <math display="inline">
    (1)
   </math>
   . The most widely used risk measures in banking are Value-at-Risk and expected shortfall: Value-at-Risk Va
   <math display="inline">
    R_{\alpha}(L)
   </math>
   of L at level
   <math display="inline">
    \alpha \in (0, 1)
   </math>
   is simply an
   <math display="inline">
    \alpha
   </math>
   -quantile of L, whereas expected shortfall of L at level
   <math display="inline">
    \alpha
   </math>
   is defined by
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{ES}_{\alpha}(L) := (1-\alpha)^{-1} \int_{\alpha}^{1} \mathrm{VaR}_{u}(L) \mathrm{d}u
   </math>
  </p>
  <p block-type="TextInlineMath">
   For most practical applications, the average of all losses above the
   <math display="inline">
    \alpha
   </math>
   -quantile is a good approximation of
   <math display="inline">
    \text{ES}_{\alpha}(L)
   </math>
   : for
   <math display="inline">
    c := \text{VaR}_{\alpha}(L)
   </math>
   we have
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{ES}_{\alpha}(L) \approx \mathrm{E}(L|L&gt;c) = (1-\alpha)^{-1} \int L \cdot \mathbf{1}_{\{L&gt;c\}} \, \mathrm{d}\mathbb{P}
   </math>
   (3)
  </p>
  <p block-type="Text">
   This approximation is an exact equality unless the distribution of
   <math display="inline">
    L
   </math>
   has an atom at
   <math display="inline">
    c
   </math>
   , a situation that very rarely arises in practice.
  </p>
  <h4>
   <b>
    Simulation Techniques
   </b>
  </h4>
  <p block-type="Text">
   Since the portfolio loss distribution
   <math display="inline">
    (1)
   </math>
   does not have analytic form, the actual calculation and allocation of portfolio risk is a challenging problem. Saddlepoint techniques have been successfully applied to certain types of portfolios; see, for example, [10] or see Saddlepoint Approximation. The most flexible approach, however, is based on MC simulation of the portfolio loss distribution. The following are the main steps in generating one MC sample:
  </p>
  <p block-type="Text">
   1. calculation of a sample
   <math display="inline">
    (x_1, \ldots, x_m)
   </math>
   of the correlated systematic factors and a sample
   <math display="inline">
    (z_1, \ldots, z_n)
   </math>
   of the independent idiosyncratic factors;
  </p>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     2. calculation of the corresponding values
     <math display="inline">
      (a_1, \ldots, a_n)
     </math>
     <math display="inline">
      a_n
     </math>
     ) of the ability-to-pay variables using equation
     <math display="inline">
      (2);
     </math>
    </li>
    <li block-type="ListItem">
     3. calculation of the set of defaulted counterparties defined by
     <math display="inline">
      Def := \{i \in \{1, \ldots, n\} \mid a_i &lt; D_i\};
     </math>
    </li>
    <li block-type="ListItem">
     4. calculation of the portfolio loss: the sum
     <math display="inline">
      \sum_{i \in Def} l_i
     </math>
     is a sample of the portfolio loss distribution
    </li>
   </ul>
  </p>
  <p block-type="TextInlineMath">
   The MC scenarios of the portfolio loss distribution are used as input for the calculation of risk measures. As an example, we compute expected shortfall with respect to the
   <math display="inline">
    \alpha = 99.9\%
   </math>
   quantile based on
   <math display="inline">
    k = 100\,000
   </math>
   MC samples
   <math display="inline">
    s_1 \ge s_2 \ge \ldots \ge s_k
   </math>
   of the portfolio loss L. Then
   <math display="inline">
    ES_{\alpha}(L)
   </math>
   becomes
  </p>
  <p block-type="Equation">
   <math display="block">
    (1-\alpha)^{-1} \int L \cdot \mathbf{1}_{\{L&gt;c\}} \, \mathrm{d}\mathbb{P} \approx \sum_{i=1}^{100} s_i/100 \qquad (4)
   </math>
  </p>
  <p block-type="Text">
   Since
   <math display="inline">
    ES_{\alpha}(L)
   </math>
   is calculated as the average of 100 samples only, the MC estimate is subject to large statistical fluctuations and is numerically unstable. This is even truer for expected shortfall contributions of individual transactions. A significantly higher number of samples has to be computed, which makes straightforward MC simulation impracticable for large credit portfolios.
  </p>
  <p block-type="Text">
   Different techniques have been developed that reduce the variance of MC simulations and—as a consequence—the number of samples required for stable results. We refer to [4] for a general introduction to variance reduction techniques including control variates, antithetic variables, stratified sampling, moment matching, and importance sampling. Recent research
   <math display="inline">
    [3, 5-9, 12, 14]
   </math>
   has shown that importance sampling is particularly efficient for stabilizing MC simulation in Gaussian multifactor models. Importance sampling attempts to reduce variance by changing the probability measure used for generating MC samples. In the above setting, the integral in equation
   <math display="inline">
    (3)
   </math>
   is replaced by the equivalent integral on the right-hand side of the equation
  </p>
  <p block-type="Equation">
   <math display="block">
    \int L \cdot \mathbf{1}_{\{L&gt;c\}} \, \mathrm{d}\mathbb{P} = \int L \cdot \mathbf{1}_{\{L&gt;c\}} \cdot f \, \mathrm{d}\bar{\mathbb{P}} \qquad (5)
   </math>
  </p>
  <p block-type="TextInlineMath" class="has-continuation">
   where
   <math display="inline">
    \mathbb{P}
   </math>
   is absolutely continuous with respect to the probability measure
   <math display="inline">
    \bar{\mathbb{P}}
   </math>
   and has (Radon–Nikodym) density
   <math display="inline">
    f
   </math>
   . This change of measure results in the MC
  </p>
  <p block-type="Text">
   estimate
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{ES}_{\alpha}(L)_{k,\bar{\mathbb{P}}} := \frac{1}{k} \sum_{i=1}^{k} L_{\bar{\mathbb{P}}}(i) \cdot \mathbf{1}_{\{L_{\bar{\mathbb{P}}}(i) &gt; c\}} \cdot f(i) \qquad (6)
   </math>
  </p>
  <p block-type="Text">
   where
   <math display="inline">
    L_{\bar{p}}(i)
   </math>
   is a realization of the portfolio loss L under the probability measure
   <math display="inline">
    \bar{\mathbb{P}}
   </math>
   and
   <math display="inline">
    f(i)
   </math>
   is the corresponding value of the density function. The objective is to choose the probability measure
   <math display="inline">
    \bar{\mathbb{P}}
   </math>
   in such a way that the variance of the MC estimate for the integral (5) is minimal under
   <math display="inline">
    \bar{\mathbb{P}}
   </math>
   . A general formula for the optimal importance sampling measure
   <math display="inline">
    \bar{\mathbb{P}}
   </math>
   is given in [15], which transforms equation (6) into a zerovariance estimator. However, since the construction requires knowledge of the integral (3) itself, the optimal measure cannot be used in the actual calculation. Nevertheless, it provides guidance on the design of an effective importance sampling strategy. Another technique for measure transformation, called
   <i>
    exponential tilting
   </i>
   , applies exponential families of distributions, which are specified by cumulant generating functions [1, 4]. As a general rule, detailed knowledge about the model (often in the form of asymptotic approximations) is indispensable for the construction of importance sampling algorithms. It is precisely this feature of importance sampling that makes the practical application more difficult but, on the other hand, increases the effectiveness of the methodology.
  </p>
  <p block-type="Text">
   Importance sampling in Gaussian multifactor models utilizes the conditional independence of ability-to-pay variables by splitting the simulation of the portfolio loss distribution into two steps (compare to [11] in the more general context of mixture models). In a first step, importance sampling is used to simulate the systematic factors, and then the independence of the ability-to-pay variables conditional on systematic scenarios is exploited, for example, by another application of importance sampling or by limit theorems
   <math display="inline">
    [7, 8]
   </math>
   .
  </p>
  <p block-type="Text" class="has-continuation">
   A natural importance sampling measure
   <math display="inline">
    \bar{\mathbb{P}}
   </math>
   for the systematic factors is a negative shift, that is, the systematic factors have a negative mean under
   <math display="inline">
    \mathbb{P}
   </math>
   , which enforces a higher number of defaults and therefore increases the stability of the MC estimate. For calculating the shift, Glasserman and Li [7] minimize an upper bound on the second moment of the importance sampling estimator of the tail probability. Furthermore, they show that the corresponding importance sampling scheme is asymptotically optimal. The approach in
   <math display="inline">
    [8, 9]
   </math>
   utilizes the infinite
  </p>
  <p block-type="Text">
   granularity approximation of the portfolio loss distribution (compare to [16]). More precisely, the original portfolio
   <math display="inline">
    P
   </math>
   is approximated by a homogeneous and infinitely granular portfolio
   <math display="inline">
    \bar{P}
   </math>
   . The loss distribution of
   <math display="inline">
    \overline{P}
   </math>
   can be specified by a Gaussian one-factor model. The calculation of the shift of the systematic factors is now done in two steps: in the first step, the optimal mean is calculated in the one-factor setting and then the scalar mean is lifted to a mean vector for the systematic factors in the original multifactor model. Other importance sampling techniques [3, 6] are based on the Robbins-Monro stochastic approximation method or use large deviation analysis to calculate multiple mean shifts.
  </p>
  <p block-type="Text">
   The efficiency of the proposed variance reduction schemes heavily depends on the portfolio characteristics. For example, the technique proposed in [8, 9] is tailored to large and well-diversified portfolios. For those portfolios the analytic loss distribution of the infinitely granular portfolio provides an excellent fit, which typically reduces the variance—and therefore the number of required MC scenarios-by a factor of more than 100. Smaller portfolios with low dependence on systematic factors, on the other hand, are dominated by idiosyncratic risk, which increases the relative importance of variance reduction techniques on idiosyncratic factors [7, 8], for example, importance sampling based on exponential tilting.
  </p>
  <h3>
   <b>
    End Notes
   </b>
  </h3>
  <p block-type="Text">
   &lt;sup&gt;a.&lt;/sup&gt;The views expressed in this article are those of the author and do not necessarily reflect the position of Deutsche Bank AG.
  </p>
  <p block-type="Text">
   &lt;sup&gt;b.&lt;/sup&gt;A survey on credit portfolio modeling can be found in [2, 11].
  </p>
  <h4>
   References
  </h4>
  <p block-type="ListGroup" class="has-continuation">
   <ul>
    <li block-type="ListItem">
     Barndorff-Nielsen, O. (1978). Information and Exponen-[1] tial Families, Wiley.
    </li>
    <li block-type="ListItem">
     [2] Bluhm, C., Overbeck, L. &amp; Wagner, C. (2002). An Introduction to Credit Risk Modeling, CRC Press/Chapman &amp; Hall.
    </li>
   </ul>
  </p>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     Egloff, D., Leippold, M., Jöhri, S. &amp; Dalbert, C. [3] (2005). Optimal Importance Sampling for Credit Portfolios with Stochastic Approximations. Working paper, Zürcher Kantonalbank, Zurich.
    </li>
    <li block-type="ListItem">
     Glasserman, P. (2004). Monte Carlo Methods in Finan-[4] cial Engineering, Springer.
    </li>
    <li block-type="ListItem">
     [5] Glasserman, P. (2005). Measuring marginal risk contributions in credit portfolios, Journal of Computational Finance 9. 1-41.
    </li>
    <li block-type="ListItem">
     Glasserman, P., Kang, W. &amp; Shahabuddin, P. (2007). [6] Fast Simulation of Multifactor Portfolio Credit Risk. Working paper, Columbia University, New York.
    </li>
    <li block-type="ListItem">
     Glasserman, P. &amp; Li, J. (2005). Importance sam-[7] pling for portfolio credit risk, Management Science 51, 1643-1656.
    </li>
    <li block-type="ListItem">
     Kalkbrener, M., Kennedy, A. &amp; Popp, M. (2007). [8] Efficient calculation of expected shortfall contributions in large credit portfolios, Journal of Computational Finance 11, 45-77.
    </li>
    <li block-type="ListItem">
     Kalkbrener, M., Lotter, H. &amp; Overbeck, L. (2004). [9] Sensible and efficient capital allocation for credit portfolios, Risk 17(1), S19-S24.
    </li>
    <li block-type="ListItem">
     [10] Martin, R., Thompson, K. &amp; Browne, C. (2001). Taking to the saddle, Risk 14(6), 91-94.
    </li>
    <li block-type="ListItem">
     [11] McNeil, A.J., Frey, R. &amp; Embrechts, P. (2005).
     <i>
      Quan
     </i>
     titative Risk Management: Concepts, Techniques, and Tools, Princeton University Press.
    </li>
    <li block-type="ListItem">
     [12] Merino, S. &amp; Nyfeler, M. (2004). Applying importance sampling for estimating coherent credit risk contributions,
     <i>
      Quantitative Finance
     </i>
     4, 199-207.
    </li>
    <li block-type="ListItem">
     [13] Merton, R. (1974). On the pricing of corporate debt: the risk structure of interest rates, Journal of Finance 29, 449-470.
    </li>
    <li block-type="ListItem">
     [14] Morokoff, W.J. (2004). An importance sampling method for portfolios of credit risky assets, Proceedings of the 2004 Winter Simulation Conference, IEEE Press, pp. 1668-1676.
    </li>
    <li block-type="ListItem">
     [15] Rubinstein, R.Y. (1981). Simulation and the Monte Carlo Method, Wiley.
    </li>
    <li block-type="ListItem">
     [16] Vasicek, O. (2002). Loan portfolio value,
     <i>
      Risk
     </i>
     <b>
      15
     </b>
     (12),
     <math display="inline">
      160 - 162.
     </math>
    </li>
   </ul>
  </p>
  <h2>
   <b>
    Related Articles
   </b>
  </h2>
  <p block-type="Text">
   Large Pool Approximations; Monte Carlo Simulation; Structural Default Risk Models; Saddlepoint Approximation; Variance Reduction.
  </p>
  <p block-type="Text">
   MICHAEL KALKBRENER
  </p>
 </body>
</html>
