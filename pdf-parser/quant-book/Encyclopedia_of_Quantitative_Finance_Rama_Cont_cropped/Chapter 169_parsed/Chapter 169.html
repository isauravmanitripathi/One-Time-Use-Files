<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
 </head>
 <body>
  <h1>
   <b>
    Large Pool
   </b>
   Approximations
  </h1>
  <p block-type="Text">
   The loss distribution of a large credit portfolio can be valued by Monte Carlo methods. This is perhaps the most common approach used by practitioners today. The problem is that Monte Carlo methods are computationally intensive usually taking a significant amount of time to achieve the required accuracy. Therefore, although such methods may lend themselves to pricing and structuring of credit derivatives, they are not appropriate for risk management where simulation and stress testing are required. In fact, nesting a second level of simulation, for pricing, within the risk management simulation represents a performance challenge.
  </p>
  <p block-type="Text">
   Analytical approximations of losses of large portfolios represent an efficient alternative to Monte Carlo simulation. The following methods can be applied for approximation of a large portfolio's loss distribution: the law of large numbers (LLN), the central limit theorem (CLT), and large deviation theory.
  </p>
  <p block-type="Text">
   The analytical methods for approximation of credit portfolio losses are usually applied in an additive scheme: the portfolio losses due to default,
   <math display="inline">
    \mathcal{L}
   </math>
   , over some fixed time horizon (single step) are represented as
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathcal{L} = \sum_{k=1}^{K} L_k \tag{1}
   </math>
  </p>
  <p block-type="Text">
   where
   <math display="inline">
    L_k
   </math>
   is the loss of the
   <i>
    k
   </i>
   th name in the portfolio and
   <math display="inline">
    K
   </math>
   is the number of names. Application of limit theorems for stochastic process becomes quite natural as
   <math display="inline">
    K
   </math>
   increases. The main technical difficulties are related to dependency of default events and losses of the counterparties.
  </p>
  <p block-type="Text" class="has-continuation">
   The analytical methods for portfolio losses are applied in the conditional independence framework pioneered in [14] (see also [7, 9]), based on the assumption that there is a random vector,
   <math display="inline">
    X
   </math>
   , such that conditional on the values of
   <math display="inline">
    X
   </math>
   , the default events are independent. Usually,
   <math display="inline">
    X
   </math>
   is interpreted as a vector of credit drivers describing the state of the economy or a sector of the economy, at the end of the time horizon
   <math display="inline">
    [3, 5, 8, 12]
   </math>
   . In multistep models, X can be a random process describing the dynamics of the credit drivers [7]. In this case, computation of conditional default and migration probabilities requires efficient
  </p>
  <p block-type="Text">
   numerical quadratures for multidimensional integrals [7]. The multistep portfolio modeling is applied when it is necessary to incorporate the effect of stochastic portfolio exposure, as in the integrated market and credit risk framework in [7].
  </p>
  <p block-type="TextInlineMath">
   <b>
    The notation
   </b>
   <math display="inline">
    \mathbb{P}_x
   </math>
   denotes the regular conditional probability measure, conditional on
   <math display="inline">
    X = x
   </math>
   ;
   <math display="inline">
    \mathbb{E}_x
   </math>
   is the corresponding conditional expectation operator.
  </p>
  <p block-type="Text">
   A general approach to approximate the distribution of the random variable
   <math display="inline">
    \mathcal{L}
   </math>
   can be described as follows:
  </p>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     Choose a sufficiently rich family of distributions, 1.
     <math display="inline">
      F_{\theta}
     </math>
     , such that
     <math display="inline">
      \theta \mapsto F_{\theta}
     </math>
     is a Borel measurable mapping of a vector of parameters
     <math display="inline">
      \theta
     </math>
     .
    </li>
    <li block-type="ListItem">
     2. Fix a value of the variable,
     <math display="inline">
      X = x
     </math>
     and compute parameters,
     <math display="inline">
      \theta(x)
     </math>
     , of the approximating family of distributions,
     <math display="inline">
      F_{\theta(x)}(\ell)
     </math>
     , such that the conditional distribution,
     <math display="inline">
      \mathbb{P}_x(\mathcal{L} \leq \ell) = \mathbb{P}(\mathcal{L} \leq \ell \mid X = x)
     </math>
     , is approximated by
     <math display="inline">
      F_{\theta(x)}(\ell)
     </math>
     . (It is assumed that
     <math display="inline">
      x \mapsto \theta(x)
     </math>
     is Borel measurable, so that
     <math display="inline">
      x \mapsto
     </math>
     <math display="inline">
      F_{\theta(x)}(\ell)
     </math>
     is also measurable, for each
     <math display="inline">
      \ell
     </math>
     .)
    </li>
    <li block-type="ListItem">
     Find the unconditional approximating distribu-3. tion by integration over the distribution,
     <math display="inline">
      G_X
     </math>
     , of the variable
     <math display="inline">
      X
     </math>
     :
    </li>
   </ul>
  </p>
  <p block-type="Equation">
   <math display="block">
    F^*(\ell) = \int F_{\theta(x)}(\ell) \, \mathrm{d}G_X(x) \tag{2}
   </math>
  </p>
  <h1>
   Law of Large Numbers: Vasicek Approximation
  </h1>
  <p block-type="TextInlineMath">
   The first key result was obtained in [14, 13] for homogeneous portfolios. The
   <math display="inline">
    K
   </math>
   random variables,
   <math display="inline">
    L_k
   </math>
   , can be expressed as
   <math display="inline">
    L_k = N \cdot I_k
   </math>
   , where
   <math display="inline">
    I_k
   </math>
   is the indicator of default of the
   <math display="inline">
    k
   </math>
   th name and
   <math display="inline">
    N
   </math>
   is the constant loss given default. The random variables
   <math display="inline">
    I_k
   </math>
   are identically distributed and their sum,
   <math display="inline">
    \nu =
   </math>
   <math display="inline">
    \sum_{k=1}^{K} I_k
   </math>
   , is the number of names in default. The portfolio losses
   <math display="inline">
    \mathcal{L} = N \nu
   </math>
   .
  </p>
  <p block-type="TextInlineMath">
   The variable,
   <math display="inline">
    X
   </math>
   , in the Vasicek model is latent and has a standard normal distribution,
   <math display="inline">
    \Phi(x)
   </math>
   . Conditional on
   <math display="inline">
    X = x
   </math>
   , the default events are independent and v has a binomial distribution with parameter
   <math display="inline">
    p(x) =
   </math>
   <math display="inline">
    \mathbb{P}(I_k = 1 \mid X = x)
   </math>
   so that
  </p>
  <p block-type="Equation">
   <math display="block">
    \int_{-\infty}^{\infty} p(x) \, \mathrm{d}\Phi(x) = \pi_* \tag{3}
   </math>
  </p>
  <p block-type="Text" class="has-continuation">
   where
   <math display="inline">
    \pi_*
   </math>
   is the common unconditional probability of default. The unconditional distribution of
   <math display="inline">
    \nu
   </math>
   is then a
  </p>
  <p block-type="Text">
   generalized binomial distribution and
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbb{P}(\mathcal{L} = mN) = \mathbb{P}(v = m)
   </math>
   <math display="block">
    = {K \choose m} \int_{-\infty}^{\infty} p^{m}(x) q^{K-m}(x) \, \mathrm{d}\Phi(x),
   </math>
   <math display="block">
    m = 0, 1, \dots, K \tag{4}
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    q(x) = 1 - p(x)
   </math>
   .
  </p>
  <p block-type="Text">
   The following specification&lt;sup&gt;a&lt;/sup&gt; of the conditional default probability is widely used in the literature [6, 14], and so on.
  </p>
  <p block-type="Equation">
   <math display="block">
    p(x) = \Phi\left(\frac{H - \beta x}{\sigma}\right) \qquad \beta^2 + \sigma^2 = 1 \quad (5)
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    H = \Phi^{-1}(\pi_*)
   </math>
   , and
   <math display="inline">
    \beta
   </math>
   is a parameter that determines the correlation between default events.
  </p>
  <p block-type="TextInlineMath">
   Consider the ratio
   <math display="inline">
    v_K = v/K
   </math>
   determining the portfolio losses. If
   <math display="inline">
    \beta = 0
   </math>
   , then
   <math display="inline">
    p(x) \equiv \pi_*
   </math>
   and
  </p>
  <p block-type="Equation">
   <math display="block">
    \lim_{K \to \infty} \nu_K = \pi_* \quad \text{almost surely} \tag{6}
   </math>
  </p>
  <p block-type="TextInlineMath">
   in accordance with the strong law of large numbers. If
   <math display="inline">
    \beta \neq 0
   </math>
   the limit in equation (6) is in distribution, to a random variable with the same distribution as
   <math display="inline">
    \xi = p(X)
   </math>
   . Thus, one obtains
  </p>
  <p block-type="Equation">
   <math display="block">
    \lim_{K \to \infty} \mathbb{P} \left( \nu_K \le \ell \right) = \Phi \left( \frac{\sigma \Phi^{-1}(\ell) - H}{\beta} \right), \quad 0 \le \ell \le 1 \tag{7}
   </math>
  </p>
  <p block-type="Text">
   It follows from equation
   <math display="inline">
    (7)
   </math>
   that the quantile approximation,
   <math display="inline">
    \ell_q^*
   </math>
   , corresponding to the probability q, is
  </p>
  <p block-type="Equation">
   <math display="block">
    \ell_q^* = N\Phi\left(\frac{\beta\Phi^{-1}(q) + H}{\sigma}\right) \tag{8}
   </math>
  </p>
  <p block-type="TextInlineMath">
   In terms of the general approach, one has
   <math display="inline">
    \theta = \mu
   </math>
   with
   <math display="inline">
    F_{\theta}(\ell) = \mathbb{1}_{[\mu,\infty)}(\ell) \text{ and } \theta(x) \equiv \mu(x) = K N p(x).
   </math>
  </p>
  <h2>
   <b>
    Central Limit Theorem
   </b>
  </h2>
  <p block-type="Text">
   The heterogeneous case is treated at the outset, as it is no more difficult than the homogeneous case, which is described as a special case at the end. Once again, X is univariate and latent. Denote by
   <math display="inline">
    N_k
   </math>
   , the loss
  </p>
  <p block-type="TextInlineMath">
   given default of the
   <math display="inline">
    k
   </math>
   th name in the portfolio, and by
   <math display="inline">
    p_k(x)
   </math>
   , the conditional default probability of the kth name. Then the conditional mean,
   <math display="inline">
    \mu(x)
   </math>
   , and the conditional variance,
   <math display="inline">
    \sigma^2(x)
   </math>
   , of the portfolio losses are
  </p>
  <p block-type="Equation">
   <math display="block">
    \mu(x) = \sum_{k=1}^{K} N_k p_k(x),
   </math>
   <br/>
   <math display="block">
    \sigma^2(x) = \sum_{k=1}^{K} N_k^2 p_k(x) \cdot (1 - p_k(x)) \qquad (9)
   </math>
  </p>
  <p block-type="Text">
   Under mild conditions on the notionals,
   <math display="inline">
    N_k
   </math>
   (which are vacuous in the homogeneous case), the conditional distribution of the portfolio losses satisfies
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbb{P}_{x}\left(\frac{\mathcal{L}-\mu(x)}{\sigma(x)} \leq \ell\right) \to \Phi(\ell) \quad \text{as } K \to \infty
   </math>
   (10)
  </p>
  <p block-type="TextInlineMath">
   Let a probability,
   <math display="inline">
    q
   </math>
   ,
   <math display="inline">
    0 &lt; q &lt; 1
   </math>
   , be fixed and consider the equation
  </p>
  <p block-type="Equation">
   <math display="block">
    q = \mathbb{P}(\mathcal{L} \le \ell_q) \tag{11}
   </math>
  </p>
  <p block-type="Text">
   for the quantile of the distribution of the random variable
   <math display="inline">
    \mathcal{L}
   </math>
   . One has
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbb{P}(\mathcal{L} \leq \ell_q) = \int_{-\infty}^{\infty} \mathbb{P}_x(\mathcal{L} \leq \ell_q) \, \mathrm{d}\Phi(x)
   </math>
   <math display="block">
    \stackrel{\cdot}{=} \int_{-\infty}^{\infty} \Phi\left(\frac{\ell_q - \mu(x)}{\sigma(x)}\right) \mathrm{d}\Phi(x) \quad (12)
   </math>
  </p>
  <p block-type="Text">
   Therefore the quantile approximation,
   <math display="inline">
    \ell_a^*
   </math>
   , is the solution of the equation
  </p>
  <p block-type="Equation">
   <math display="block">
    q = \int_{-\infty}^{\infty} \Phi\left(\frac{\ell_q^* - \mu(x)}{\sigma(x)}\right) d\Phi(x) \qquad (13)
   </math>
  </p>
  <p block-type="TextInlineMath">
   In terms of the general approach, one has
   <math display="inline">
    \theta = (\mu, \sigma)
   </math>
   with
   <math display="inline">
    F_{\theta}(\ell) = \Phi\left(\frac{\ell-\mu}{\sigma}\right)
   </math>
   and
   <math display="inline">
    \theta(x) = (\mu(x), \sigma(x)).
   </math>
  </p>
  <p block-type="Text">
   In the case of a homogeneous portfolio, considered in
   <math display="inline">
    [14, 13]
   </math>
   one has the simplifications
  </p>
  <p block-type="Equation">
   <math display="block">
    \mu(x) = K N p(x) \quad \sigma^2(x) = K N^2 \left( p(x) - p^2(x) \right) \tag{14}
   </math>
  </p>
  <p block-type="Text">
   The normal approximation is just the classical central limit theorem (CLT). The equation for the quantile approximation simplifies to
  </p>
  <p block-type="Equation">
   <math display="block">
    q = \int_{-\infty}^{\infty} \Phi\left(\frac{\ell_q^* / N - Kp(x)}{\sqrt{Kp(x)(1 - p(x))}}\right) \mathrm{d}\Phi(x) \quad (15)
   </math>
  </p>
  <h4>
   <b>
    Generalized Poisson Approximation
   </b>
  </h4>
  <p block-type="Text">
   Consider a homogeneous portfolio, for which the number,
   <math display="inline">
    K
   </math>
   , of obligors is moderately large but not very large. If also the conditional mean number of default events in the portfolio,
   <math display="inline">
    K \cdot p(x)
   </math>
   , takes moderate values, the conditional distribution of
   <math display="inline">
    \nu
   </math>
   might be better approximated by a Poisson distribution
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbb{P}_x(\nu = m) \doteq \exp\left(-\lambda(x)\right) \frac{\lambda^m(x)}{m!}, \quad m = 0, 1, 2, \dots
   </math>
   (16)
  </p>
  <p block-type="TextInlineMath">
   than by a normal distribution, where
   <math display="inline">
    \lambda(x) = Kp(x)
   </math>
   . In this case, the (unconditional) portfolio losses can be approximated by the generalized Poisson distribution: for moderately large
   <math display="inline">
    K
   </math>
   ,
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbb{P}(\mathcal{L}=mN) \doteq \int e^{-\lambda(x)} \frac{\lambda^m(x)}{m!} \, \mathrm{d}G_X(x),
   </math>
   <br/>
   <math display="block">
    m = 0, 1, 2 \dots. \tag{17}
   </math>
  </p>
  <p block-type="TextInlineMath">
   In terms of the general approach, one has
   <math display="inline">
    F_{\theta}
   </math>
   being the Poisson distribution function with mean
   <math display="inline">
    \theta
   </math>
   and
   <math display="inline">
    \theta(x) = \lambda(x).
   </math>
  </p>
  <p block-type="Text">
   In particular, for the quantile approximation, one obtains
  </p>
  <p block-type="Equation">
   <math display="block">
    q = \int \sum_{m=0}^{\ell_q^*/N} e^{-\lambda(x)} \frac{\lambda^m(x)}{m!} dG_X(x) \qquad (18)
   </math>
  </p>
  <h4>
   <b>
    Compound Poisson Approximation
   </b>
  </h4>
  <p block-type="Text" class="has-continuation">
   In order to extend the result of the previous section to heterogeneous portfolios, one needs to consider compound Poisson distributed random variables. The compound Poisson distribution is a well known approximation in insurance models [11]. In risk management of credit derivatives, the approach
  </p>
  <p block-type="Text">
   was used in [2] and [6] for synthetic collateralized debt obligation (CDO) pricing. The same approach is applicable for approximation of portfolio losses.
  </p>
  <p block-type="Text">
   In the case of a heterogeneous portfolio, it is not sufficient to approximate the distribution of the number of losses suffered. One must keep track of who defaults or at least the sizes of the individual potential losses because, given only the number of defaults, one cannot infer the losses incurred. To see how this added complexity is handled and how the compound Poisson distribution arises quite naturally, the simplest heterogeneous case is analyzed first; namely, when there are only two distinct recoveryadjusted notional values among the obligors in the portfolio.
  </p>
  <p block-type="TextInlineMath">
   Denote by
   <math display="inline">
    N_{(1)}
   </math>
   and
   <math display="inline">
    N_{(2)}
   </math>
   , the two distinct values of the recovery-adjusted notionals in the pool. The portfolio then divides into two groups: one with obligors having the common recovery-adjusted notional equaling
   <math display="inline">
    N_{(1)}
   </math>
   ; the other having common recovery-adjusted notional equaling
   <math display="inline">
    N_{(2)}
   </math>
   . Denote the number of defaults in each of the two groups, by
   <math display="inline">
    v_1
   </math>
   and
   <math display="inline">
    v_2
   </math>
   , respectively. Conditionally, their distributions are independent and can be approximated by a Poisson distribution with conditional mean
   <math display="inline">
    \lambda_i(x) = \sum_{k: N_k = N_{(i)}} p_k(x), i = 1, 2,
   </math>
   provided both group sizes are moderately large. (This assumption on the group sizes, is only being made in the context of this example.) The total number of defaults in the portfolio,
   <math display="inline">
    \nu = \nu_1 + \nu_2
   </math>
   , is conditionally Poisson with conditional mean
   <math display="inline">
    \lambda(x) = \lambda_1(x) +
   </math>
   <math display="inline">
    \lambda_2(x)
   </math>
   . The total portfolio loss is the sum of the losses of the first and second groups:
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathcal{L} = \nu_1 N_{(1)} + \nu_2 N_{(2)} \tag{19}
   </math>
  </p>
  <p block-type="TextInlineMath">
   As a positive linear combination of conditionally independent Poisson random variables,
   <math display="inline">
    L
   </math>
   is conditionally a compound Poisson random variable with the same distribution as that of
  </p>
  <p block-type="Equation">
   <math display="block">
    \tilde{\mathcal{L}} := \sum_{j=1}^{\nu} \mathcal{N}^{(j)} \tag{20}
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    \mathcal{N}^{(j)}
   </math>
   is a conditionally independent and identically distributed (i.i.d.) sequence of random variables, each taking two values,
   <math display="inline">
    N_{(1)}
   </math>
   and
   <math display="inline">
    N_{(2)}
   </math>
   , with corresponding conditional probabilities
   <math display="inline">
    \frac{\lambda_1(x)}{\lambda(x)}
   </math>
   and
   <math display="inline">
    \frac{\lambda_2(x)}{\lambda(x)}
   </math>
   and conditionally independent of
   <math display="inline">
    \nu
   </math>
   . (This is an elementary
  </p>
  <p block-type="TextInlineMath">
   calculation using the conditional characteristic functions of
   <math display="inline">
    \mathcal{L}
   </math>
   and
   <math display="inline">
    \mathcal{L}
   </math>
   .) More formally, the conditional distribution of
   <math display="inline">
    \mathcal{N}^{(j)}
   </math>
   is
  </p>
  <p block-type="Equation">
   <math display="block">
    f(N;x) \equiv \mathbb{P}_x \left( \mathcal{N}^{(j)} = N \right)
   </math>
   <math display="block">
    = \begin{cases} \frac{\lambda_1(x)}{\lambda(x)}, &amp; N = N_{(1)} \\ \frac{\lambda_2(x)}{\lambda(x)}, &amp; N = N_{(2)} \end{cases} \tag{21}
   </math>
  </p>
  <p block-type="TextInlineMath">
   In the general case where the recovery-adjusted notionals take more than two values, the conditional distribution of the random variable,
   <math display="inline">
    \mathcal{N}^{(j)}
   </math>
   , is
  </p>
  <p block-type="Equation">
   <math display="block">
    f(N;x) = \sum_{k:N_k=N} p_k(x)/\lambda(x) \tag{22}
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    \lambda(x) = \sum_{k=1}^{K} p_k(x)
   </math>
   and N represents a possible individual loss
  </p>
  <p block-type="TextInlineMath">
   In the special case where
   <math display="inline">
    p_k
   </math>
   does not depend on
   <math display="inline">
    k, f
   </math>
   is simply the relative frequency of the notional values and does not depend on
   <math display="inline">
    x
   </math>
   :
  </p>
  <p block-type="Equation">
   <math display="block">
    f(N) = [\#k \in \{1, 2, \dots, K\} : N_k = N]/K \quad (23)
   </math>
  </p>
  <p block-type="TextInlineMath">
   In general, the function
   <math display="inline">
    f(N;x)
   </math>
   is a probability mass function with respect to
   <math display="inline">
    N
   </math>
   , which approximates the conditional probability that the portfolio loss is of size
   <math display="inline">
    N
   </math>
   , given that there has been only one default.
  </p>
  <p block-type="Text">
   More generally, it can be shown that
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbb{P}_{x}(\mathcal{L}=N|\nu=m) \approx f^{*m}(N;x) \tag{24}
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    f^{\star m}
   </math>
   denotes the
   <i>
    m
   </i>
   -fold convolution of f with itself, as a probability mass function (for notational convenience,
   <math display="inline">
    f^{*1} \equiv f
   </math>
   and
   <math display="inline">
    f^{*0}(N; x) = 1
   </math>
   if and only if
   <math display="inline">
    N = 0
   </math>
   ). Given that there have been exactly m defaults, the pool loss amounts to a sum of
   <math display="inline">
    m
   </math>
   notional amounts but, as one does not know who defaulted, in the heterogeneous case there is still some randomness left; that randomness is captured (approximately) by
   <math display="inline">
    f^{\star m}
   </math>
   .
  </p>
  <p block-type="Text">
   Assuming that a monetary unit has been chosen and that all recovery-adjusted notionals are expressed as integers—that is, integer multiples of the monetary unit—one has the following result
   <math display="inline">
    [6]
   </math>
   :
  </p>
  <p block-type="TextInlineMath">
   <b>
    Theorem 1
   </b>
   In the limiting case of a large portfolio
   <math display="inline">
    (K \text{ large})
   </math>
   , the following approximate equality holds in distribution under
   <math display="inline">
    \mathbb{P}_x
   </math>
   (i.e., conditional on
   <math display="inline">
    X = x
   </math>
   ):
  </p>
  <p block-type="TextInlineMath">
   <i>
    for fixed
   </i>
   <math display="inline">
    i = 1, 2, ..., n
   </math>
   ,
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathcal{L} \stackrel{\mathcal{D}}{\approx} \sum_{m=1}^{\nu} \mathcal{N}^{(m)} \tag{25}
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    (\mathcal{N}^{(m)})_{m=1}^{K}
   </math>
   is an i.i.d. sequence of random variables with common probability mass function
   <math display="inline">
    f
   </math>
   and independent of
   <math display="inline">
    v
   </math>
   , the number of defaults in the pool, which is approximately Poisson distributed under
   <math display="inline">
    \mathbb{P}_r
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \nu \stackrel{D}{\approx} \text{Pois}(\lambda(x)) \tag{26}
   </math>
  </p>
  <p block-type="Text">
   More precisely,
  </p>
  <p block-type="Equation">
   <math display="block">
    \max_{N} \left| \mathbb{P}_{x} \left( \mathcal{L} = N \right) - \mathbb{P}_{x} \left( \sum_{m=1}^{\nu} \mathcal{N}^{(m)} = N \right) \right|
   </math>
   <math display="block">
    = \mathcal{O} \left( \sum_{k=1}^{K} \left( p_{k}(x) \right)^{2} \right) \tag{27}
   </math>
  </p>
  <p block-type="Text">
   For the unconditional loss distribution,
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbb{P}(\mathcal{L} \leq \ell) \doteq \int \sum_{N \leq \ell} \sum_{m=0}^{\infty} f^{*m}(N; x) \frac{e^{-\lambda(x)} \lambda^m(x)}{m!} \, \mathrm{d}G_X(x) \tag{28}
   </math>
  </p>
  <p block-type="TextInlineMath">
   In terms of the general approach, one has
   <math display="inline">
    F_{\theta}
   </math>
   being the compound Poisson distribution function with parameter
   <math display="inline">
    \theta = (\theta_1, \theta_2, \dots, \theta_K) \in [0, 1]^K
   </math>
   and
   <math display="inline">
    \theta(x) =
   </math>
   <math display="inline">
    (p_1(x), p_2(x), \ldots, p_K(x)); F_{\theta}
   </math>
   is defined as
  </p>
  <p block-type="Equation">
   <math display="block">
    F_{\theta} = \sum_{N \le \ell} \sum_{m=0}^{\infty} f^{\star m}(N) \frac{\mathrm{e}^{-\lambda} \lambda^m}{m!} \tag{29}
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    \lambda := \sum_{k=1}^{K} \theta_k
   </math>
   ,
   <math display="inline">
    f(N) := \lambda^{-1} \sum_{k: N_k = N} \theta_k
   </math>
   . In practice, the convolutions, would be calculated recursively using the fast Fourier transform.
  </p>
  <h4>
   <b>
    Large Deviations
   </b>
  </h4>
  <p block-type="Text" class="has-continuation">
   Approximations based on large deviation theory usually lead to exponential approximations of the tail of the conditional portfolio loss distribution. These approximations are derived using the saddlepoint
  </p>
  <p block-type="Text">
   method for the characteristic function of the portfolio losses,
  </p>
  <p block-type="Equation">
   <math display="block">
    \Psi_{\mathcal{L}}(s) = \mathbb{E}[\exp{(is\mathcal{L})}]\n
   </math>
   <math display="block">
    \n= \int \prod_{k=1}^{K} \left(1 - p_k(x) + p_k(x)e^{isN_k}\right) \mathrm{d}G_X(x)\n
   </math>
   (30)
  </p>
  <p block-type="Text">
   The technical details can be found in [1] (see also Saddlepoint Approximation).
  </p>
  <h3>
   <b>
    Other Methods
   </b>
  </h3>
  <p block-type="Text">
   There are some methods of approximation that deal only with quantiles of the loss distribution directly, focusing on quantiles with high quantile probability, which is the case of interest for credit risk. The large deviation approximations are examples of such methods.
  </p>
  <p block-type="Text">
   Another one of these methods is due to Pykhtin [12] who, building on the work of Martin and Wilde [10], adapted the tools of an earlier investigation [4] in market-risk sensitivity to position sizes, to the credit risk setting. Note that this method is a direct. analytical approximation to the quantile of the
   <i>
    unconditional
   </i>
   loss distribution using an approximate model, unlike the other semianalytic methods described so far, which calculate the quantile by making analytical approximations to the conditional loss distribution (conditional on a systemic credit scenario). It is also worth noting that the result is in closed form, a qualitative description of which is given here.
  </p>
  <p block-type="Text">
   Pykhtin's approach can be described at a high level as follows. It consists of a three-stage series of approximations:
  </p>
  <p block-type="ListGroup" class="has-continuation">
   <ul>
    <li block-type="ListItem">
     1. A single-factor model, which is an approximation based on an LLN type of loss function; that is, it is a Vasicek type of model.
     <ul>
      <li block-type="ListItem" class="list-indent-1">
       The single factor is built as a weighted sum a) of the portfolio's counterparties' credit drivers.
      </li>
     </ul>
     <ul>
      <li block-type="ListItem" class="list-indent-1">
       b) The weights are chosen to maximize the single factor's correlation with the drivers.
      </li>
     </ul>
     <ul>
      <li block-type="ListItem" class="list-indent-1">
       The weights use the counterparties' loss c) characteristics such as default probabilities and losses given default.
      </li>
     </ul>
    </li>
   </ul>
  </p>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     2. An analytic adjustment (approximation) to a full multifactor model that is still based on an LLN type of loss function. This adjustment is called a
     <i>
      multifactor
     </i>
     adjustment.
    </li>
    <li block-type="ListItem">
     An analytic adjustment, bridging the LLN-type 3. loss function of the second stage to the usual Merton-type one with full specific risk. This adjustment is called a
     <i>
      granularity
     </i>
     adjustment.
    </li>
   </ul>
  </p>
  <p block-type="Text">
   The reason behind the terminology for the two adjustments, is that for a single-factor model, the multifactor adjustment vanishes, whereas for an infinitely granular portfolio (i.e., a very large, homogeneous one), the granularity adjustment vanishes.
  </p>
  <p block-type="Text">
   The approximations, in both the second and third stages, are based on a single formula for quantile approximation, due originally to Gourieroux et al. [4]. The formula is a second-order Taylor expansion, for the quantile, in a small parameter that is used to express the full loss model as a perturbation of the single-factor model. The first-order Taylor coefficient is the difference between the single-factor (conditional) loss and the conditional expected loss of the full model, conditional on the single factor. The single factor is constructed so that the first-order Taylor term vanishes.
  </p>
  <p block-type="Text">
   The second-order Taylor coefficient is related to the conditional variance of the full loss, conditional on the single factor. The well-known conditional variance decomposition from statistics is used to split the Taylor coefficient into two terms, which are the approximations in the second and third stages.
  </p>
  <p block-type="Text">
   The end result for the entire adjustment to the single-factor quantile, is expressed as a sum of four quadratic forms in the recovery-adjusted exposures, with coefficients involving the bivariate and univariate normal cumulative distribution functions, evaluated in terms of the input statistical parameters of the model. The result is thus in closed form. The reader is referred to
   <math display="inline">
    [12]
   </math>
   for the quantitative details of the construction, the formulae for the terms in the quantile approximation, and a study of the scope of applicability of the method.
  </p>
  <h2>
   <b>
    End Notes
   </b>
  </h2>
  <p>
   <sup>
    &amp;
   </sup>
   lt;sup&gt;a.&lt;/sup&gt;This specification is a partial case of the famous Gaussian copula model [9].
  </p>
  <h2>
   <b>
    References
   </b>
  </h2>
  <p block-type="ListGroup" class="has-continuation">
   <ul>
    <li block-type="ListItem">
     [1] Dembo, A., Deushel, J.-D. &amp; Duffie, D. (2004). Large portfolio losses,
     <i>
      Finance and Stochastics
     </i>
     <b>
      8
     </b>
     (1), 3–16.
    </li>
    <li block-type="ListItem">
     [2] De Prisco, B., Iscoe, I. &amp; Kreinin, A. (2005). Loss in translation,
     <i>
      Risk
     </i>
     <b>
      18
     </b>
     (6), 77–82.
    </li>
    <li block-type="ListItem">
     [3] Gordy, M. (2003). A risk-factor model foundation for ratings-based bank capital rules,
     <i>
      Journal of Financial Intermediation
     </i>
     <b>
      12
     </b>
     (3), 199–232.
    </li>
    <li block-type="ListItem">
     [4] Gourieroux, C., Laurent, J.-P. &amp; Scaillet, O. (2000). Sensitivity analysis of values at risk,
     <i>
      Journal of Empirical Finance
     </i>
     <b>
      7
     </b>
     , 225–245.
    </li>
    <li block-type="ListItem">
     [5] Huang, X., Oosterlee, C. &amp; Mesters, M. (2007). Computation of VaR and VaR contribution in the Vasicek portfolio credit loss model: a comparative study,
     <i>
      The Journal of Credit Risk
     </i>
     <b>
      3
     </b>
     (3), 75–96.
    </li>
    <li block-type="ListItem">
     [6] Iscoe, I. &amp; Kreinin, A. (2007). Valuation of synthetic CDOs,
     <i>
      Journal of Banking and Finance
     </i>
     <b>
      31
     </b>
     , 3357–3376.
    </li>
    <li block-type="ListItem">
     [7] Iscoe, I., Kreinin, A. &amp; Rosen, D. (1999). Integrated market and credit risk portfolio model,
     <i>
      Algorithmics Research Quarterly
     </i>
     <b>
      2
     </b>
     (3), 21–38.
    </li>
    <li block-type="ListItem">
     [8] Koyluoglu, H.U. &amp; Hickman, A. (1998).
     <i>
      A Generalized Framework for Credit Risk Portfolio Models
     </i>
     , Working paper, CSFP Capital.
    </li>
    <li block-type="ListItem">
     [9] Li, D. (1999).
     <i>
      On Default Correlation: A Copula Function Approach
     </i>
     , The RiskMetrics group, Working paper, 99-07.
    </li>
    <li block-type="ListItem">
     [10] Martin, R. &amp; Wilde, T. (2002). Unsystematic credit risk,
     <i>
      Risk
     </i>
     <b>
      15
     </b>
     (11), 123–128.
    </li>
    <li block-type="ListItem">
     [11] Panjer, H. &amp; Willmot, G. (1992).
     <i>
      Insurance Risk Models
     </i>
     , Society of Actuaries, Shaumburg.
    </li>
   </ul>
  </p>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     [12] Pykhtin, M. (2004). Multi-factor adjustment,
     <i>
      Risk
     </i>
     March, 85–90.
    </li>
    <li block-type="ListItem">
     [13] Vasicek, O. (1987).
     <i>
      Probability of Loss on Loan Portfolio
     </i>
     , KMV, available at www.kmv.com
    </li>
    <li block-type="ListItem">
     [14] Vasicek, O. (2002). Loan portfolio value,
     <i>
      Risk
     </i>
     , December.
    </li>
   </ul>
  </p>
  <h2>
   <b>
    Further Reading
   </b>
  </h2>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     Emmer, S. &amp; Tasche, D. (2003).
     <i>
      Calculating Credit Risk Capital Charges with the One-Factor Model
     </i>
     , Working Paper, September 2003.
    </li>
    <li block-type="ListItem">
     Gordy, M. (2002). Saddlepoint approximations of credit risk,
     <i>
      Journal of Banking and Finance
     </i>
     <b>
      26
     </b>
     , 1335–1353.
    </li>
    <li block-type="ListItem">
     Gordy, M. &amp; Jones, D. (2003). Random tranches,
     <i>
      Risk
     </i>
     March, 78–83.
    </li>
    <li block-type="ListItem">
     Gregory, J. &amp; Laurent, J.-P. (2003). I will survive,
     <i>
      Journal of Risk
     </i>
     <b>
      16
     </b>
     (6), 103–108.
    </li>
    <li block-type="ListItem">
     Hull, J. &amp; White, A. (2003). Valuation of a CDO and an
     <i>
      nth
     </i>
     to default CDS without Monte Carlo simulation,
     <i>
      Journal of Derivatives
     </i>
     <b>
      12
     </b>
     (2), 8–23.
    </li>
    <li block-type="ListItem">
     Laurent, J.-P. &amp; Gregory, J. (2003). Basket default swaps, CDO's and factor copulas,
     <i>
      Presentation at the Conference Quant'03
     </i>
     , London, September 2003, p. 21, www.defaultrisk. com
    </li>
    <li block-type="ListItem">
     Schonbucher, P. (2003). ¨
     <i>
      Credit Derivatives Pricing Models
     </i>
     , John Wiley &amp; Sons.
    </li>
   </ul>
  </p>
  <p block-type="Text">
   IAN ISCOE &amp; ALEX KREININ
  </p>
 </body>
</html>
