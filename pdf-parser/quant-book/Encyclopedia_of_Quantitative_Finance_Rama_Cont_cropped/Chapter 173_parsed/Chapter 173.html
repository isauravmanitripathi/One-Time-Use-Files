<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
 </head>
 <body>
  <h1>
   Portfolio Credit Risk:
   <b>
    Statistical Methods
   </b>
  </h1>
  <p block-type="Text">
   This article gives a brief overview over statistical methods for estimating the parameters of credit portfolio models from default data. The focus is on models for default probability and correlations; for recovery rates, (see
   <b>
    Recovery Rate
   </b>
   ). First, a rather general model setting is introduced along the lines of the models of McNeil and Wendin [10] and others, who depict portfolio models as generalized linear mixed models (GLMMs). Then, we describe the most common estimation techniques, which are the method of moments and maximum likelihood. An excellent reference for other estimation techniques is [10], in particular for Bayes estimation.
  </p>
  <h4>
   A Single Obligor's Default Risk
  </h4>
  <p block-type="Text">
   Let
   <math display="inline">
    D_{ti}
   </math>
   denote an indicator variable for obligor
   <i>
    i
   </i>
   's default in time period
   <math display="inline">
    t
   </math>
   such that
  </p>
  <p block-type="Equation">
   <math display="block">
    D_{ti} = \begin{cases} 1 &amp; \text{borrower } i \text{ defaults in } t \\ 0 &amp; \text{otherwise} \end{cases} \tag{1}
   </math>
  </p>
  <p block-type="TextInlineMath">
   <math display="inline">
    i \in \mathbb{N}_t, t = 1, \ldots, T
   </math>
   , where
   <math display="inline">
    \mathbb{N}_t
   </math>
   is the set of firms under consideration at the beginning of time period t and
   <math display="inline">
    n_t = |\mathbb{N}_t|
   </math>
   is their cardinal number. The default indicator variable can be motivated in terms of a threshold approach wherein default is said to occur when a continuous variable falls below a threshold. This approach is based on the asset value model due to Merton [11] where the firm declares bankruptcy when the value of its asset is below the principal value of its debt at maturity. Let
   <math display="inline">
    V_{ti}
   </math>
   denote the asset value return of firm
   <math display="inline">
    i
   </math>
   at time
   <math display="inline">
    t
   </math>
   <math display="inline">
    (i \in \mathbb{N}_t, t = 1, \ldots, T)
   </math>
   , or more generally a variable representing an obligor's credit quality. Then, the obligor defaults when
   <math display="inline">
    V_{ti}
   </math>
   falls below a threshold
   <math display="inline">
    c_{ti}
   </math>
   , that is,
   <math display="inline">
    D_{ti} = 1 \Leftrightarrow V_{ti} &lt; c_{ti}
   </math>
   . Crucial parts in credit risk management now are the modeling of
   <math display="inline">
    V_{ti}
   </math>
   , the parameterization of
   <math display="inline">
    c_{ti}
   </math>
   , and finally the estimation of parameter. In most industry credit risk models, such as credit metrics, credit risk plus, and credit portfolio view, the triggering variable
   <math display="inline">
    V_{ti}
   </math>
   is driven by two sources of random factors. The first is a systematic random factor
   <math display="inline">
    F_t
   </math>
   following a distribution
   <math display="inline">
    G
   </math>
   , which affects all firms jointly and therefore cannot
  </p>
  <p block-type="TextInlineMath">
   be diversified away. The second is an idiosyncratic part
   <math display="inline">
    \varepsilon_{ti}
   </math>
   with variance
   <math display="inline">
    \sigma^2
   </math>
   , which is specific for each firm, independent between the firms and from the systematic factor. The default threshold
   <math display="inline">
    c_{ti}
   </math>
   is mostly modeled via credit ratings that reflect an aggregated summary of a firm's risk characteristics. In a simple case, both variables may be expressed as linear functions of the respective risk drivers, such that
   <math display="inline">
    V_{ti} = -\omega F_t + \varepsilon_{ti}
   </math>
   and
   <math display="inline">
    c_{ti} = \alpha + \boldsymbol{\beta}' \mathbf{x}_{ti}
   </math>
   where
   <math display="inline">
    \alpha
   </math>
   ,
   <math display="inline">
    \boldsymbol{\beta}
   </math>
   , and
   <math display="inline">
    \omega
   </math>
   are unknown parameters, and
   <math display="inline">
    \mathbf{x}_{ti}
   </math>
   is a design vector consisting of observable covariates for obligor
   <math display="inline">
    i
   </math>
   , which may be time- and obligor-specific (such as balance sheet ratios) or only time-specific (such as macroeconomic variables). Then the firm defaults if
   <math display="inline">
    V_{ti} &lt; \alpha + \boldsymbol{\beta}' \mathbf{x}_{ti}
   </math>
   . As shown in [7], the aforementioned credit risk models mainly differ in the distributional assumptions regarding the common and the idiosyncratic random factors driving the firm value as discussed below.
  </p>
  <p block-type="Text">
   The probability of the firm's default conditional on the random factor
   <math display="inline">
    f_t
   </math>
   can be expressed as
  </p>
  <p block-type="Equation">
   <math display="block">
    \begin{aligned} \textit{CPD}_{ti}(f_t) &amp;= P(D_{ti} = 1 | \mathbf{x}_{ti}, f_t) \\ &amp;= P(V_{ti} &lt; \alpha + \boldsymbol{\beta}' \mathbf{x}_{ti} | \mathbf{x}_{ti}, f_t) \\ &amp;= P(\varepsilon_{ti} &lt; \alpha + \boldsymbol{\beta}' \mathbf{x}_{ti} + \omega f_t) \\ &amp;= f\left(\alpha + \boldsymbol{\beta}' \mathbf{x}_{ti} + \omega f_t\right) \end{aligned} \tag{2}
   </math>
  </p>
  <p block-type="TextInlineMath">
   which in statistical terms is a
   <math display="inline">
    GLMM
   </math>
   ; see [10] and the references cited therein.
   <math display="inline">
    f_t
   </math>
   is a realization of the systematic factor
   <math display="inline">
    F_t
   </math>
   , which is called the
   <i>
    time
   </i>
   specific random effect.
   <math display="inline">
    f(.): \mathbb{R} \rightarrow (0, 1)
   </math>
   denotes a response or link function given by the distribution of the idiosyncratic random error
   <math display="inline">
    \varepsilon_{ti}
   </math>
   . In the credit metrics model, the idiosyncratic errors are standard normally distributed (
   <math display="inline">
    \sigma^2 = 1
   </math>
   ), whereas in the credit portfolio view model the idiosyncratic error follows a logistic distribution (
   <math display="inline">
    \sigma^2 = \pi^2/3
   </math>
   ). This leads to the common link functions of the probit
   <math display="inline">
    f(y) = \Phi(y)
   </math>
   or the logit function
   <math display="inline">
    f(y) = 1/(1 + \exp(-y))
   </math>
   . In the credit risk plus approach, the systematic and the unsystematic factors are linked multiplicatively rather than linearly and their distributions are Gamma and Exponential, respectively. For details, we refer to [7].
  </p>
  <p block-type="Text" class="has-continuation">
   The (with respect to the random effect unconditional) probability of default (PD) is given by the
  </p>
  <p block-type="Text">
   expectation
  </p>
  <p block-type="Equation">
   <math display="block">
    PD_{ti} = P(D_{ti} = 1 | \mathbf{x}_{ti})
   </math>
   <br/>
   =
   <math>
    \int f(\alpha + \boldsymbol{\beta}' \mathbf{x}_{ti} + \omega f_t) \, \mathrm{d}G(f_t)
   </math>
   (3)
  </p>
  <p block-type="Text">
   which depends on the distribution of the random factor. For example, in the credit metrics model, the random effect is assumed to follow a standard normal distribution. Then, in the probit model, the simple expression for the unconditional PD
  </p>
  <p block-type="Equation">
   <math display="block">
    PD_{ti} = P(D_{ti} = 1 | \mathbf{x}_{ti}) = \Phi(\tilde{\alpha} + \tilde{\boldsymbol{\beta}}' \mathbf{x}_{ti}) = \Phi(\tilde{c}_{ti})
   </math>
   (4)
  </p>
  <p block-type="TextInlineMath">
   results, where
   <math display="inline">
    \tilde{c}_{ti} = \tilde{\alpha} + \tilde{\boldsymbol{\beta}}' \mathbf{x}_{ti}
   </math>
   ,
   <math display="inline">
    \tilde{\alpha} = \alpha / \sqrt{1 + \omega^2}
   </math>
   and
   <math display="inline">
    \tilde{\boldsymbol{\beta}} = \boldsymbol{\beta}/\sqrt{1+\omega^2}
   </math>
   . The correlation between the latent variables of obligor
   <math display="inline">
    i
   </math>
   and
   <math display="inline">
    j
   </math>
   ,
   <math display="inline">
    i \neq j
   </math>
   is given by
   <math display="inline">
    \n\rho_{ij} \equiv \rho = \frac{\omega^2}{1 + \omega^2}\n
   </math>
   , which is sometimes referred to as asset correlation since the latent variables are interpreted as asset value return. See [5] for a detailed description of correlations. For the aforementioned distributions in the credit portfolio view and the credit risk plus approach and the empirical estimation, compare [8].
  </p>
  <h2>
   Portfolio Default Risk
  </h2>
  <p block-type="TextInlineMath">
   The vector of default indicators of the portfolio is denoted by
   <math display="inline">
    \mathbf{D}_t = (D_{t1}, \ldots, D_{tn})
   </math>
   . Conditional on the systematic random factor and given the
   <math display="inline">
    \mathbf{x}_{ti}
   </math>
   , the defaults are independent. Then the joint distribution of defaults conditional on the systematic factor is given by
  </p>
  <p block-type="Equation">
   <math display="block">
    P(\mathbf{D}_{t} = \mathbf{d}_{t} | \mathbf{x}_{ti}, f_{t}) = \prod_{i \in \mathbb{N}_{t}} P(D_{ti} = 1 | \mathbf{x}_{ti}, f_{t})^{d_{ti}}
   </math>
   <math display="block">
    \times (1 - P(D_{ti} = 1 | \mathbf{x}_{ti}, f_{t}))^{1 - d_{ti}} \qquad (5)
   </math>
  </p>
  <p block-type="Text">
   which is also known as a
   <i>
    Bernoulli mixture model
   </i>
   [6]. The unconditional distribution (where unconditional refers w.r.t. the random effect) is obtained as
  </p>
  <p block-type="Equation">
   <math display="block">
    P(\mathbf{D}_t = \mathbf{d}_t | \mathbf{x}_{ti}) = \int P(\mathbf{D}_t = \mathbf{d}_t | \mathbf{x}_{ti}, f_t) \mathrm{d}G(f_t) \tag{6}
   </math>
  </p>
  <p block-type="Text">
   Extensions of model (5) include more than one random effect and are, therefore, called
   <i>
    multifactor
   </i>
   models.
  </p>
  <p block-type="TextInlineMath">
   A special case of this model results if the obligors are homogeneous in
   <math display="inline">
    \mathbf{x}_{ti}
   </math>
   , that is,
   <math display="inline">
    \mathbf{x}_{ti} = \mathbf{x}_t
   </math>
   and thus
   <math display="inline">
    c_{ti} = c_t
   </math>
   for all
   <i>
    i
   </i>
   . Then, all obligors exhibit the same conditional PD and the Bernoulli mixture distribution (5) drops to the binomial mixture distribution. Let
   <math display="inline">
    D_t = \sum_{i \in \mathbb{N}_t} D_{ti}
   </math>
   be the number of defaults. Then.
  </p>
  <p block-type="Equation">
   <math display="block">
    P(D_t = d_t | \mathbf{x}_t, f_t) = {n_t \choose d_t} P(D_{ti} = 1 | \mathbf{x}_t, f_t)^{d_t}
   </math>
   <math display="block">
    \times (1 - P(D_{ti} = 1 | \mathbf{x}_t, f_t))^{n_t - d_t} \tag{7}
   </math>
  </p>
  <p block-type="TextInlineMath">
   with the unconditional distribution analogous to equation (6). Define the default rate
   <math display="inline">
    p_t = d_t/n_t
   </math>
   as the ratio of defaulting obligors divided by the total number of obligors. As shown in [15, 16], the distribution of the default rate converges against the "Vasicek"distribution if the random effect is standard normally distributed and the number of obligors goes to infinity. The density is then given as
  </p>
  <p block-type="Equation">
   <math display="block">
    f(p_t) = \frac{\sqrt{1-\rho}}{\sqrt{\rho}} \cdot \exp\left(\frac{1}{2}(\Phi^{-1}(p_t))^2 - \frac{1}{2\rho^2}(c_t - \sqrt{1-\rho^2} \cdot \Phi^{-1}(p_t))^2\right) \tag{8}
   </math>
  </p>
  <p block-type="Text">
   For a thorough description of large pool approximations, see [9].
  </p>
  <h4>
   <b>
    Estimation Techniques
   </b>
  </h4>
  <p block-type="Text">
   There are basically two ways of estimating the unknown model parameters. As the first way, one can use asset values and asset value returns as in the KMV approach [1]. Given the level of liabilities, the default probabilities can be derived. Correlation estimates are obtained by calculating historical correlations from asset value returns. As the crucial part of these methods is deriving the asset values and the capital structure of the firm rather than the statistical procedures, they are not discussed here in detail. Instead, we refer to [3] and the references cited therein. As the second way, the parameters can be estimated using time series
   <math display="inline">
    \mathbf{d}_1, \ldots, \mathbf{d}_T
   </math>
   of observed default events. The simplest methods can
  </p>
  <p block-type="Text">
   be employed for the case of the homogeneous portfolio with time-constant parameters where closed-form solutions for the estimators exist. In the GLMM model, more advanced numerical techniques have to be used. Here, we briefly describe the method of moments and the maximum-likelihood method. For Bayes estimation, we refer to
   <math display="inline">
    [10]
   </math>
   and the references cited therein.
  </p>
  <h3>
   Method of Moments
  </h3>
  <p block-type="Text">
   If the obligors in the portfolio or the segment are homogeneous and the parameters are constant, only two parameters are to be estimated, namely, the PD and the correlation. Gordy [7] applies the method of moments estimator to the probit model. He shows that expectation and variance of the conditional default probability are
  </p>
  <p block-type="Equation">
   <math display="block">
    E\left(CPD(F_t)\right) = PD\tag{9}
   </math>
  </p>
  <p block-type="Text">
   and
  </p>
  <p block-type="Equation">
   Var
   <math display="block">
    (CPD(F_t))
   </math>
   <br/>
   =
   <math>
    \Phi_2 \left( \Phi^{-1}(PD), \Phi^{-1}(PD), \rho \right) - PD^2
   </math>
   (10)
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    \Phi_2(\cdot)
   </math>
   is the bivariate normal cumulative distribution function for two random variates, with expectation zero and variance one each and correlation
   <math display="inline">
    \rho
   </math>
   . An unbiased estimator for the unconditional PD is given by the average default rate:
  </p>
  <p block-type="Equation">
   <math display="block">
    \bar{p} = \frac{1}{T} \sum_{t=1}^{T} p_t \tag{11}
   </math>
  </p>
  <p block-type="Text">
   The left-hand side of equation (10) can be estimated by the sample variance of the default rate:
  </p>
  <p block-type="Equation">
   <math display="block">
    s_p^2 = \frac{1}{T-1} \sum_{t=1}^T (p_t - \bar{p})^2 \tag{12}
   </math>
  </p>
  <p block-type="Text">
   Given the two estimates, the asset correlation
   <math display="inline">
    \rho
   </math>
   can be backed out numerically from equation (10). Gordy [7] also provides a finite sample adjustment for the estimator. However, this modified estimator turns out to perform similar to the simple estimator [3].
  </p>
  <h4>
   Maximum-likelihood Method
  </h4>
  <p block-type="Text" class="has-continuation">
   In the limiting case
   <math display="inline">
    (8)
   </math>
   , asymptotic maximumlikelihood estimators of the (homogeneous) PD and
  </p>
  <p block-type="Text">
   the (homogeneous) asset correlation can be derived as
  </p>
  <p block-type="Equation">
   <math display="block">
    \widehat{o} = \frac{m_2/T - m_1^2/T^2}{1 + m_2/T - m_1^2/T^2} \tag{13}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \widehat{PD} = \Phi(T^{-1}\sqrt{1-\widehat{\rho}}m_1) \tag{14}
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    m_1 = \sum_{t=1}^{T} p_t
   </math>
   and
   <math display="inline">
    m_2 = \sum_{t=1}^{T} p_t^2
   </math>
   [4].&lt;br&gt;In the general case of the GLMM where obligors
  </p>
  <p block-type="Text">
   are heterogeneous, the log-likelihood is given via equation
   <math display="inline">
    (6)
   </math>
   as
  </p>
  <p block-type="Equation">
   <math display="block">
    l = \sum_{t=1}^{T} \ln \int \prod_{i \in \mathbb{N}_{t}} P(D_{ti} = 1 | \mathbf{x}_{ti}, f_{t})^{d_{ti}}
   </math>
   <math display="block">
    (1 - P(D_{ti} = 1 | \mathbf{x}_{ti}, f_{t}))^{1 - d_{ti}} \, \mathrm{d}G(f_{t}) \tag{15}
   </math>
  </p>
  <p block-type="Text">
   As the log-likelihood function includes solving several integrals, it is numerically optimized w.r.t. the unknown parameters for which several algorithms, such as the Newton-Raphson method, exist and are implemented in many statistical software packages. The integral approximation can be conducted by, for example, the adaptive Gaussian quadrature as described in [12]. Under usual regulatory conditions, the resulting estimators asymptotically exist, are consistent, and converge against normality. See [2], p.243, for a detailed discussion. Applications and estimation results can, for instance, be found in [6, 8, 13, 14]. For the extension of higher dimensional random effects, there are also some approximation methods that can be used, particularly penalized quasi-likelihood (PQL) and marginal quasi-likelihood (MQL) [10].
  </p>
  <h4>
   Bayes Estimation
  </h4>
  <p block-type="Text">
   Finally, Bayes estimation can be used for estimation as thoroughly shown in [10]. The joint prior distribution of
   <math display="inline">
    F_t
   </math>
   ,
   <math display="inline">
    \beta
   </math>
   (including a constant) and some hyperparameters
   <math display="inline">
    \theta
   </math>
   can be given as
  </p>
  <p block-type="Equation">
   <math display="block">
    p(\boldsymbol{\beta}, F_t, \theta) = p(F_t|\theta) \cdot p(\theta) \cdot p(\boldsymbol{\beta}) \qquad (16)
   </math>
  </p>
  <p block-type="Text">
   where
   <i>
    a priori
   </i>
   independence between
   <math display="inline">
    \beta
   </math>
   and
   <math display="inline">
    \theta
   </math>
   is assumed. Mostly, Markov chain Monte Carlo methods are applied, which can deal with even more complex models than shown here, such as autocorrelated random effects or multifactor models. For a detailed description, we refer to [10].
  </p>
  <h1>
   <b>
    References
   </b>
  </h1>
  <p block-type="ListGroup" class="has-continuation">
   <ul>
    <li block-type="ListItem">
     [1] Bohn, J. &amp; Crosbie, P. (2003).
     <i>
      Modeling Default Risk
     </i>
     ,
     <i>
      KMV Corporation
     </i>
     .
    </li>
    <li block-type="ListItem">
     [2] Davidson, R. &amp; MacKinnon, J.G. (1993).
     <i>
      Estimation and Inference in Econometrics
     </i>
     , Oxford University Press, New York.
    </li>
    <li block-type="ListItem">
     [3] Duellmann, K., Kll, J. &amp; Kunisch, M. (2008).
     <i>
      Estimating Asset Correlations from Stock Prices or Default Rates which Method is Superior?
     </i>
     Deutsche Bundesbank Discussion Paper, Series 2: Banking and Finance, Deutsche Bundesbank, Vol 04.
    </li>
    <li block-type="ListItem">
     [4] Duellmann, K. &amp; Trapp, M. (2005). Systematic risk in recovery rates- an empirical analysis of U.S. corporate credit exposures, in
     <i>
      Recovery Risk: The Next Challenge in Credit Risk Management
     </i>
     , E.I. Altman, A. Resti &amp; A. Sironi, eds. Deutsche Bundesbank.
    </li>
    <li block-type="ListItem">
     [5] Frey, R. (2009). Default correlation and asset correlation,
     <i>
      Encyclopedia of Quantitative Finance
     </i>
     <b>
      10
     </b>
     , 038.
    </li>
    <li block-type="ListItem">
     [6] Frey, R. &amp; McNeil, A. (2003). Dependent defaults in models of portfolio credit risk,
     <i>
      Journal of Risk
     </i>
     <b>
      6
     </b>
     , 59–92.
    </li>
    <li block-type="ListItem">
     [7] Gordy, M.B. (2000). A comparative anatomy of credit risk models,
     <i>
      Journal of Banking and Finance
     </i>
     <b>
      24
     </b>
     , 119–149.
    </li>
   </ul>
  </p>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     [8] Hamerle, A. &amp; Roesch, D. (2006). Parameterizing credit risk models,
     <i>
      Journal of Credit Risk
     </i>
     <b>
      3
     </b>
     , 101–122.
    </li>
    <li block-type="ListItem">
     [9] Kreinin, A. (2009). Large pool approximations for credit loss,
     <i>
      Encyclopedia of Quantitative Finance
     </i>
     <b>
      09
     </b>
     , 017.
    </li>
    <li block-type="ListItem">
     [10] McNeil, A.J. &amp; Wendin, J.P. (2007). Bayesian inference for generalized linear mixed models of portfolio credit risk,
     <i>
      Journal of Empirical Finance
     </i>
     <b>
      14
     </b>
     , 131–149.
    </li>
    <li block-type="ListItem">
     [11] Merton, R.C. (1974). On the pricing of corporate debt: the risk structure of interest rates,
     <i>
      Journal of Finance
     </i>
     <b>
      29
     </b>
     , 449–470.
    </li>
    <li block-type="ListItem">
     [12] Pinheiro, J.C. &amp; Bates, D.M. (1995). Approximations to the log-likelihood function in the nonlinear mixedeffects model,
     <i>
      Journal of Computational and Graphical Statistics
     </i>
     <b>
      4
     </b>
     , 12–35.
    </li>
    <li block-type="ListItem">
     [13] Roesch, D. (2005). An empirical comparison of default risk forecasts from alternative credit rating philosophies,
     <i>
      International Journal of Forecasting
     </i>
     <b>
      25
     </b>
     , 37–51.
    </li>
    <li block-type="ListItem">
     [14] Roesch, D. &amp; Scheule, H. (2005). A multi-factor approach for systematic default and recovery risk,
     <i>
      Journal of Fixed Income
     </i>
     <b>
      15
     </b>
     , 63–75.
    </li>
    <li block-type="ListItem">
     [15] Vasicek, O.A. (1987).
     <i>
      Probability of Loss on Loan Portfolio
     </i>
     . Working paper, KMV Corporation.
    </li>
    <li block-type="ListItem">
     [16] Vasicek, O.A. (1991).
     <i>
      Limiting Loan Loss Distribution
     </i>
     . Working paper, KMV Corporation.
    </li>
   </ul>
  </p>
  <p block-type="Text">
   DANIEL ROSCH ¨
  </p>
 </body>
</html>
