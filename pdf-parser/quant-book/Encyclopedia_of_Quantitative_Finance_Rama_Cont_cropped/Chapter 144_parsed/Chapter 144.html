<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
 </head>
 <body>
  <h1>
   Implied Volatility: Volvol Expansion
  </h1>
  <p block-type="Text">
   In order to calibrate stochastic volatility models, it is convenient to have an accurate analytical formula or approximation for call options. However, deriving such a formula is not always an easy task. In the Heston model, the most popular technique involves numerical integration, which is necessarily time consuming. The main idea is to apply a perturbation method to the volvol parameter, calculating the first and second order of the difference between a stochastic volatility model and a Black-Scholes model. In general case, we can reduce the integration of the exact formula to some simpler integration.
  </p>
  <p block-type="Text">
   Consider the following two-factor stochastic volatility model:
  </p>
  <p block-type="Equation">
   <math display="block">
    dS = (r - d)Sdt + \sigma SdB_t \tag{1}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    dV = b(V)dt + \epsilon \nu(V)dW \qquad (2)
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{d}B\mathrm{d}W = \rho(V)\mathrm{d}t\tag{3}
   </math>
  </p>
  <p block-type="Text">
   where r is the short rate, d is the dividend yield,
   <math display="inline">
    \epsilon
   </math>
   is a constant, and
   <math display="inline">
    b(V)
   </math>
   and
   <math display="inline">
    v(V)
   </math>
   are independent of
   <math display="inline">
    \epsilon
   </math>
   . We assume parameters r and d to be constant for the sake of simplicity. The series expansion consists in writing the option price formula as a series in
   <math display="inline">
    \epsilon
   </math>
   .
  </p>
  <p block-type="Text">
   Fourier methods (see Fourier Methods in Options Pricing) tell us that the call option price is given by
  </p>
  <p block-type="Equation">
   <math display="block">
    C(S, V, T) = Se^{-dT} - \frac{Ke^{-rT}}{2\pi} \int_{i/2-\infty}^{i/2+\infty} \exp(-\mathrm{i}uX) \frac{\Phi(u, V, T)}{u(u-i)} \mathrm{d}u \qquad (4)
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    X = \ln(S/K) + (r - d)T
   </math>
   .
  </p>
  <p block-type="Equation">
   <math display="block">
    \frac{\partial f}{\partial \tau} = \frac{1}{2} \epsilon^2 \nu^2(V) \frac{\partial^2 f}{\partial V^2} + \left[ b(V) - \mathrm{i} u \epsilon \rho(V) \nu(V) \sqrt{V} \right]
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \times \frac{\partial f}{\partial V} - \frac{u(u-i)}{2} Vf \tag{5}
   </math>
  </p>
  <p block-type="Text">
   We look for solutions which can be written as a power series of
   <math display="inline">
    \epsilon
   </math>
   .
  </p>
  <p block-type="Equation">
   <math display="block">
    f(u, V, T) = f^{(0)}(u, V, T) + \epsilon f^{(1)}(u, V, T)
   </math>
   <math display="block">
    + \epsilon^2 f^{(2)}(u, V, T) \tag{6}
   </math>
  </p>
  <p block-type="Text">
   Thus, we can obtain the power series of the call price using either equation
   <math display="inline">
    (4)
   </math>
   directly
  </p>
  <p block-type="Equation">
   <math display="block">
    C(u, V, T) = C^{(0)}(u, V, T) + \epsilon C^{(1)}(u, V, T)
   </math>
   <math display="block">
    + \epsilon^{2} C^{(2)}(u, V, T) \tag{7}
   </math>
  </p>
  <p block-type="Text">
   or expanding first the implied volatility
  </p>
  <p block-type="Equation">
   <math display="block">
    V_{\text{imp}}(u, V, T) = V_{\text{imp}}^{(0)}(u, V, T) + \epsilon V_{\text{imp}}^{(1)}(u, V, T)
   </math>
   <math display="block">
    + \epsilon^2 V_{\text{imp}}^{(2)}(u, V, T) \tag{8}
   </math>
  </p>
  <p block-type="Text">
   and then plugging it into the option price with Black-Scholes formula.
  </p>
  <p block-type="Text">
   As a matter of fact, these two methods differ significantly. The former—denoted by series A in the remainder of this article-gives the call price first and implied volatility while the latter—denoted by series
   <math display="inline">
    B
   </math>
   —gives the implied volatility and call price is obtained afterward. Nevertheless, in most cases, there is a slight numerical difference between the two series. However, regarding far out-of-the money options, the two series give different results as shown in Figure 1. Empirical evidence shows that series
   <math display="inline">
    B
   </math>
   is very often better than series A. Even though this is not a general rule, series B should be usually preferred over series A.
  </p>
  <p block-type="Text">
   We now explicitly compute the two series for the following model. In particular, this model encompasses the Heston model for the special case
   <math display="inline">
    \phi = 0.5.
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    dS = (r - d)Sdt + \sigma SdB_t \tag{9}
   </math>
  </p>
  <p>
   <img src="_page_1_Figure_1.jpeg"/>
  </p>
  <p>
   <b>
    Figure 1
   </b>
   Series A (expansion on price), series B (expansion on implied volatility), and exact volatility
  </p>
  <p block-type="Equation">
   <math display="block">
    dV = (\omega - \theta V)dt + \epsilon V^{\phi}dW \qquad (10)
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{d}B\mathrm{d}W = \rho(V)\mathrm{d}t\tag{11}
   </math>
  </p>
  <p block-type="TextInlineMath">
   First, the expansion is on the fundamental transform of the closed formula, which is presented by
   <i>
    (u, V , T )
   </i>
   in equation (4). The idea is that we can expand this function into a simpler form, so that the integration in the equation (4) can be reduced to analytic form. Here, we do not discuss the detailed derivation but only give the result. Interested readers can refer to [2]. For series A, the expansion on price is
  </p>
  <p block-type="Equation">
   <math display="block">
    \begin{split} C(S,V,\tau) &amp;= c(S,v,\tau) + \epsilon \tau^{-1} J^{(1)} \tilde{R}^{(1,1)} c_V(S,v,\tau) \\ &amp;+ \epsilon^2 \left\{ \tau^{-1} J^2 + \tau^{-2} J^{(3)} \tilde{R}^{(2,0)} \right. \\ &amp;\left. + \tau^{-1} J^{(4)} \tilde{R}^{(1,2)} + \frac{\tau^{-2}}{2} (J^1)^2 \tilde{R}^{(2,2)} \right\} \\ &amp;\times c_V(S,v,\tau) + O(\epsilon^3) \end{split} \tag{12}
   </math>
  </p>
  <p block-type="Text">
   For series B, the expansion on price is
  </p>
  <p block-type="Equation">
   <math display="block">
    V^{\text{imp}} = v(S, v, \tau) + \epsilon \tau^{-1} J^{(1)} \tilde{R}^{(1,1)}
   </math>
   <math display="block">
    + \epsilon^{2} \left\{ \tau^{-1} J^{2} + \tau^{-2} J^{(3)} \tilde{R}^{(2,0)}
   </math>
   <math display="block">
    + \tau^{-1} J^{(4)} \tilde{R}^{(1,2)} + \frac{\tau^{-2}}{2} (J^{(1)})^{2}
   </math>
   <math display="block">
    \times \left[ \tilde{R}^{(2,2)} - \left( \tilde{R}^{(1,1)} \right)^{2} \tilde{R}^{(2,0)} \right] \right\}
   </math>
   <math display="block">
    + O(\epsilon^{3}) \tag{13}
   </math>
  </p>
  <p block-type="Text">
   In the above formulae, term
   <i>
    c(S, v, τ )
   </i>
   presents the corresponding Black–Scholes price. When volvol
   <i>
    -
   </i>
   = 0, the stochastic model reduces to a Black–Scholes model.
   <i>
    v
   </i>
   here is the equivalent variance for Black–Scholes, which is basically the integration of the variance from 0 to
   <i>
    τ
   </i>
   .
  </p>
  <p block-type="Text">
   The functions
   <math display="inline">
    \tilde{R}^{(p,q)}
   </math>
   and
   <math display="inline">
    J^{(s)}
   </math>
   are the derivative ratios and integration, respectively. Here, for academic and practitioners' interest their expressions are listed.
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{d}v_t = \kappa (\theta_t - v_t) \mathrm{d}t + \xi_t \sqrt{v_t} \mathrm{d}B_t, \ v_0 \ (20)
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbf{d}\langle W,\,B\rangle_t = \rho_t \mathbf{d}t\tag{21}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \tilde{R}^{(2,0)} = \tau \left[ \frac{1}{2} \frac{X^2}{Y^2} - \frac{1}{2Z} - \frac{1}{8} \right], \quad \tilde{R}^{(1,1)} = \left[ -\frac{X}{Z} + \frac{1}{2} \right]\n
   </math>
   <math display="block">
    \n\tilde{R}^{(1,2)} = \left[ \frac{X^2}{Z^2} - \frac{X}{Z} - \frac{1}{4Z} (4 - Z) \right], \quad \tilde{R}^{(2,2)} = \tau \left[ \frac{1}{2\frac{X^4}{Z^4}} - \frac{1}{2} \frac{X^3}{Z^3} - 3\frac{X^2}{Z^3} + \frac{1}{8} \frac{X}{Z^2} (12 + Z) + \frac{1}{32} \frac{1}{Z^2} (48 - Z^2) \right]\n
   </math>
   (14)
  </p>
  <p block-type="TextInlineMath">
   with
   <math display="inline">
    Z = V\tau
   </math>
   and
  </p>
  <p block-type="Text">
   Here, we have adjusted to risk neutral probability; as a consequence, it introduces the drift term in spot process by the change of probability.
  </p>
  <p block-type="Equation">
   <math display="block">
    J^{(1)}(V,\tau) = \frac{\rho}{\theta} \int_0^{\tau} \left(1 - e^{-\theta(\tau-s)}\right) \left[\frac{\omega}{\theta} + e^{-\theta s} \left(V - \frac{\omega}{\theta}\right)\right]^{\phi + \frac{1}{2}} \mathrm{d}s, \quad J^{(2)}(V,\tau) = 0 \tag{15}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    J^{(3)}(V,\tau) = \frac{1}{2\theta^2} \int_0^\tau \left(1 - e^{-\theta(\tau - s)}\right)^2 \left[\frac{\omega}{\theta} + e^{-\theta s} \left(V - \frac{\omega}{\theta}\right)\right]^{2\phi} \mathrm{d}s \tag{16}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    J^{(4)}(V,\tau) = \left(\phi + \frac{1}{2}\right) \int_0^\tau \left[\frac{\omega}{\theta} + e^{-\theta(\tau-s)} \left(V - \frac{\omega}{\theta}\right)\right]^{\phi + \frac{1}{2}} J^{(6)}(V,\tau) \mathrm{d}s \tag{17}
   </math>
  </p>
  <p block-type="Equation">
   with
   <math display="block">
    J^{(6)}(V,\tau)ds = \int_0^\tau \left(e^{-\theta(\tau-s)} - e^{-\theta s}\right) \left[\frac{\omega}{\theta} + e^{-\theta(\tau-u)}\left(V - \frac{\omega}{\theta}\right)\right]^{\phi-\frac{1}{2}} du
   </math>
   (18)
  </p>
  <h1>
   <b>
    Example of Volvol Expansion: Heston
   </b>
   Model
  </h1>
  <p block-type="Text">
   We will now show the expansion of volvol for the Heston model (see Heston Model). By the asymptotic expansion, we can finally obtain an approximate analytic formula for the European call option. This work comes from the result of Benhamou et al. [1]. Consider a Heston model
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{d}X_t = \sqrt{v_t} \mathrm{d}W_t - \frac{v_t}{2} \mathrm{d}t, \ \ X_0 = x_0 \tag{19}
   </math>
  </p>
  <p block-type="Text">
   To expand the model, we add
   <math display="inline">
    \epsilon
   </math>
   in the model.
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{d}X_{t}^{\epsilon} = \sqrt{v_{t}^{\epsilon}} \mathrm{d}W_{t} - \frac{v_{t}^{\epsilon}}{2} \mathrm{d}t, \quad X_{0}^{\epsilon} = x_{0} \tag{22}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{d}v_t^{\epsilon} = \kappa (\theta_t - v_t^{\epsilon}) \mathrm{d}t + \epsilon \xi_t \sqrt{v_t^{\epsilon} \mathrm{d}B_t}, \quad v_0^{\epsilon} = v_0 \tag{23}
   </math>
  </p>
  <p block-type="Text" class="has-continuation">
   Now, we will expand the European call option price formula with respect to
   <math display="inline">
    \epsilon
   </math>
   . Note that, when
   <math display="inline">
    \epsilon = 0
   </math>
   , we have a Black–Scholes model; while
   <math display="inline">
    \epsilon = 1
   </math>
   , we have a Heston model. We already have the closed
  </p>
  <p block-type="Text">
   formula of Black-Scholes for
   <math display="inline">
    \epsilon = 0
   </math>
   . We expand at
   <math display="inline">
    \epsilon = 0
   </math>
   , and let
   <math display="inline">
    \epsilon = 1
   </math>
   to obtain the approximate formula. In mathematical language, this can be written as follows:
  </p>
  <p block-type="Equation">
   <math display="block">
    P_{\text{Heston}} = P_{\text{BS}} + \mathbb{E}\left[\frac{\partial P_{\text{BS}}}{\partial \epsilon}\right] + \frac{1}{2}\mathbb{E}\left[\frac{\partial^2 P_{\text{BS}}}{\partial \epsilon^2}\right] + \mathcal{E}
   </math>
   (24)
  </p>
  <p block-type="TextInlineMath">
   Here, we will take another approximation to simulate the partial derivatives in the above equation by the linear combination of the Greek letters of Black-Scholes. Here, the idea is that use of the chain rule in the derivative can result in
   <math display="inline">
    \frac{\partial P_{\text{BS}}}{\partial \epsilon}
   </math>
   =
   <math display="inline">
    \frac{\partial P_{\text{BS}}}{\partial S}\frac{\partial S}{\partial \epsilon} + \frac{\partial P_{\text{BS}}}{\partial \sigma}\frac{\partial \sigma}{\partial \epsilon}
   </math>
   . The same idea holds for the second derivative.
  </p>
  <p block-type="Equation">
   <math display="block">
    P_{\text{Heston}} = P_{\text{BS}}(x_0, \text{var}_T) + \sum_{i=1}^{2} a_{i,T} \frac{\partial^{i+1} P_{\text{BS}}}{\partial x^i y}(x_0, \text{var}_T)
   </math>
   <math display="block">
    + \sum_{i=0}^{1} b_{2i,T} \frac{\partial^{2i+2} P_{\text{BS}}}{\partial x^{2i} y^2}(x_0, \text{var}_T) + \mathcal{E} \qquad (25)
   </math>
  </p>
  <p block-type="Text">
   We refer to [1] for proofs and intermediate derivation. The parameters in the formula are as follows:
  </p>
  <p block-type="Equation">
   <math display="block">
    \begin{aligned} \text{var}_T &amp;= m_0 v_0 + m_1 \theta, \quad a_{1,T} = \rho \xi (p_0 v_0 + p_1 \theta) \\ a_{2,T} &amp;= (\rho \xi)^2 (q_0 v_0 + q_1 \theta), \quad b_{0,T} = \xi^2 (r_0 v_0 + r_1 \theta) \end{aligned}
   </math>
  </p>
  <p block-type="Text">
   <math display="inline">
    (26)
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \text{var}_T = \int_0^T v_{0,t} \text{d}t \tag{27}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    m_0 = \frac{e^{-\kappa T} \left(-1 + e^{\kappa T}\right)}{\kappa},
   </math>
   <br/>
   <math display="block">
    m_1 = T - \frac{e^{-\kappa T} \left(-1 + e^{\kappa T}\right)}{\kappa},
   </math>
   <br/>
   <math display="block">
    p_0 = \frac{e^{-\kappa T} \left(-\kappa T + e^{\kappa T} - 1\right)}{\kappa^2},
   </math>
   <br/>
   <math display="block">
    p_1 = \frac{e^{-\kappa T} \left(\kappa T + e^{\kappa T} (\kappa T - 2) + 2\right)}{\kappa^2},
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    q_{0} = \frac{e^{-\kappa T} \left(-\kappa T (\kappa T + 2) + 2e^{\kappa T} - 2\right)}{2\kappa^{3}},
   </math>
   <math display="block">
    q_{1} = \frac{e^{-\kappa T} \left(2e^{\kappa T} (\kappa T - 3) + \kappa T (\kappa T + 4) + 6\right)}{2\kappa^{3}},
   </math>
   <math display="block">
    r_{0} = \frac{e^{-2\kappa T} \left(-4e^{\kappa T} \kappa T + 2e^{2\kappa T} - 2\right)}{4\kappa^{3}},
   </math>
   <math display="block">
    r_{1} = \frac{e^{-2\kappa T} \left(4e^{\kappa T} (\kappa T + 1) + e^{2\kappa T} (2\kappa T - 5) + 1\right)}{4\kappa^{3}}
   </math>
   <math display="block">
    (28)
   </math>
  </p>
  <p block-type="Text">
   The advantage is that there is no integration in the approximate formula. So the calculations are done much faster than in the exact formula. We will discuss this point in the section Numerical Results.
  </p>
  <p block-type="TextInlineMath">
   The error in the approximation is estimated as
   <math display="inline">
    \mathcal{E} = O\left([\xi_{\text{Sup}}\sqrt{T}]^3\sqrt{T}\right).
   </math>
  </p>
  <h3>
   <b>
    Numerical Results
   </b>
  </h3>
  <p block-type="TextInlineMath">
   We test the approximate formula with the following strikes. We take strikes from 70% to 130% for short maturity and 10% to 730% for long maturity. Implied Black-Scholes volatilities of the closed formula, of the approximation formula, and related errors (in bp), are expressed as a function of maturities in fractions of years and relative strikes. The values of the parameters are as follows:
   <math display="inline">
    \theta = 6\%
   </math>
   ,
   <math display="inline">
    \kappa = 3, \xi = 30\%
   </math>
   , and
   <math display="inline">
    \rho = 0\%
   </math>
   . Except for short maturity plus very small strikes, where we observe the largest difference
   <math display="inline">
    (18.01 \text{ bp})
   </math>
   ; the difference is less than 5 bp (1 bp =
   <math display="inline">
    0.01\%
   </math>
   ) in almost all other cases. With regard to the speed of calculation, the approximate formula is about 100 times quicker than the exact formula (with the optimization in integral).
  </p>
  <h4>
   References
  </h4>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     [1] Benhamou, E., Gobet, E. &amp; Miri, M. (2009). Time dependent Heston model, SIAM Journal on Financial Mathematics.
    </li>
    <li block-type="ListItem">
     [2] Lewis, A.L. (2000). Option Valuation Under Stochastic Volatility: With Mathematica Code. February 2000.
    </li>
   </ul>
  </p>
  <h2>
   <b>
    Related Articles
   </b>
  </h2>
  <p block-type="Text" class="has-continuation">
   <b>
    Heavy Tails
   </b>
   ;
   <b>
    Heston Model
   </b>
   ;
   <b>
    Hull–White Stochastic Volatility Model
   </b>
   ;
   <b>
    Implied Volatility in Stochastic Volatility Models
   </b>
   ;
   <b>
    Implied Volatility Surface
   </b>
   ;
  </p>
  <p block-type="Text">
   <b>
    Model Calibration
   </b>
   ;
   <b>
    Partial Differential Equations
   </b>
   ;
   <b>
    SABR Model
   </b>
   ;
   <b>
    Stochastic Volatility Models
   </b>
   ;
   <b>
    Stylized Properties of Asset Returns
   </b>
   .
  </p>
  <p block-type="Text">
   ZAIZHI WANG &amp; MOHAMMED MIRI
  </p>
 </body>
</html>
