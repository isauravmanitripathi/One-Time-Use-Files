<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
 </head>
 <body>
  <h1>
   <b>
    Heston Model
   </b>
  </h1>
  <p block-type="Text">
   In the class of stochastic volatility models (
   <i>
    see
   </i>
   <b>
    Stochastic Volatility Models
   </b>
   ), Heston's is probably the most well-known model. The model was published in 1993 by S. Heston in his seminal article the title of which readily reveals much of its popularity,
   <i>
    A Closed-Form Solution for Options with Stochastic Volatility with Applications to Bond and Currency Options
   </i>
   . It is probably the only stochastic volatility model for equities which both allows very efficient computing of European option prices and fits reasonably well to market data in very different conditions.
  </p>
  <p block-type="Text">
   In fact, the model was used successfully (in the sense explained below) during the boom of the end of the 1990s, in the brief recession 2001, in the very low volatility regime until 2007, and it still performed well during the very volatile period of late-2008.
  </p>
  <p block-type="Text">
   However, the model also has several questionable properties: critics point out that its inherent structure as a square-root diffusion does not reflect statistical properties seen in real market data. For example, typical calibrated parameters allow the instantaneous volatility of the stock to become zero with a positive probability. From a practical point of view, the most challenging property of Heston's model is the interdependence of its parameters and the resulting inability to give these parameters a real idiosyncratic meaning. One example is the fact that moving the term structure of volatility has an impact on the shape of the implied volatility skew. This means that traders who use this model will have to have a very a good understanding of the dynamics of the model and the interplay between its parameters.
  </p>
  <p block-type="Text">
   Other stochastic volatility models with efficient pricing methods for European options are: SABR, Schobel–Zhou or Hull–White model (
   <i>
    see
   </i>
   <b>
    Hull–White Stochastic Volatility Model
   </b>
   ) and Lewis' "3/2-model" presented in Lewis' book [13]. The
   <i>
    n
   </i>
   -dimensional extension of Heston's model is the class of affine models [9]. Related are Levy' based models that can also be computed efficiently (
   <i>
    see
   </i>
   <b>
    Time-changed Levy Process ´
   </b>
   ). The most natural model that is used frequently but which actually does not allow efficient pricing of Europeans is a lognormal model for instantaneous volatility.
  </p>
  <h1>
   <b>
    Model Description
   </b>
  </h1>
  <p block-type="TextInlineMath">
   If we assume a prevailing instantaneous interest rate of
   <i>
    r
   </i>
   =
   <i>
    (rt)t
   </i>
   <sup>
    ≥
   </sup>
   <sup>
    0
   </sup>
   and a yield from holding a stock of
   <i>
    µ
   </i>
   =
   <i>
    (µt)t
   </i>
   ≥0, then Heston's model is given as the unique strong solution
   <i>
    Z
   </i>
   =
   <i>
    (St, vt)t
   </i>
   <sup>
    ≥
   </sup>
   <sup>
    0
   </sup>
   of the following stochastic differential equation (SDE):
  </p>
  <p block-type="Equation">
   <math display="block">
    \begin{aligned} \mathrm{d}v_t &amp;= \kappa (\theta - v_t) \, \mathrm{d}t + \sigma \sqrt{v_t} \, \mathrm{d}W_t \\ \mathrm{d}S_t &amp;= S_t \left( r_t - \mu_t \right) \, \mathrm{d}t + S_t \sqrt{v_t} \, \mathrm{d}B_t \end{aligned} \tag{1}
   </math>
  </p>
  <p block-type="TextInlineMath">
   with starting values spot
   <i>
    S
   </i>
   <sup>
    0
   </sup>
   <i>
    &gt;
   </i>
   0 and "Short Vol"
   <sup>
    √
   </sup>
   <i>
    v
   </i>
   <sup>
    0
   </sup>
   <i>
    <sup>
     &amp;
    </sup>
    gt;
   </i>
   0. In this equation,
   <i>
    <sup>
     W
    </sup>
   </i>
   and
   <i>
    <sup>
     B
    </sup>
   </i>
   are two standard Brownian motions with a Correlation of
   <i>
    ρ
   </i>
   ∈
   <i>
    (
   </i>
   −1
   <i>
    ,
   </i>
   +1
   <i>
    )
   </i>
   . The model is usually specified directly under a risk-neutral measure.
  </p>
  <p block-type="Text">
   This Correlation together with the "Vol Of Vol"
   <i>
    σ
   </i>
   ≥ 0 can be thought of being responsible for the skew. This is illustrated in Figure 1: Vol Of Vol controls the volume of the smile and Correlation and its "tilt". A negative Correlation produces the desired downward skew of implied volatility. It is usually calibrated to a value around −70%.
  </p>
  <p block-type="TextInlineMath">
   The other parameters control the term structure of the model: in Figure 2, the impact of changing "Short Vol"
   <sup>
    √
   </sup>
   <i>
    v
   </i>
   <sup>
    0
   </sup>
   <sup>
    ≥
   </sup>
   0, "Long Vol"
   <sup>
    √
   </sup>
   <i>
    <sup>
     θ
    </sup>
   </i>
   <sup>
    ≥
   </sup>
   0, and "Reversion Speed"
   <i>
    κ &gt;
   </i>
   0 on the term structure of at-the-money (ATM) implied volatility is illustrated. It can be seen that Short Vol lives up to its name and controls the level of the short-date implied volatilities, whereas Long Vol controls the long end. Reversion Speed controls the skewness or "decay" of the curve from the Short Vol level to the Long Vol level.
  </p>
  <p block-type="TextInlineMath">
   This inherent mean-reversion property of Heston's stochastic volatility around a long-term mean
   <sup>
    √
   </sup>
   <i>
    <sup>
     θ
    </sup>
   </i>
   is one of the important properties of the model. Real market data are often mean-reverting, and it also makes economic sense to assume that volatility is not unbounded in its growth as, for example, a stock price process is. In historic data, the "natural" level of mean-reversion is often seen to be itself a mean-reverting process as Fouque
   <i>
    et al.
   </i>
   [10] have shown. Some extensions of Heston in this direction are discussed below.
  </p>
  <h2>
   <i>
    Parameter Interdependence
   </i>
  </h2>
  <p block-type="Text">
   Before we proceed, a note of caution: the above distinction of the parameters by their effect on
  </p>
  <p>
   <img src="_page_1_Figure_1.jpeg"/>
  </p>
  <p>
   <b>
    Figure 1
   </b>
   Stylized effects of changing Vol Of Vol and Correlation in Heston's model on the one-year implied volatility. The Heston parameters are
   <i>
    v
   </i>
   <sup>
    0
   </sup>
   = 15%2,
   <i>
    θ
   </i>
   = 20%2,
   <i>
    κ
   </i>
   = 1,
   <i>
    ρ
   </i>
   = −70%, and
   <i>
    σ
   </i>
   = 35%
  </p>
  <p>
   <img src="_page_1_Figure_3.jpeg"/>
  </p>
  <p>
   <b>
    Figure 2
   </b>
   The effects of changing Short Vol (a), Long Vol (b), and Reversion Speed (c) on the ATM term structure of implied volatilities. Each graph shows the volatility term structure for 12 years. The reference Heston parameters are
   <i>
    v
   </i>
   <sup>
    0
   </sup>
   = 15%2,
   <i>
    θ
   </i>
   = 20%2,
   <i>
    κ
   </i>
   = 1,
   <i>
    ρ
   </i>
   = 70%, and
   <i>
    σ
   </i>
   = 35%
  </p>
  <p block-type="Text">
   term structure and strike structure, was made for illustration purposes only: in particular,
   <i>
    κ
   </i>
   and
   <i>
    σ
   </i>
   are strongly interdependent if the model is used in the form (1).
  </p>
  <p block-type="Text" class="has-continuation">
   This is one of the most serious drawbacks of Heston's model since it means that a trader who uses it to risk-manage a position cannot independently
  </p>
  <p block-type="Text" class="has-continuation">
   control the risk with the five available parameters, but has to understand very well their interdependency. For example, to hedge, say, convexity risk in strike direction of the implied volatility surface, the trader will also have to deal with the skew risk at the same time since in Heston, there is no one parameter to control either: convexity is mainly controlled
  </p>
  <p block-type="Text">
   by Vol Of Vol, but the effect of Correlation on skew depends on the level of Vol Of Vol, too. Moreover, changes to the short end volatility skew will always affect the long-term skew. A similar strong codependency exists between Vol of Vol and Reversion Speed; as pointed out in [14], some of the strong interdependence between Vol Of Vol and Reversion Speed can be alleviated by using the alternative formulation
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{d}v_t = (\theta - v_t)\kappa \,\mathrm{d}t + \tilde{\sigma}\sqrt{v_t}\sqrt{\kappa} \,\mathrm{d}W_t \qquad (2)
   </math>
  </p>
  <p block-type="Text">
   In this parametrization, the new Vol Of Vol and reversion speed are much less interdependent, which stabilizes results of daily calibration to market data substantially. Mathematically, this parametrization much more naturally defines
   <math display="inline">
    \kappa
   </math>
   as the "speed" of the equation.
  </p>
  <p block-type="Text">
   Such complications are a general issue with stochastic volatility models: since such models attempt to describe an unobservable, rather theoretical quantity (instantaneous variance), they do not produce very intuitive behavior when looked at through the lens of the observable measure of "implied volatility". That said, implied volatility itself or, rather, its interpolations are also moving on a daily basis. This indicates that natural parameters such as convexity and skew of implied volatility might be a valuable tool for feeding a stochastic volatility model, but it is unreasonable to keep them as constant parameters inside the model.
  </p>
  <h1>
   <b>
    Pricing European Options
   </b>
  </h1>
  <p block-type="TextInlineMath">
   Heston's popularity is probably mainly derived from the fact that it is possible to price European options on the stock price
   <math display="inline">
    S
   </math>
   using semi-closed-form Fourier transformation, which in turn allows rapid calibration of the model parameters to market data. "Calibration" here means to infer values for the five unobservable parameters
   <math display="inline">
    \sqrt{v_0}, \sqrt{\theta}, \kappa, \sigma, \rho
   </math>
   from market data by minimizing the distance between the models' European option prices and observed market prices.
  </p>
  <p block-type="Text">
   We focus on the call prices. Following Carr and Madan [7], we price them
   <i>
    via
   </i>
   Fourier inversion.&lt;sup&gt;a&lt;/sup&gt; The call price for a relative strike
   <math display="inline">
    K
   </math>
   at maturity
   <math display="inline">
    T
   </math>
   is given as
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbb{C}(T,K) := \mathrm{DF}(T)\mathbb{E}\left[ (S_T - K F_T)^+ \right] \qquad (3)
   </math>
  </p>
  <p block-type="Text" class="has-continuation">
   where DF(T) represents the discount factor and
   <math display="inline">
    F_T
   </math>
   is the forward of the stock. Since the call price itself
  </p>
  <p block-type="TextInlineMath">
   is not an
   <math display="inline">
    L^2
   </math>
   -function in K, we define a "dampened call"
  </p>
  <p block-type="Equation">
   <math display="block">
    c(T,k) := \frac{\mathrm{e}^{\alpha k}}{\mathrm{DF}(T)F_T} \mathbb{C}(T,\mathrm{e}^k) \tag{4}
   </math>
  </p>
  <p block-type="TextInlineMath">
   for an
   <math display="inline">
    \alpha &gt; 0
   </math>
   ,&lt;sup&gt;b&lt;/sup&gt; for which its characteristic function
   <math display="inline">
    \psi_t(z;k) := \int_{\mathbb{R}} e^{ikz} c(t,k) dk
   </math>
   is well defined and given as
  </p>
  <p block-type="Equation">
   <math display="block">
    \psi_t(z;k) = \frac{\varphi_t (k - \mathrm{i}(\alpha + 1))}{(\mathrm{i}k + \alpha)(\mathrm{i}k + \alpha + 1)} \tag{5}
   </math>
  </p>
  <p block-type="TextInlineMath">
   The function
   <math display="inline">
    \varphi_t(z) := \mathbb{E}[\exp\{iz \log S_t/F_t\}]
   </math>
   is the characteristic function of
   <math display="inline">
    X_t := \log S_t / F_t
   </math>
   . Since Heston belongs to the affine model class, its characteristic function has the form
  </p>
  <p block-type="Equation">
   <math display="block">
    \varphi_t(z) = \mathrm{e}^{-v_0 A_t - m B_t} \tag{6}
   </math>
  </p>
  <p block-type="Text">
   with (cf. [14])
  </p>
  <p block-type="Equation">
   <math display="block">
    A_{t} := \frac{\alpha + ae^{\gamma t}}{\beta + be^{\gamma t}} \quad \text{and}
   </math>
   <math display="block">
    B_{t} := \tilde{\kappa} \frac{\alpha b\gamma t + (a\beta - \alpha b)\log\frac{\beta + be^{\gamma t}}{\beta + b}}{\beta b\gamma} \qquad (7)
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    \mu := (iz + z^2)/2
   </math>
   ,
   <math display="inline">
    \tilde{\kappa} := \kappa - \rho iz\sigma
   </math>
   ,
   <math display="inline">
    \gamma :=
   </math>
   <math display="inline">
    -\sqrt{2\mu\sigma^2+\tilde{\kappa}^2}
   </math>
   ,
   <math display="inline">
    a:=-2\mu
   </math>
   ,
   <math display="inline">
    \alpha:=2\mu
   </math>
   ,
   <math display="inline">
    b:=-\tilde{\kappa}+\gamma
   </math>
   and
   <math display="inline">
    \beta := \tilde{\kappa} + \gamma
   </math>
   .
  </p>
  <p block-type="Text">
   We can then price a call on
   <math display="inline">
    X
   </math>
   using
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbb{C}(T, K) = \text{DF}(T)F_T \frac{e^{-\alpha \ln(K)}}{\pi}
   </math>
   <math display="block">
    \times \int_0^\infty e^{-iz \ln(K)} \psi_t(z; \ln(K)) dz \quad (8)
   </math>
  </p>
  <p block-type="Text">
   The method also lends itself to Fast Fourier Transform if a range of option prices for a single maturity is required.
  </p>
  <p block-type="Text">
   Similarly, various other payoffs can be computed very efficiently with the Fourier approach, for example, forward started vanilla options, options on integrated short variance, and digital options.
  </p>
  <h1>
   Time-Dependent Parameters
  </h1>
  <p block-type="Text">
   Moreover, for most of these products—and most importantly, plain European options—it is very straightforward to extend the model to time-dependent, piece-wise constant parameters. This is briefly
  </p>
  <p>
   <img src="_page_3_Figure_1.jpeg"/>
  </p>
  <p>
   <b>
    Figure 3
   </b>
   Heston (a) without and (b) with time-dependent parameters fitted to STOXX50E for maturities from 1m to 5y. The introduction of time dependency clearly improves the fit
  </p>
  <p block-type="Text">
   discussed in [14]. It improves the fit of the model to the market prices markedly, cf. Figure 3.
  </p>
  <p block-type="Text">
   However, it should be noted that by introducing piecewise constant time-dependent parameters, we lose much of a model's structure. It is turned from a time-homogeneous model which "takes a view" on the actual evolution of the volatility
   <i>
    via
   </i>
   its SDE into a kind of an arbitrage-free interpolation of market data: if calibrated without additional constraints to ensure smoothness of the parameters over time, this
  </p>
  <p>
   is reflected in large discrepancies of the parameter values for distinct periods. For example, the excellent fit of the time-dependent Heston model in Figure 3 is achieved with the following parameter values (short volatility
   <math display="inline">
    \sqrt{\zeta_0}
   </math>
   was 15.0%):
  </p>
  <table>
   <tbody>
    <tr>
     <th>
     </th>
     <th>
     </th>
     <th>
     </th>
     <th>
     </th>
     <th>
     </th>
    </tr>
    <tr>
     <th>
     </th>
     <th>
      6m
     </th>
     <th>
      1v
     </th>
     <th>
      3v
     </th>
     <th>
      <math>
       \infty
      </math>
     </th>
    </tr>
    <tr>
     <td>
      Long Vol
      <math>
       \sqrt{\theta}
      </math>
     </td>
     <td>
      20.7%
     </td>
     <td>
      23.6%
     </td>
     <td>
      36.1%
     </td>
     <td>
      46.5%
     </td>
    </tr>
    <tr>
     <td>
      Reversion
     </td>
     <td>
      5.0
     </td>
     <td>
      3.2
     </td>
     <td>
      0.4
     </td>
     <td>
      0.3
     </td>
    </tr>
    <tr>
     <td>
      Speed
      <math>
       \kappa
      </math>
     </td>
     <td>
     </td>
     <td>
     </td>
     <td>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      Correlation
      <math>
       \rho
      </math>
     </td>
     <td>
      <math>
       -55.2\%
      </math>
     </td>
     <td>
      <math>
       -70.9\%
      </math>
     </td>
     <td>
      <math>
       -80.1\%
      </math>
     </td>
     <td>
      <math>
       -69.4\%
      </math>
     </td>
    </tr>
    <tr>
     <td>
      Vol Of Vol
      <math>
       \sigma
      </math>
     </td>
     <td>
      78.7%
     </td>
     <td>
      81.5%
     </td>
     <td>
      35.3%
     </td>
     <td>
      60.0
     </td>
    </tr>
    <tr>
     <td>
     </td>
     <td>
     </td>
     <td>
     </td>
     <td>
     </td>
     <td>
     </td>
    </tr>
   </tbody>
  </table>
  <p block-type="Text">
   The increased number of parameters also makes it more difficult to hedge in such a model in practice; even though both Heston and the time-dependent Heston models create complete markets, we will always need to additionally protect our position against moves in the parameter values of our model. Just as for Vega in Black and Scholes, this is typically done by computing "parameter greeks" and neutralizing the respective sensitivities. Clearly, the more the parameters that are involved, and the less stable these are, this "parameter hedge" becomes less and less reliable.
  </p>
  <h2>
   Mathematical Drawbacks
  </h2>
  <p block-type="Text">
   The underlying mathematical reason for the relative tractability of Heston's model is that
   <math display="inline">
    v
   </math>
   is a squared Bessel process, which is well understood and reasonably tractable. In fact, a statistical estimation on S&amp;P 500 by Aït-Sahalia and Kimmel [1] of
   <math display="inline">
    \alpha \in [1/2, 2]
   </math>
   in the extended model
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{d}v_t = \kappa(\theta - v_t)\,\mathrm{d}t + \sigma v_t^{\alpha}\,\mathrm{d}W_t^1\tag{9}
   </math>
  </p>
  <p block-type="Text">
   has shown that, depending on the observation frequency, a value around 0.7 would probably be more adequate (see Econometrics of Diffusion Models). What is more, the square-root volatility terms mean that unless
  </p>
  <p block-type="Equation">
   <math display="block">
    2\kappa\theta \ge \sigma^2 \tag{10}
   </math>
  </p>
  <p block-type="Text">
   the process
   <math display="inline">
    v
   </math>
   can reach zero with nonzero probability. The crux is that this condition is regularly violated if the model is calibrated freely to observed market data. Although a vanishing short variance is not a problem in itself (after all, a variance of zero simply means absence of trading activity), it makes
  </p>
  <p>
   <img src="_page_4_Figure_1.jpeg"/>
  </p>
  <p block-type="Text">
   Probability density of Heston's short vol for a 20%
  </p>
  <p>
   <b>
    Figure 4
   </b>
   This graphs shows the density of
   <i>
    vt
   </i>
   for one, three and six months for the case where condition (10) is satisfied (above) or not (below). Apart from Vol Of Vol, the parameters were
   <i>
    v
   </i>
   <sup>
    0
   </sup>
   = 15%2,
   <i>
    θ
   </i>
   = 20%2 and
   <i>
    κ
   </i>
   = 1
  </p>
  <p block-type="Text">
   numerical approximations more complicated. In a Monte Carlo simulation, for example, we have to take the event of
   <i>
    v
   </i>
   being negative into account. The same problem appears in a partial differential equation (PDE) solver: Heston's PDE becomes degenerate if Short Vol hits zero. A violation of Equation (10) also implies that the distribution of short variance
   <i>
    Vt
   </i>
   at some later time
   <i>
    t
   </i>
   is very wide, cf. Figure 4.
  </p>
  <p block-type="Text" class="has-continuation">
   Additionally, if Equation (10) does not hold, then the stock price
   <i>
    S
   </i>
   may fail to have a second moment if the Correlation is not negative enough in the
  </p>
  <p block-type="Text">
   sense detailed in proposition 3.1 in [2] (
   <i>
    see
   </i>
   <b>
    Moment Explosions
   </b>
   for more details). Again, this is not a problem from a purely mathematical point of view, but it makes numerical schemes less efficient. In particular, Monte Carlo simulations perform much worse: although an Euler scheme will still converge to the desired value, the speed of convergence deteriorates. Moreover, we cannot safely use control variates anymore if the payoff is not bounded.
  </p>
  <h2>
   <b>
    Pricing Methods
   </b>
  </h2>
  <p block-type="Text">
   Once we have calibrated the model using the aforementioned semiclosed form of solution for the European options, the question is how to evaluate complex products. At our disposal are PDEs and Monte Carlo schemes.
  </p>
  <p block-type="TextInlineMath">
   Since the conditional transition density of the entire process is not known, we have to revert to solving a discretization of the SDE (1) if we want to use a Monte Carlo scheme (see Monte Carlo Simulation for Stochastic Differential Equations for an overview of Monte Carlo concepts). To this end, assume that we are given fixing dates
   <math display="inline">
    0 = t_0 &lt; \cdots &lt;
   </math>
   <math display="inline">
    t_N = T
   </math>
   and let
   <math display="inline">
    \Delta t_i := t_{i+1} - t_i
   </math>
   for
   <math display="inline">
    i = 0, ..., N - 1
   </math>
   . Moreover, we denote by
   <math display="inline">
    \Delta W_i
   </math>
   for
   <math display="inline">
    i = 0, \ldots, N-1
   </math>
   a sequence of independent normal variables with variance
   <math display="inline">
    \Delta_i
   </math>
   , and by
   <math display="inline">
    \Delta B_i
   </math>
   a corresponding sequence where
   <math display="inline">
    \Delta B_i
   </math>
   and
   <math display="inline">
    \Delta W_i
   </math>
   have Correlation
   <math display="inline">
    \rho
   </math>
   .
  </p>
  <p block-type="Text">
   When using a straightforward Euler scheme, we will face the problem that
   <math display="inline">
    v
   </math>
   can become negative. It works well simply to reduce the volatility term of the variance to the positive part of the variance, that is, to simulate
  </p>
  <p block-type="Equation">
   <math display="block">
    v_{t_{i+1}} = v_{ti} + \kappa (\theta - v_{ti}) \Delta_i + \sigma \sqrt{v_{ti}^+} \Delta W_i \qquad (11)
   </math>
  </p>
  <p block-type="Text">
   A flaw of this scheme is that it is biased. This is overcome by using the moment-matching scheme
  </p>
  <p block-type="Equation">
   <math display="block">
    v_{t_{i+1}} = \theta \Delta t_i + \left(\theta - v_{t_i}\right) e^{-\kappa \Delta t_i} + \left(\sigma v_{t_i}^+ \sqrt{\frac{1 - e^{-2\kappa \Delta t_i}}{2\kappa}}\right) \Delta W_i \qquad (12)
   </math>
  </p>
  <p block-type="Text">
   which works well in practice. To compute the stock price, we approximate the integrated variance over
   <math display="inline">
    [t_i, t_{i+1}]
   </math>
   as
  </p>
  <p block-type="Equation">
   <math display="block">
    \Delta_i V := \theta \Delta t_i + \left(v_{t_i} - \theta\right) \frac{1 - e^{-\kappa \Delta t_i}}{\kappa} \tag{13}
   </math>
  </p>
  <p block-type="Text">
   and set
  </p>
  <p block-type="Equation">
   <math display="block">
    S_{t_k} := F_{t_k} \exp\left\{\sum_{i=1}^{k-1} \left\{\sqrt{\Delta_i V} \Delta B_i - \frac{1}{2} \Delta_i V\right\}\right\} \quad (14)
   </math>
  </p>
  <p block-type="TextInlineMath">
   Note that this scheme is unbiased in the sense that
   <math display="inline">
    \mathbb{E}[S_T] = F_T
   </math>
   .
  </p>
  <h4>
   Heston's PDE
  </h4>
  <p block-type="Text">
   It is straightforward to derive the PDE for the previous model. Let
  </p>
  <p block-type="Equation">
   <math display="block">
    P_t(v, S) := DF_t(T) \mathbb{E} [F(S_T) | S_t = S, v_t = v] \quad (15)
   </math>
  </p>
  <p block-type="Text">
   be the price of a derivative with maturity
   <math display="inline">
    T
   </math>
   at time
   <math display="inline">
    t
   </math>
   . It satisfies
  </p>
  <p block-type="Equation">
   <math display="block">
    0 = r_t P_t + \partial_S P_t (r_t - \mu_t) S_t + \partial_v P_t \kappa (m - v_t)
   </math>
   <br/>
   +
   <math>
    \frac{1}{2} \partial_{SS}^2 P_t S_t v_t + \frac{1}{2} \partial_{vv}^2 P_t \sigma^2 v_t + \partial_{vS}^2 P_t \rho v_t S_t
   </math>
   (16)
  </p>
  <p block-type="TextInlineMath">
   with boundary condition
   <math display="inline">
    P_T(S, v) = F(S_T)
   </math>
   . To solve this two-factor PDE with a potentially degenerate diffusion term in
   <math display="inline">
    \partial_{uv}^2 P_t
   </math>
   , it is recommended to use a stabilized alternating direction implicit (ADI) scheme such as the one described by Craig and Sneyd [8] (see Alternating Direction Implicit (ADI) Method for a discussion on ADI).
  </p>
  <h4>
   <b>
    Risk Management
   </b>
  </h4>
  <p block-type="TextInlineMath">
   Provided that we consider not only the stock price itself but also a second liquid instrument
   <math display="inline">
    V
   </math>
   such as a listed option as hedging instrument, stochastic volatility models are complete, that is, in theory every contingent claim
   <math display="inline">
    P
   </math>
   can be replicated in the sense that there are hedging strategies
   <math display="inline">
    (\Delta_t, \mathcal{V}_t)_t
   </math>
   such that
  </p>
  <p block-type="Equation">
   <math display="block">
    dP_t - r_t P_t dt = \Delta_t (dS_t - S_t(r_t - \mu_t) dt)
   </math>
   <br/>
   +
   <math>
    \mathcal{V}_t (dV_t - r_t V_t dt)
   </math>
   (17)
  </p>
  <p block-type="TextInlineMath">
   (see
   <b>
    Complete Markets
   </b>
   for a discussion on complete markets). In Heston's model, we can write the price process of both the derivative we want to hedge and the hedging instrument as a function of current spot level and short variance, that is,
   <math display="inline">
    P_t \equiv P_t(S_t, v_t)
   </math>
   and
   <math display="inline">
    V_t \equiv V_t(S_t, v_t)
   </math>
   . Then, the correct hedging ratios are
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathcal{V}_t = \frac{\partial_v P}{\partial_v V} \quad \text{and} \quad \Delta_t = \partial_S P_t - \frac{\partial_v P}{\partial_v V} \partial_S V_t \quad (18)
   </math>
  </p>
  <p block-type="Text" class="has-continuation">
   This is the equivalent of delta hedging in Black and Scholes (see
   <b>
    Delta Hedging
   </b>
   ). However, as for the latter, plain theoretical hedging will not work since the other parameters in our model, Reversion Speed, Vol of Vol, Long Vol, and potentially Correlation, will not remain constant if we calibrate our model on a
  </p>
  <p block-type="Text">
   daily basis. This is the effect of a change in volatility for Black and Scholes—a change of this parameter is not anticipated by the model itself and must be taken care of "outside the model".
  </p>
  <p block-type="Text">
   As a result, one way to control this risk is to engage in additional parameter hedging, that is, the desk also displays sensitivities with respect to the other model parameters including, potentially, second-order exposures. Those can then be monitored on a book level and managed explicitly. The drawback of this method is that to reduce risk with respect to those parameters, a portfolio of vanilla options has to be bought whose composition can change quickly if implemented blindly.&lt;sup&gt;c&lt;/sup&gt;
  </p>
  <p block-type="Text">
   A second variant is to try to map standard risks of the desk such as implied volatility convexity, skewness, and so on into stochastic volatility risk by "recalibration". The idea here is that, say, the convexity parameter of the implied volatility is modified, then Heston's model is calibrated to this new implied volatility surface and the option priced off this model. The resulting change in model price is then considered the sensitivity of the option to convexity in implied volatility. This approach suffers from the fact that typical "implied vol risks" are very different from typical movements in the Heston model. For example, the standard Heston model is homogeneous so it cannot easily accommodate changes in short-term skew only.
  </p>
  <h2>
   <b>
    Related Models
   </b>
  </h2>
  <p block-type="Text">
   Owing to its numerical efficiency, Heston's model is the base for many extensions. The first notable extension is Bates' addition of jumps to the diffusion process in his article [3] (see
   <b>
    Bates Model
   </b>
   ). Jumps are commonly seen as a necessary feature of any risk management model, even though the actual handling of the jump risk part is far from clear.
  </p>
  <p block-type="Text">
   Bates' approach can be written as follows: let
   <math display="inline">
    X
   </math>
   be given by
  </p>
  <p block-type="Equation">
   <math display="block">
    \begin{aligned} \mathrm{d}v_t &amp;= \kappa (\theta - v_t) \, \mathrm{d}t + \sigma \sqrt{v_t} \, \mathrm{d}W_t \\ \mathrm{d}X_t &amp;= X_t \sqrt{v_t} \, \mathrm{d}B_t \end{aligned} \tag{19}
   </math>
  </p>
  <p block-type="Text">
   and let
  </p>
  <p block-type="Equation">
   <math display="block">
    S_t = F_t X_t e^{\sum_{j=1}^{N_t} \xi_j - \lambda m t}
   </math>
   (20)
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    N_t
   </math>
   is a Poisson process with intensity
   <math display="inline">
    \lambda
   </math>
   (see
   <b>
    Poisson Process
   </b>
   ) and where
   <math display="inline">
    (\xi_i)_i
   </math>
   are the normal jumps of the returns of S with mean
   <math display="inline">
    \mu
   </math>
   and volatility v. To make sure that
   <math display="inline">
    S_t/F_t
   </math>
   is a martingale we stipulate that
   <math display="inline">
    \mu = e^{m + \frac{1}{2}v^2} - 1
   </math>
   .
  </p>
  <p block-type="Text">
   Since the process
   <math display="inline">
    X
   </math>
   is independent of the jumps, the characteristic function of the log-stock process is the product of the separate characteristic functions. In other words, Bates' model can be evaluated using the same approach as above and is equally efficient while allowing for a very pronounced short-term skew due to the jump part.&lt;sup&gt;d&lt;/sup&gt; Figure 5 shows the improvement of time-dependent Bates over time-dependent Heston.
  </p>
  <p block-type="Text">
   The model has been further enhanced by Knudsen and Nguyen-Ngoc [12] who also added exponentially distributed jumps to the variance process.
  </p>
  <h4>
   <b>
    Multifactor Models
   </b>
  </h4>
  <p block-type="TextInlineMath">
   Structurally, Heston's model is a member of the class of "affine models" as introduced by Duffie et al. [9]. As such, it can easily be extended by mixing in further independent square-root processes. One obvious approach presented in [14] is simply to multiply several independent Heston processes. For the two-factor case, this means to set
   <math display="inline">
    S_t := F_t X_t^1 X_t^2
   </math>
   where both
   <math display="inline">
    X^1
   </math>
   and
   <math display="inline">
    X^2
   </math>
   have the form (19). Jumps can be added, but to make the Fourier integration work efficiently, the processes
   <math display="inline">
    X^1
   </math>
   and
   <math display="inline">
    X^2
   </math>
   must remain independent.
  </p>
  <p block-type="Text">
   The stochastic variance of the joint stock price is then simply the sum of the two separate variances,
   <math display="inline">
    v^1
   </math>
   and
   <math display="inline">
    v^2
   </math>
   , and it is intuitively assumed that one is a "short-term", fast mean-reverting process whereas the other is mean reverting slowly. Such a structure is supported by statistical evidence, cf. [10]. However, the independence of the two processes makes it very difficult to impose enough skew into this model since the effective Correlation between instantaneous variance and stock price weakens. In practice, this model is used only rarely.
  </p>
  <p block-type="Text">
   A related model "Double Heston" has been mentioned by Buehler [6], which is obtained by modeling the mean variance level
   <math display="inline">
    \theta
   </math>
   in Heston itself as a squareroot diffusion, that is,
  </p>
  <p block-type="Equation">
   <math display="block">
    \begin{aligned} \mathrm{d}v_t &amp;= \kappa (\theta_t - v_t) \, \mathrm{d}t + \sigma \sqrt{v_t} \, \mathrm{d}W_t \\ \mathrm{d}\theta_t &amp;= c(m - \theta_t) \, \mathrm{d}t + v \sqrt{\theta_t} \, \mathrm{d}W_t^{\theta} \\ \mathrm{d}S_t &amp;= S_t (r_t - \mu_t) \, \mathrm{d}t + S_t \sqrt{v_t} \, \mathrm{d}B_t \end{aligned} \tag{21}
   </math>
  </p>
  <p>
   <img src="_page_7_Figure_1.jpeg"/>
  </p>
  <p>
   <b>
    Figure 5
   </b>
   Heston (a) and Bates (b) with time-dependent parameters fitted to STOXX50E for maturities from 1m to 5y
  </p>
  <p block-type="TextInlineMath">
   where
   <i>
    W
    <sup>
     θ
    </sup>
   </i>
   is independent of
   <i>
    W
   </i>
   and
   <i>
    B
   </i>
   . While this model has a reasonably tractable characteristic function, it also suffers from the problem that long-term skew becomes too symmetric, contrary to what is observed in the market. Such a model, however, may have applications when pricing options on variance where the skew counts less and it is more important to be able to account for some dynamics of the term
   <i>
    structure of variance
   </i>
   . Refer to [6] for an extensive discussion on this.
  </p>
  <h2>
   <i>
    Fitted Heston
   </i>
  </h2>
  <p block-type="TextInlineMath">
   A particular class of derivatives that has gained reasonable popularity in recent years are "Options on Variance", that is, structures whose terminal payoff depends on the realized variance of the returns of the stock over a set of business days 0 =
   <i>
    t
   </i>
   <sup>
    0
   </sup>
   <i>
    &lt;
   </i>
   ···
   <i>
    &lt; tn
   </i>
   =
   <i>
    T
   </i>
   ,
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbb{RV}(T) := \sum_{i=1}^{n} \left( \log \frac{S_{t_i}}{S_{t_{i-1}}} \right)^2 \tag{22}
   </math>
  </p>
  <p block-type="TextInlineMath">
   The most standard of such products is a "variance swap" (
   <i>
    see
   </i>
   <b>
    Variance Swap
   </b>
   ), which essentially pays the actual realized annualized variance over the period in exchange for a previously agreed fair strike. This strike is usually quoted in volatility terms, that is a variance swap with maturity
   <i>
    T
   </i>
   , and strike
   <i>
    (T )
   </i>
   pays
  </p>
  <p block-type="Equation">
   <math display="block">
    \frac{252}{n}\mathbb{RV}(T) - \Sigma^2(T) \tag{23}
   </math>
  </p>
  <p block-type="Text">
   From this product, a market with options on realized variance has evolved naturally; these include capped variance swaps (mainly traded on single stocks), outright straddles on realized variance swaps, and also VIX futures and options (
   <i>
    see
   </i>
   <b>
    Realized Volatility Options
   </b>
   ). Although there are several discussions around how best to approach the risk management of such products, a particularly useful Heston's model is the "Fitted Heston" approach introduced by Buehler [4].
  </p>
  <p block-type="Text">
   The main idea here is that to price an option on realized variance in a given model, it is crucial to price correctly a variance swap itself, that is, to make sure that
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathbb{E}\left[\mathbb{RV}(T)\right] = \frac{n}{252} \Sigma^2(T) \tag{24}
   </math>
  </p>
  <p block-type="TextInlineMath">
   The idea of "fitting to the market", say, Heston's model (2) is now simply to force the model to satisfy this equation. First, assume that we have the term structure of the market's expected realized variance,
   <i>
    M(T )
   </i>
   =
   <i>
    n
   </i>
   <sup>
    2
   </sup>
   <i>
    (T )/
   </i>
   252 =
   <sup>
    2
   </sup>
   <i>
    (T )T
   </i>
   , and define
   <i>
    m(t)
   </i>
   :=
   <i>
    ∂T
   </i>
   |
   <i>
    <sup>
     T
    </sup>
   </i>
   <sup>
    =
   </sup>
   <i>
    tM(T )
   </i>
   . Take the original short variance of the model,
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathrm{d}v_t = (\theta - v_t)\kappa \,\mathrm{d}t + \sigma \sqrt{v_t} \sqrt{\kappa} \,\mathrm{d}W_t \qquad (25)
   </math>
  </p>
  <p block-type="Text">
   and define the new "fitted" process as
  </p>
  <p block-type="Equation">
   <math display="block">
    w_t := m(t) \frac{v_t}{\mathbb{E}\left[v_t\right]} \tag{26}
   </math>
  </p>
  <p block-type="Text">
   with the stock price as
  </p>
  <p block-type="Equation">
   <math display="block">
    dS_t = S_t(r_t - \mu_t) dt + S_t \sqrt{w_t} dB_t \qquad (27)
   </math>
  </p>
  <p block-type="Text">
   This now reprices all variance swaps automatically in the sense (24). Note that this method does not at all depend on using Heston's model and can be applied to any stochastic volatility model as long as the expectation of instantaneous variance is known.
  </p>
  <p block-type="Text">
   As pointed out in [6], this model is naturally very attractive from a risk-management point of view if the input
   <i>
    M
   </i>
   is computed on the fly within the risk management system. In this case, the risk embedded in the variance swap level (called
   <i>
    VarSwapDelta
   </i>
   ) is automatically reflected back in the standard implied volatility risk, and the underlying stochastic volatility model is used purely to control skew and convexity around the variance swap backbone.e Further practical considerations and the impact of jumps are discussed by Buehler in [5].
  </p>
  <h1>
   <b>
    End Notes
   </b>
  </h1>
  <p block-type="Text">
   a
   <i>
    .
   </i>
   In his original paper [11], Heston suggested a numerically more expensive approach via numerical integration that is twice as slow but still much faster than the same computation for most other models. The approach to price with Fourier inversion is due to Carr and Madan [7]; the interested reader finds more details on the subject in Lewis's book [13].
  </p>
  <p block-type="Text">
   b
   <i>
    .
   </i>
   See [7] for a discussion on the choice of
   <i>
    α
   </i>
   .
  </p>
  <p block-type="Text">
   c
   <i>
    .
   </i>
   Bermudez
   <i>
    et al.
   </i>
   discuss one approach to find such portfolios [14].
  </p>
  <p block-type="Text">
   d
   <i>
    .
   </i>
   In practice, calibrating all parameters (stochastic volatility plus jumps) together is relatively unstable since the two parts play similar roles for the short-term options. It is therefore customary to fix the jump parameters themselves or to calibrate them separately to very short-term options. e
   <i>
    .
   </i>
  </p>
  <p block-type="Text">
   Usually, the parameters
   <i>
    v
   </i>
   <sup>
    0
   </sup>
   and
   <i>
    θ
   </i>
   are fixed to some "usual level" such as 20%. Then, they do not need to be calibrated anymore and, in addition,
   <i>
    σ
   </i>
   retains some comparability to the standard Heston model.
  </p>
  <h1>
   <b>
    References
   </b>
  </h1>
  <p block-type="ListGroup" class="has-continuation">
   <ul>
    <li block-type="ListItem">
     [1] A¨ıt-Sahalia, Y. &amp; Kimmel, R. (2004).
     <i>
      Maximum Likelihood Estimation of Stochastic Volatility Models
     </i>
     , NBER Working Paper No. 10579, June 2004.
    </li>
    <li block-type="ListItem">
     [2] Andersen, L. &amp; Piterbarg, V. (2007). Moment explosions in stochastic volatility models,
     <i>
      Finance and Stochastics
     </i>
     <b>
      11
     </b>
     (1), 20–50.
    </li>
   </ul>
  </p>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     [3] Bates, D. (1996). Jumps and stochastic volatility: exchange rate process implicit in the Deutschemark options,
     <i>
      Review of Financial Studies
     </i>
     <b>
      9
     </b>
     (1), 69–107.
    </li>
    <li block-type="ListItem">
     [4] Buehler, H. (2006). Consistent variance curve models,
     <i>
      Finance and Stochastics
     </i>
     <b>
      10
     </b>
     (2), 178–203.
    </li>
    <li block-type="ListItem">
     [5] Buehler, H. (2006). Options on variance: pricing and hedging,
     <i>
      Presentation, IQPC Volatility Trading Conference
     </i>
     , London November 28th, 2006, http://www. quantitative-research.de/dl/IQPC2006-2.pdf
    </li>
    <li block-type="ListItem">
     [6] Buehler, H. (2006).
     <i>
      Volatility Markets: Consistent Modeling, Hedging and Practical Implementation
     </i>
     , PhD thesis TU Berlin, http://www.quantitative-research.de/dl/ HansBuehlerDiss.pdf
    </li>
    <li block-type="ListItem">
     [7] Carr, P. &amp; Madan, D. (1999). Option pricing and the Fast Fourier Transform,
     <i>
      Journal of Computational Finance
     </i>
     <b>
      2
     </b>
     (4), 61–73. Summer.
    </li>
    <li block-type="ListItem">
     [8] Craig, I.J.D. &amp; Sneyd, A.D. (1988). An alternatingdirection implicit scheme for parabolic equations with mixed derivatives,
     <i>
      Computers and Mathematics with Applications
     </i>
     <b>
      16
     </b>
     (4), 341–350.
    </li>
    <li block-type="ListItem">
     [9] Duffie, D., Pan, J. &amp; Singleton, K. (2000). Transform analysis and asset pricing for affine jump-diffusions,
     <i>
      Econometrica
     </i>
     <b>
      68
     </b>
     , 1343–1376.
    </li>
    <li block-type="ListItem">
     [10] Fouque, J.-P., Papanicolaou, G. &amp; Sircar, K. (2000).
     <i>
      Derivatives in Financial Markets with Stochastic Volatility
     </i>
     , Cambridge Press.
    </li>
    <li block-type="ListItem">
     [11] Heston, S. (1993). A closed-from solution for option with stochastic volatilty with applications to bond and currency options,
     <i>
      Review of Financial Studies
     </i>
     <b>
      6
     </b>
     (2), 327–343.
    </li>
    <li block-type="ListItem">
     [12] Knudsen, T. &amp; Nguyen-Ngoc, L. (2000). The Heston model steps further Deutsche Bank Quantessence
     <b>
      1
     </b>
     (7) https://www.dbconvertibles.com/dbquant/quantessence/ Vol1Issue7External.pdf
    </li>
    <li block-type="ListItem">
     [13] Lewis, A. (2000).
     <i>
      Option Valuation under Stochastic Volatility
     </i>
     , Finance Press.
    </li>
    <li block-type="ListItem">
     [14] Overhaus, M., Bermudez, A., Buehler, H., Ferraris, A., Jordinson, C., Lamnouar, A. (2006).
     <i>
      Equity Hybrid Derivatives
     </i>
     , Wiley.
    </li>
   </ul>
  </p>
  <h1>
   <b>
    Related Articles
   </b>
  </h1>
  <p block-type="Text">
   <b>
    Alternating Direction Implicit (ADI) Method
   </b>
   ;
   <b>
    Bates Model
   </b>
   ;
   <b>
    Complete Markets
   </b>
   ;
   <b>
    Cliquet Options
   </b>
   ;
   <b>
    Econometrics of Diffusion Models
   </b>
   ;
   <b>
    Hedging
   </b>
   ;
   <b>
    Hull–White Stochastic Volatility Model
   </b>
   ;
   <b>
    Model Calibration
   </b>
   ;
   <b>
    Monte Carlo Simulation for Stochastic Differential Equations
   </b>
   ;
   <b>
    Moment Explosions
   </b>
   ;
   <b>
    Realized Volatility Options
   </b>
   ;
   <b>
    Variance Swap
   </b>
   .
  </p>
  <p block-type="Text">
   HANS BUEHLER
  </p>
 </body>
</html>
