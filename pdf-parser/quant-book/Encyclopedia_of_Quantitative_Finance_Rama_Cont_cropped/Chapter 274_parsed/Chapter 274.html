<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
 </head>
 <body>
  <h1>
   <b>
    Stochastic Taylor Expansions
   </b>
  </h1>
  <h2>
   <b>
    Deterministic Taylor Formula
   </b>
  </h2>
  <p block-type="TextInlineMath">
   As the concept of a stochastic Taylor expansion can be widely applied, we first review the
   <i>
    deterministic Taylor expansion
   </i>
   , using some terminology which will facilitate the presentation of its stochastic counterparts. Let us consider the solution
   <i>
    X
   </i>
   = {
   <i>
    Xt, t
   </i>
   ∈ [0
   <i>
    , T
   </i>
   ]} of the ordinary differential equation d
   <i>
    Xt
   </i>
   =
   <i>
    a(Xt)
   </i>
   d
   <i>
    t
   </i>
   , for
   <i>
    t
   </i>
   ∈ [0
   <i>
    , T
   </i>
   ] with initial value
   <i>
    X
   </i>
   0. We can write this equation in its integral form as
  </p>
  <p block-type="Equation">
   <math display="block">
    X_t = X_0 + \int_0^t a(X_s) \, \mathrm{d}s \tag{1}
   </math>
  </p>
  <p block-type="Text">
   To justify the following calculations, we require the drift function
   <i>
    a
   </i>
   to be smooth and such that the solution of equation (1) does not explode. Then by using the deterministic chain rule, we can write
  </p>
  <p block-type="Equation">
   <math display="block">
    df(X_t) = a(X_t) \frac{\partial}{\partial x} f(X_t) dt \tag{2}
   </math>
  </p>
  <p block-type="TextInlineMath">
   Using the operator
   <i>
    L
   </i>
   =
   <i>
    a ∂/∂x
   </i>
   , we may express equation (2) as the integral equation
  </p>
  <p block-type="Equation">
   <math display="block">
    f(X_t) = f(X_0) + \int_0^t L f(X_s) \, \mathrm{d}s \tag{3}
   </math>
  </p>
  <p block-type="TextInlineMath">
   for all
   <i>
    t
   </i>
   ∈ [0
   <i>
    , T
   </i>
   ]. Note for the special case
   <i>
    f (x)
   </i>
   ≡
   <i>
    x
   </i>
   we have
   <i>
    Lf
   </i>
   =
   <i>
    a
   </i>
   ,
   <i>
    LLf
   </i>
   =
   <i>
    (L)
   </i>
   <sup>
    2
   </sup>
   <i>
    f
   </i>
   =
   <i>
    La, . . .
   </i>
   , and equation (3) reduces to equation (1). If we now apply relation (3) to the integrand
   <i>
    f
   </i>
   =
   <i>
    a
   </i>
   in equation (1), then we obtain
  </p>
  <p block-type="Equation">
   <math display="block">
    X_{t} = X_{0} + \int_{0}^{t} \left( a(X_{0}) + \int_{0}^{s} L \, a(X_{z}) \, \mathrm{d}z \right) \, \mathrm{d}s
   </math>
   <br/>
   <math display="block">
    = X_{0} + a(X_{0}) \int_{0}^{t} \, \mathrm{d}s + \int_{0}^{t} \int_{0}^{s} L \, a(X_{z}) \, \mathrm{d}z \, \mathrm{d}s \tag{4}
   </math>
  </p>
  <p block-type="Text" class="has-continuation">
   which is the simplest nontrivial Taylor expansion for
   <i>
    Xt
   </i>
   . We can now apply equation (3) to the function
  </p>
  <p block-type="TextInlineMath">
   <i>
    f
   </i>
   =
   <i>
    La
   </i>
   in the above double integral in equation (4). Consequently, we obtain
  </p>
  <p block-type="Equation">
   <math display="block">
    X_{t} = X_{0} + a(X_{0}) \int_{0}^{t} ds
   </math>
   <br/>
   +
   <math>
    La(X_{0}) \int_{0}^{t} \int_{0}^{s} dz ds + R_{1}
   </math>
   (5)
  </p>
  <p block-type="Text">
   with remainder term
  </p>
  <p block-type="Equation">
   <math display="block">
    R_1 = \int_0^t \int_0^s \int_0^z (L)^2 a(X_u) \, \mathrm{d}u \, \mathrm{d}z \, \mathrm{d}s \qquad (6)
   </math>
  </p>
  <p block-type="TextInlineMath">
   for
   <i>
    t
   </i>
   ∈ [0
   <i>
    , T
   </i>
   ]. Continuing this way then we get a version of the classical deterministic
   <i>
    Taylor formula
   </i>
  </p>
  <p block-type="Equation">
   <math display="block">
    f(X_t) = f(X_0) + \sum_{l=1}^r \frac{t^{\ell}}{l!} (L)^{\ell} f(X_0)
   </math>
   <math display="block">
    + \int_0^t \cdots \int_0^{s_2} (L)^{r+1} f(X_{s_1}) \, \mathrm{d}s_1 \dots \, \mathrm{d}s_{r+1} \tag{7}
   </math>
  </p>
  <p block-type="TextInlineMath">
   for
   <i>
    t
   </i>
   ∈ [0
   <i>
    , T
   </i>
   ] and
   <i>
    r
   </i>
   ∈ N. In the sum on the righthand side of equation (5), we find the expansion terms that are expanded at time zero or, more precisely, at the value
   <i>
    X
   </i>
   0. Furthermore, the last term, which is a multiple integral, represents the remainder term. Its integrand is, in general, not a constant. The deterministic Taylor formula allows the approximation of a sufficiently smooth function in a neighborhood of a given expansion point to any desired order of accuracy as long as
   <i>
    f
   </i>
   and
   <i>
    a
   </i>
   are sufficiently smooth.
  </p>
  <h2>
   <b>
    Wagner–Platen Expansion
   </b>
  </h2>
  <p block-type="TextInlineMath">
   It is important to be able to approximate the increments of smooth functions of solutions of stochastic differential equations. For these tasks, a stochastic expansion, with analogous properties to the deterministic Taylor formula, is needed. The
   <i>
    Wagner–Platen expansion
   </i>
   (see [1, 2, 5, 8, 10, 11]) is such a stochastic Taylor expansion. We derive here one of its versions for a diffusion process
   <i>
    X
   </i>
   = {
   <i>
    Xt, t
   </i>
   ∈ [0
   <i>
    , T
   </i>
   ]} satisfying
  </p>
  <p block-type="Equation">
   <math display="block">
    X_{t} = X_{0} + \int_{0}^{t} a(X_{s}) \, \mathrm{d}s + \int_{0}^{t} b(X_{s}) \, \mathrm{d}W_{s} \qquad (8)
   </math>
  </p>
  <p block-type="TextInlineMath">
   for
   <math display="inline">
    t \in [0, T]
   </math>
   , where
   <i>
    W
   </i>
   is a standard Wiener process. The coefficient functions
   <math display="inline">
    a
   </math>
   and
   <math display="inline">
    b
   </math>
   are assumed to be sufficiently smooth, real valued, and such that a unique solution of equation (6) exists. Then, for a sufficiently smooth function
   <math display="inline">
    f: \Re \rightarrow \Re
   </math>
   , the Itô formula provides the representation
  </p>
  <p block-type="Equation">
   <math display="block">
    f(X_t) = f(X_0) + \int_0^t L^0 f(X_s) \, \mathrm{d}s
   </math>
   <math display="block">
    + \int_0^t L^1 f(X_s) \, \mathrm{d}W_s \tag{9}
   </math>
  </p>
  <p block-type="TextInlineMath">
   for
   <math display="inline">
    t \in [0, T]
   </math>
   , where we used the operators
   <math display="inline">
    L^0 =
   </math>
   <math display="inline">
    a\left(\frac{\partial}{\partial x}\right) + \frac{1}{2}b^2\left(\frac{\partial^2}{\partial x^2}\right)
   </math>
   and
   <math display="inline">
    L^1 = b\left(\frac{\partial}{\partial x}\right)
   </math>
   .
  </p>
  <p block-type="TextInlineMath">
   Obviously, for the special case
   <math display="inline">
    f(x) \equiv x
   </math>
   , we have
   <math display="inline">
    L^0 f = a
   </math>
   and
   <math display="inline">
    L^1 f = b
   </math>
   , for which the representation
   <math display="inline">
    (9)
   </math>
   reduces to equation
   <math display="inline">
    (8)
   </math>
   . Since the representation
   <math display="inline">
    (9)
   </math>
   involves integrands that are functions of processes, we can now apply the Itô formula (9) to the functions
   <math display="inline">
    a
   </math>
   and
   <math display="inline">
    b
   </math>
   in equation (8) to obtain
  </p>
  <p block-type="Equation">
   <math display="block">
    X_{t} = X_{0} + \int_{0}^{t} \left( a(X_{0}) + \int_{0}^{s} L^{0} a(X_{z}) \, \mathrm{d}z \right)
   </math>
   <br/>
   +
   <math display="block">
    \int_{0}^{s} L^{1} a(X_{z}) \, \mathrm{d}W_{z} \right) \, \mathrm{d}s + \int_{0}^{t} \left( b(X_{0}) + \int_{0}^{s} L^{0} b(X_{z}) \, \mathrm{d}W_{z} \right) \, \mathrm{d}W_{s} \, \mathrm{d}W_{s}
   </math>
   <br/>
   =
   <math display="block">
    X_{0} + a(X_{0}) \int_{0}^{t} \mathrm{d}s + b(X_{0}) \int_{0}^{t} \mathrm{d}W_{s} + R_{2} \qquad (10)
   </math>
  </p>
  <p block-type="Text">
   with remainder term
  </p>
  <p block-type="Equation">
   <math display="block">
    R_{2} = \int_{0}^{t} \int_{0}^{s} L^{0} a(X_{z}) \, \mathrm{d}z \, \mathrm{d}s
   </math>
   <br/>
   +
   <math display="block">
    \int_{0}^{t} \int_{0}^{s} L^{1} a(X_{z}) \, \mathrm{d}W_{z} \, \mathrm{d}s
   </math>
   <br/>
   +
   <math display="block">
    \int_{0}^{t} \int_{0}^{s} L^{0} b(X_{z}) \, \mathrm{d}z \, \mathrm{d}W_{s}
   </math>
   <br/>
   +
   <math display="block">
    \int_{0}^{t} \int_{0}^{s} L^{1} b(X_{z}) \, \mathrm{d}W_{z} \, \mathrm{d}W_{s} \qquad (11)
   </math>
  </p>
  <p block-type="Text">
   This already represents a simple example of a Wagner-Platen expansion. We can extend the above expansion by applying the Itô formula (9), for
  </p>
  <p block-type="Text">
   instance, to the function
   <math display="inline">
    L^1b
   </math>
   in the remainder. In this case, we obtain the expansion
  </p>
  <p block-type="Equation">
   <math display="block">
    X_{t} = X_{0} + a(X_{0}) \int_{0}^{t} \mathrm{d}s + b(X_{0}) \int_{0}^{t} \mathrm{d}W_{s}
   </math>
   <math display="block">
    + L^{1}b(X_{0}) \int_{0}^{t} \int_{0}^{s} \mathrm{d}W_{z} \mathrm{d}W_{s} + R_{3} \quad (12)
   </math>
  </p>
  <p block-type="TextInlineMath">
   with a new remainder
   <math display="inline">
    R_3
   </math>
   . In equation (12), the leading terms are functions of the value of the diffusion at the expansion point, which are weighted by corresponding multiple stochastic integrals. In principle, one can derive such an expansion for a general multifactor diffusion process
   <math display="inline">
    X
   </math>
   , a general smooth function
   <math display="inline">
    f
   </math>
   , and an arbitrary high expansion level (see
   <math display="inline">
    [6]
   </math>
   ). The main properties of this type of expansion are already apparent in the preceding example. The Wagner-Platen expansion can be interpreted as a generalization of both the Itô formula and the classical deterministic Taylor formula. It can be derived
   <i>
    via
   </i>
   an iterated application of the Itô formula.
  </p>
  <p block-type="Text">
   The following version of a Wagner-Platen expansion, involving triple integrals in the expansion part, can be useful in various applications:
  </p>
  <p block-type="Equation">
   <math display="block">
    X_{t} = X_{0} + a I_{(0)} + b I_{(1)} + (a a' + 1/2 b^{2} a'') I_{(0,0)}
   </math>
   <br/>
   +
   <math>
    (a b' + 1/2 b^{2} b'') I_{(0,1)} + b a' I_{(1,0)} + b b' I_{(1,1)}
   </math>
   <br/>
   +
   <math>
    [a (a a'' + (a')^{2} + b b' a'' + 1/2 b^{2} a'')
   </math>
   <br/>
   +
   <math>
    1/2 b^{2} (a a''' + 3 a' a'' + ((b')^{2} + b b'') a''
   </math>
   <br/>
   +
   <math>
    2 b b' a''') + 1/4 b^{4} a^{(4)}] I_{(0,0,0)}
   </math>
   <br/>
   +
   <math>
    [a (a'b' + a b'' + b b'b'' + 1/2 b^{2} b''')
   </math>
   <br/>
   +
   <math>
    1/2 b^{2} (a''b' + 2 a'b'' + a b''' + ((b')^{2} + b b'') b''
   </math>
   <br/>
   +
   <math>
    2 b b'b''' + 1/2 b^{2} b^{(4)})] I_{(0,0,1)} + [a (b'a' + b a'')
   </math>
   <br/>
   +
   <math>
    1/2 b^{2} (b''a' + 2 b'a'' + b a''')] I_{(0,1,0)}
   </math>
   <br/>
   +
   <math>
    [a ((b')^{2} + b b'') + 1/2 b^{2} (b''b' + 2 b b'' + b b'')'] I_{(0,1,1)} + b (a a'' + (a')^{2} + b b'a'' + 1/2 b^{2} a''')] I_{(1,0,0)} + b (a b'' + a'b' + b b'b'' + 1/2 b^{2} b'''') I_{(1,0,1)} + b (a b'' + a'b' + b b'b'' + 1/2 b^{2} b'''') I_{(1,0,1)} + b (a'b' + a''b) I_{(1,1,0)}
   </math>
   <br/>
   +
   <math>
    b ((b')^{2} + b b'') I_{(1,1,1)} + R_{6}
   </math>
   (13)
  </p>
  <p block-type="TextInlineMath" class="has-continuation">
   Here, the coefficient functions
   <math display="inline">
    a, b
   </math>
   , and their derivatives
   <math display="inline">
    a'
   </math>
   ,
   <math display="inline">
    b'
   </math>
   ,
   <math display="inline">
    a''
   </math>
   ,
   <math display="inline">
    b''
   </math>
   ,
   <math display="inline">
    a'''
   </math>
   ,
   <math display="inline">
    b'''
   </math>
   are valued at the
  </p>
  <p block-type="TextInlineMath">
   expansion point
   <math display="inline">
    X_0
   </math>
   , which we suppress in our notation. The multiple stochastic integrals
   <math display="inline">
    I_{(i_1, i_2, i_3)} =
   </math>
   <math display="inline">
    \int_0^t \int_0^s \int_0^z \mathrm{d} W_u^{j_1} \mathrm{d} W_z^{j_2} \mathrm{d} W_s^{j_3}
   </math>
   , where we set
   <math display="inline">
    \mathrm{d} W_t^0 = \mathrm{d} t
   </math>
   and
   <math display="inline">
    dW_t^1 = dW_t
   </math>
   , are taken on [0, t]. Important applications of Wagner-Platen expansions arise in the construction of strong and weak discrete time approximations for scenario simulation (see Stochastic Differential Equations: Scenario Simulation) and Monte Carlo simulation (see Monte Carlo Simulation for Stochastic Differential Equations). Detailed results for higher level stochastic Taylor expansions and derivations of estimates for the remainder can be found in [6].
  </p>
  <h3>
   <b>
    Generalized Wagner–Platen Expansions
   </b>
  </h3>
  <p block-type="Text">
   By following the same ideas, one can expand the changes of a function value with respect to the underlying diffusion process
   <math display="inline">
    X
   </math>
   itself. For example, from an iterated application of the Itô formula it follows for a sufficiently smooth function
   <math display="inline">
    f: [0, T] \times \mathbb{R} \to \mathbb{R}
   </math>
   an expansion of the form
  </p>
  <p block-type="Equation">
   <math display="block">
    f(t, X_{t}) = f(0, X_{0}) + \frac{\partial}{\partial t} f(0, X_{0}) t
   </math>
   <br/>
   <math display="block">
    + \frac{\partial}{\partial x} f(0, X_{0}) (X_{t} - X_{0})
   </math>
   <br/>
   <math display="block">
    + \frac{1}{2} \frac{\partial^{2}}{\partial x^{2}} f(0, X_{0}) \langle X \rangle_{t}
   </math>
   <br/>
   <math display="block">
    + \frac{\partial^{2}}{\partial x \partial t} f(0, X_{0}) \int_{0}^{t} \int_{0}^{s} dX_{z} ds
   </math>
   <br/>
   <math display="block">
    + \frac{1}{2} \frac{\partial^{2}}{\partial x^{2}} \frac{\partial}{\partial t} f(0, X_{0}) \int_{0}^{t} \int_{0}^{s} dX_{z} ds
   </math>
   <br/>
   <math display="block">
    + \frac{\partial^{2}}{\partial t \partial x} f(0, X_{0}) \int_{0}^{t} \int_{0}^{s} dZ_{z} dX_{s}
   </math>
   <br/>
   <math display="block">
    + \frac{\partial^{2}}{\partial x^{2}} f(0, X_{0}) \int_{0}^{t} \int_{0}^{s} dZ_{z} dX_{s}
   </math>
   <br/>
   <math display="block">
    + \frac{1}{2} \frac{\partial^{3}}{\partial x^{3}} f(0, X_{0}) \int_{0}^{t} \int_{0}^{s} dX_{z} dX_{s}
   </math>
   <br/>
   <math display="block">
    + \frac{1}{2} \frac{\partial^{3}}{\partial t \partial x^{3}} f(0, X_{0}) \int_{0}^{t} \int_{0}^{s} dZ_{z} dX_{s}
   </math>
   <br/>
   <math display="block">
    + \frac{1}{2} \frac{\partial^{3}}{\partial t \partial x^{3}} f(0, X_{0}) \int_{0}^{t} \int_{0}^{s} dZ_{z} dX_{s}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    +\frac{1}{4} \frac{\partial^4}{\partial x^4} f(0, X_0) \int_0^t \int_0^s \mathrm{d}\langle X \rangle_z \,\mathrm{d}\langle X \rangle_s
   </math>
   <math display="block">
    +\bar{R}_f(0, t) \tag{14}
   </math>
  </p>
  <p block-type="TextInlineMath">
   for
   <math display="inline">
    t \in [0, T]
   </math>
   , where
   <math display="inline">
    \bar{R}_f(0, t)
   </math>
   expresses the corresponding remainder term.
  </p>
  <p block-type="Text">
   There exist multidimensional versions of Wagner-Platen expansions with respect to several driving processes. By using such expansions, one can, for instance, expand the increment of an option price in a multifactor setting. This provides a better understanding of the sensitivities with respect to given factor processes. Another application is the approximate evaluation of risk measures, for instance, Value-at-
   <b>
    Risk
   </b>
   (see [12]).
  </p>
  <p block-type="Text">
   General stochastic Taylor expansions in a semimartingale setting have been derived in [8, 10]. Stochastic Taylor expansions based on multiple Stratonovich integrals are detailed in [5]. Wagner-Platen expansions for jump-diffusions and pure jump processes can be found in [3, 4, 9]. Expansions of functionals of Lévy processes
   <i>
    via
   </i>
   power processes have been described in
   <math display="inline">
    [7]
   </math>
   .
  </p>
  <h4>
   References
  </h4>
  <p block-type="ListGroup" class="has-continuation">
   <ul>
    <li block-type="ListItem">
     <math display="inline">
      [1]
     </math>
     Azencott, R. (1982). Stochastic Taylor formula and asymptotic expansion of Feynman integrals, Sèminaire de Probabilitès XVI, Supplement, Lecture Notes in Mathematics, Vol. 921, Springer, pp. 237-285.
    </li>
    <li block-type="ListItem">
     [2] BenArous, G. (1989). Flots et series de Taylor stochastiques, Probability Theory Related Fields 81, 29-77.
    </li>
    <li block-type="ListItem">
     [3] Bruti-Liberati, N. &amp; Platen, E. (2007). Strong approximations of stochastic differential equations with jumps, Journal of Computational and Applied Mathematics 205(2), 982-1001.
    </li>
    <li block-type="ListItem">
     Engel, D. (1982). The multiple stochastic integral, Mem-[4] oirs of the American Mathematical Society 38, 265.
    </li>
    <li block-type="ListItem">
     [5] Kloeden, P.E. &amp; Platen, E. (1991). Stratonovich and Itô stochastic Taylor expansions, Mathematische Nachrichten 151, 33-50.
    </li>
    <li block-type="ListItem">
     Kloeden, P.E. &amp; Platen, E. (1999). Numerical Solution of [6] Stochastic Differential Equations, Applied Mathematics, Vol. 23, Springer (Third Printing).
    </li>
    <li block-type="ListItem">
     Nualart, D. &amp; Schoutens, W. (2000). Chaotic and pre-[7] dictable representations for Lèvy processes, Stochastic Processes and Their Applications 90, 109–122.
    </li>
    <li block-type="ListItem">
     [8] Platen, E. (1981). A Taylor formula for semimartingales solving a stochastic differential equation, Stochastic Differential Systems, Lecture Notes in Control and Information Sciences, Vol. 36, Springer, pp. 157-164.
    </li>
   </ul>
  </p>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     [9] Platen, E. (1982). An approximation method for a class of Ito processes with jump component, ˆ
     <i>
      Lietuvos Matematikos Rinkinys
     </i>
     <b>
      22
     </b>
     (2), 124–136.
    </li>
    <li block-type="ListItem">
     [10] Platen, E. (1982). A generalized Taylor formula for solutions of stochastic differential equations,
     <i>
      Sankhya A
     </i>
     <b>
      44
     </b>
     (2), 163–172.
    </li>
    <li block-type="ListItem">
     [11] Platen, E. &amp; Wagner, W. (1982). On a Taylor formula for a class of Ito processes, ˆ
     <i>
      Probability and Mathematical Statistics
     </i>
     <b>
      3
     </b>
     (1), 37–51.
    </li>
    <li block-type="ListItem">
     [12] Schoutens, W. &amp; Studer, M. (2003). Short term risk management using stochastic Taylor expansions under Levy models, `
     <i>
      Insurance: Mathematics and Economics
     </i>
     <b>
      33
     </b>
     (1), 173–188.
    </li>
   </ul>
  </p>
  <h2>
   <b>
    Related Articles
   </b>
  </h2>
  <p block-type="Text">
   <b>
    Monte Carlo Simulation for Stochastic Differential Equations
   </b>
   ;
   <b>
    Stochastic Differential Equations: Scenario Simulation
   </b>
   ;
   <b>
    Stochastic Differential Equations with Jumps: Simulation
   </b>
   .
  </p>
  <p block-type="Text">
   ECKHARD PLATEN
  </p>
 </body>
</html>
