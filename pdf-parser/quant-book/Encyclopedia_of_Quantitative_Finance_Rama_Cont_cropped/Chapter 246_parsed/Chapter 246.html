<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
 </head>
 <body>
  <h1>
   <b>
    Fourier Transform
   </b>
  </h1>
  <h3>
   <b>
    Discrete Fourier Transform (DFT)
   </b>
  </h3>
  <p block-type="TextInlineMath">
   The
   <i>
    n
   </i>
   th root of unity is denoted by
   <math display="inline">
    z_n := \cos \frac{2\pi}{n} +
   </math>
   i sin
   <math display="inline">
    \frac{2\pi}{n} = e^{i\frac{2\pi}{n}}
   </math>
   . Geometrically, the numbers
   <math display="inline">
    z_n^j
   </math>
   , with
   <math display="inline">
    j = 0, \ldots, n-1
   </math>
   , represent
   <i>
    n
   </i>
   equidistantly spaced points on the unit circle in the complex plane. The point
   <math display="inline">
    z_n^{j+1}
   </math>
   is reached from
   <math display="inline">
    z_n^j
   </math>
   by turning
   <math display="inline">
    1/n
   </math>
   th of the full circle anticlockwise.
  </p>
  <p block-type="TextInlineMath">
   <b>
    Definition 1
   </b>
   Given an n-dimensional vector
   <math display="inline">
    a =
   </math>
   <math display="inline">
    [a_0, a_1, \ldots, a_{n-1}],
   </math>
   we say that
  </p>
  <p block-type="Equation">
   <math display="block">
    rev(a) := [a_0, a_{n-1}, \dots, a_1] \tag{1}
   </math>
  </p>
  <p block-type="Text">
   is a in reverse order. Intuitively, if a is written around the circle in the anticlockwise direction, then
   <math display="inline">
    rev(a)
   </math>
   is obtained by reading from
   <math display="inline">
    a_0
   </math>
   in the clockwise direction.
  </p>
  <p block-type="TextInlineMath">
   <b>
    Definition 2
   </b>
   The discrete Fourier transform (DFT) of
   <math display="inline">
    a = [a_0, a_1, \ldots, a_{n-1}] \in \mathbb{C}^n
   </math>
   is the vector
   <math display="inline">
    b =
   </math>
   <math display="inline">
    [b_0, b_1, \ldots, b_{n-1}] \in \mathbb{C}^n
   </math>
   such that
  </p>
  <p block-type="Equation">
   <math display="block">
    b_k = \frac{1}{\sqrt{n}} \sum_{j=0}^{n-1} a_j z_n^{jk} = \frac{1}{\sqrt{n}} \sum_{j=0}^{n-1} a_j e^{i\frac{2\pi}{n}jk} \qquad (2)
   </math>
  </p>
  <p block-type="Text">
   We write
  </p>
  <p block-type="Equation">
   <math display="block">
    b = \mathcal{F}(a) \tag{3}
   </math>
  </p>
  <p block-type="Text">
   Equation (2) represents the forward transform. The inverse transform is given by
  </p>
  <p block-type="Equation">
   <math display="block">
    a_{l} = \frac{1}{\sqrt{n}} \sum_{k=0}^{n-1} b_{k} z_{n}^{-kl} = \frac{1}{\sqrt{n}} \sum_{k=0}^{n-1} b_{k} e^{-i\frac{2\pi}{n} kl} \qquad (4)
   </math>
  </p>
  <p block-type="Text">
   and we write
  </p>
  <p block-type="Equation">
   <math display="block">
    a = \mathcal{F}^{-1}(b) \tag{5}
   </math>
  </p>
  <p block-type="Text">
   <b>
    Proposition 1
   </b>
   The following statements hold:
  </p>
  <p block-type="Text">
   1. The inverse
   <math display="inline">
    DFT
   </math>
   of sequence
   <math display="inline">
    b
   </math>
   is the same as the forward transform of the same sequence in the reverse order:
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathcal{F}^{-1}(b) = \mathcal{F}(\text{rev}(b)) \tag{6}
   </math>
  </p>
  <p block-type="Text">
   and vice versa
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathcal{F}^{-1}(\text{rev}(b)) = \mathcal{F}(b) \tag{7}
   </math>
  </p>
  <p block-type="Text">
   2.
   <math display="inline">
    \mathcal{F}^{-1}
   </math>
   is indeed an inverse transformation to
   <math display="inline">
    \mathcal{F}
   </math>
   . that is.
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathcal{F}^{-1}\left(\mathcal{F}(a)\right) = \mathcal{F}\left(\mathcal{F}^{-1}\left(a\right)\right) = a \qquad (8)
   </math>
  </p>
  <p block-type="Text">
   Next, we explain the relationship between binomial option pricing and the DFT.
  </p>
  <h2>
   <b>
    Binomial Option Pricing
   </b>
  </h2>
  <p block-type="Text">
   Consider a two-period binomial model (see
   <b>
    Binomial Tree
   </b>
   ) with a high rate of return of
   <math display="inline">
    25\%
   </math>
   and a low rate of return of
   <math display="inline">
    -20\%
   </math>
   . Assuming that the initial stock price is 100, the evolution of the stock price in the two periods ahead is given in Table 1.
  </p>
  <p block-type="Text">
   Suppose that we wish to price a call option struck at
   <math display="inline">
    K = 100
   </math>
   , maturing two periods from now. The risk-free rate is
   <math display="inline">
    0\%
   </math>
   . The intrinsic value of the option at maturity is
  </p>
  <p block-type="Equation">
   <math display="block">
    C(2, :) = \begin{bmatrix} 56.25 &amp; 0 &amp; 0 \end{bmatrix}^\top \tag{9}
   </math>
  </p>
  <p block-type="Text">
   As per the asset pricing theory, the no-arbitrage price of the option is given recursively as
  </p>
  <p block-type="Equation">
   <math display="block">
    C(t,j) = \frac{q_u C(t+1,j) + q_d C(t+1,j+1)}{R_f} \tag{10}
   </math>
  </p>
  <p block-type="Text">
   where the risk-neutral probabilities
   <math display="inline">
    q_u
   </math>
   and
   <math display="inline">
    q_d
   </math>
   satisfy
  </p>
  <p block-type="Equation">
   <math display="block">
    q_u = \frac{R_f - R_d}{R_u - R_d} = \frac{1 - 0.8}{1.25 - 0.8} = \frac{4}{9} \qquad (11)
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    q_d = 1 - q_u = \frac{5}{9} \tag{12}
   </math>
  </p>
  <p block-type="TextInlineMath">
   Here,
   <math display="inline">
    R_u = S(t + 1, j)/S(t, j)
   </math>
   ,
   <math display="inline">
    R_d = S(t + 1, j)
   </math>
   <math display="inline">
    (j+1)/S(t, j)
   </math>
   , and
   <math display="inline">
    R_f - 1
   </math>
   is equal to the risk-free rate. Recursive application of equation (10) with terminal value (9) leads to option prices as given in Table 2.
  </p>
  <h4>
   Option Pricing by Circular Convolution
  </h4>
  <p block-type="TextInlineMath">
   For any two
   <i>
    n
   </i>
   -dimensional vectors
   <math display="inline">
    a = [a_0, a_1, \ldots,
   </math>
   <math display="inline">
    a_{n-1}
   </math>
   and
   <math display="inline">
    b = [b_0, b_1, \ldots, b_{n-1}]
   </math>
   , we define
   <i>
    circular
   </i>
   <math display="inline">
    (cyclic)
   </math>
   convolution of
   <math display="inline">
    a
   </math>
   and
   <math display="inline">
    b
   </math>
   to be a new vector
   <math display="inline">
    c = [c_0, c_1, \ldots, c_{n-1}],
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    c = a \circledast b \tag{13}
   </math>
  </p>
  <table>
   <tbody>
    <tr>
     <th>
      Number of
      <br/>
      low returns
      <math>
       i
      </math>
     </th>
     <th>
      S(0, j)
     </th>
     <th>
      S(1, i)
     </th>
     <th>
      S(2, i)
     </th>
    </tr>
    <tr>
     <td>
     </td>
     <td>
      100
     </td>
     <td>
      125
     </td>
     <td>
      156.25
     </td>
    </tr>
    <tr>
     <td>
     </td>
     <td>
     </td>
     <td>
      80
     </td>
     <td>
      100
     </td>
    </tr>
    <tr>
     <td>
     </td>
     <td>
     </td>
     <td>
     </td>
     <td>
      64
     </td>
    </tr>
   </tbody>
  </table>
  <p>
   <b>
    Table 1
   </b>
   Binomial stock price lattice
  </p>
  <p>
   <b>
    Table 2
   </b>
   Option prices in a binomial lattice
  </p>
  <table>
   <tbody>
    <tr>
     <th>
      Number of
      <br/>
      low returns
      <math>
       i
      </math>
     </th>
     <th>
      C(0, i)
     </th>
     <th>
      C(1, i)
     </th>
     <th>
      C(2, j)
     </th>
    </tr>
    <tr>
     <td>
     </td>
     <td>
      <math>
       11\frac{1}{9}
      </math>
     </td>
     <td>
      25
     </td>
     <td>
      56.25
     </td>
    </tr>
    <tr>
     <td>
     </td>
     <td>
     </td>
     <td>
     </td>
     <td>
     </td>
    </tr>
    <tr>
     <td>
      2
     </td>
     <td>
     </td>
     <td>
     </td>
     <td>
     </td>
    </tr>
   </tbody>
  </table>
  <p block-type="Text">
   such that
  </p>
  <p block-type="Equation">
   <math display="block">
    c_j = \sum_{k+l=j \text{ or } k+l=j+n} a_k b_l \tag{14}
   </math>
  </p>
  <p block-type="Text">
   We use the binomial example to illustrate the use of circular convolution in option pricing. At maturity, the option has three values:
  </p>
  <p block-type="Equation">
   <math display="block">
    C(2, :) = \begin{bmatrix} 56.25 &amp; 0 &amp; 0 \end{bmatrix}^\top \tag{15}
   </math>
  </p>
  <p block-type="TextInlineMath">
   Let vector
   <math display="inline">
    q
   </math>
   contain the conditional one-period riskneutral probabilities
   <math display="inline">
    q_u = 0.43523
   </math>
   and
   <math display="inline">
    q_d = 0.56477
   </math>
   . Since there are just two states over one period the remaining entries will be padded by zeros:
  </p>
  <p block-type="Equation">
   <math display="block">
    q = \begin{bmatrix} q_u &amp; q_d &amp; 0 \end{bmatrix}^\top \tag{16}
   </math>
  </p>
  <p block-type="Text">
   To compute option prices at time
   <math display="inline">
    t = 1
   </math>
   , we evaluate
  </p>
  <p block-type="Equation">
   <math display="block">
    C(1,:) = C(2,:) \circledast \text{rev}(q)/R_{\text{f}} = [25 \quad 0 \quad 31.25]^\top
   </math>
   (17)
  </p>
  <p block-type="Text">
   Note that we need only the first two prices in equation
   <math display="inline">
    (17)
   </math>
   . The last entry is meaningless—it corresponds to the no-arbitrage price of the payoff [0 56.25]. Moving backward in time, we have
  </p>
  <p block-type="Equation">
   <math display="block">
    C(0, :) = C(1, :) \circledast \operatorname{rev}(q)/R_{\text{f}}
   </math>
   <br/>
   =
   <math>
    \left[ 11\frac{1}{9} \quad 17\frac{13}{36} \quad 27\frac{7}{9} \right]^{\top}
   </math>
   (18)
  </p>
  <p block-type="Text">
   Again, only the first entry is meaningful.
  </p>
  <p block-type="Text">
   This procedure can be generalized to multinomial lattices as follows.
  </p>
  <p block-type="TextInlineMath">
   Proposition 2 Consider an N-period model in which the random variables
   <math display="inline">
    S_{t+1}/S_t
   </math>
   are independent, identically distributed under the risk-neutral measure and such that
   <math display="inline">
    \ln S_{t+1}/S_t
   </math>
   takes k distinct, equidistantly spaced values with probabilities
   <math display="inline">
    q_1, \ldots, q_k
   </math>
   . Then stock price can be represented by a multinomial lattice with
   <math display="inline">
    1 + t(k - 1)
   </math>
   values at time t. Let
   <math display="inline">
    C(N, :) \in \mathbb{R}^n
   </math>
   ,
   <math display="inline">
    n = 1 + N(k - 1)
   </math>
   , be the payoff of a derivative asset as a function of
   <math display="inline">
    S_N
   </math>
   , and define riskneutral price of the option recursively by setting
  </p>
  <p block-type="Equation">
   <math display="block">
    C(t, j) = \sum_{l=1}^{k} q_l C(t+1, j+l-1),
   </math>
   <br/>
   <math display="block">
    1 \le l \le 1 + t(k-1)
   </math>
   (19)
  </p>
  <p block-type="TextInlineMath">
   Let q be a vector with first k entries
   <math display="inline">
    q_1, \ldots, q_k
   </math>
   and padded by zeros to dimension n. Then
   <math display="inline">
    C(t, :)
   </math>
   can also be obtained from the following formula:
  </p>
  <p block-type="Equation">
   <math display="block">
    C(t, :) = C(N, :) \circledast \overbrace{\operatorname{rev}(q) \circledast \operatorname{rev}(q)}^{(N-t)} \circledast \dots \circledast \operatorname{rev}(q)
   </math>
   (20)
  </p>
  <p block-type="TextInlineMath">
   The vector
   <math display="inline">
    C(t, :)
   </math>
   computed in this manner has more entries than required (n in total); the useful
   <math display="inline">
    1 + t(k -
   </math>
   1) entries are at the top end of the vector.
  </p>
  <h2>
   Pricing via Discrete Fourier Transform
  </h2>
  <p block-type="Text">
   In this section, we reformulate the circular pricing formula (20) using the DFT.
  </p>
  <p block-type="Text">
   <b>
    Proposition 3
   </b>
   Consider
   <math display="inline">
    a, b \in \mathbb{C}^n
   </math>
   . The following equalities hold:
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathcal{F}(a \circledast b) = \sqrt{n}\mathcal{F}(a)\,\mathcal{F}(b) \tag{21}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathcal{F}^{-1}\left(a\circledast b\right) = \sqrt{n}\mathcal{F}^{-1}\left(a\right)\mathcal{F}^{-1}\left(b\right) \qquad (22)
   </math>
  </p>
  <p block-type="Text" class="has-continuation">
   Now applying the inverse transform
   <math display="inline">
    \mathcal{F}^{-1}
   </math>
   to both sides of equation
   <math display="inline">
    (20)
   </math>
   and using property
   <math display="inline">
    (22)
   </math>
   on the
  </p>
  <p block-type="Text">
   right-hand side
  </p>
  <p block-type="Equation">
   <math display="block">
    \mathcal{F}^{-1} (C_0) = \mathcal{F}^{-1} (C_N)
   </math>
   <math display="block">
    \times \left( \sqrt{\text{dimension of } C_N} \mathcal{F}^{-1} (\text{rev}(q)) / R_{\text{f}} \right)^N (23)
   </math>
  </p>
  <p block-type="TextInlineMath">
   Recall from equation (7) that
   <math display="inline">
    \mathcal{F}^{-1}(\text{rev}(q)) = \mathcal{F}(q)
   </math>
   , and substitute this into equation (23). Finally, applying the forward transform to both sides again, and using equation
   <math display="inline">
    (8)
   </math>
   on the left-hand side, we obtain
  </p>
  <p block-type="Equation">
   <math display="block">
    C_{0} = \mathcal{F}\left(\mathcal{F}^{-1}\left(C_{N}\right)\right)
   </math>
   <math display="block">
    \times \left(\sqrt{\text{dimension of }C_{N}}\mathcal{F}\left(q\right)/R_{\text{f}}\right)^{N}\right) (24)
   </math>
  </p>
  <h1>
   <b>
    Fast Fourier Transform (FFT)
   </b>
  </h1>
  <p block-type="TextInlineMath">
   A naive implementation of the DFT algorithm with an
   <i>
    n
   </i>
   -dimensional input requires
   <math display="inline">
    n^2
   </math>
   complex multiplications. An efficient implementation of DFT, known as the
   <i>
    fast Fourier transform (FFT)
   </i>
   , will only require
   <math display="inline">
    Kn \ln n
   </math>
   operations, but one still has to choose
   <i>
    n
   </i>
   carefully because the constant
   <math display="inline">
    K
   </math>
   can be very large for some choices of
   <math display="inline">
    n
   </math>
   . There are many instances when FFT of length
   <math display="inline">
    n_1
   </math>
   is faster than FFT of length
   <math display="inline">
    n_2
   </math>
   even though
   <math display="inline">
    n_1 &gt; n_2
   </math>
   . This slightly counterintuitive phenomenon is illustrated in Table 3. In general, it is advisable to use the transform size of the form
   <math display="inline">
    n = 2^{p}3^{q}5^{r}
   </math>
   , where q and r should be small compared to
   <math display="inline">
    p
   </math>
   . In the context of option pricing, this is always possible by padding the payoff vector
   <math display="inline">
    C_N
   </math>
   with a sufficient number of zeros.
  </p>
  <p block-type="Text">
   An efficient implementation of FFT for all transform lengths is suggested in [17]. Efficient implementation of mixed
   <math display="inline">
    2, 3, 5
   </math>
   -radix algorithm is
  </p>
  <p>
   Table 3 Execution time of FFT algorithm for different input lengths
   <math display="inline">
    n
   </math>
  </p>
  <table>
   <tbody>
    <tr>
     <th>
      n
     </th>
     <th>
      Factorization
     </th>
     <th>
      Execution time
      <br/>
      (seconds)
     </th>
    </tr>
    <tr>
     <td>
      999983
     </td>
     <td>
      999983
     </td>
     <td>
      26.3
     </td>
    </tr>
    <tr>
     <td>
      2097 150
     </td>
     <td>
      <math>
       2 \times 3 \times 5^2 \times 11 \times 31 \times 41
      </math>
     </td>
     <td>
      1.4
     </td>
    </tr>
    <tr>
     <td>
      2097 152
     </td>
     <td>
      <math>
       \gamma^{21}
      </math>
     </td>
     <td>
      0.42
     </td>
    </tr>
    <tr>
     <td>
      2160 000
     </td>
     <td>
      <math>
       2^73^35^4
      </math>
     </td>
     <td>
      0.40
     </td>
    </tr>
    <tr>
     <td>
     </td>
     <td>
     </td>
     <td>
     </td>
    </tr>
   </tbody>
  </table>
  <p block-type="TextInlineMath">
   Intel Core 2, 2 GHz, 2Gb RAM, Matlab 6.5.
  </p>
  <p block-type="Text">
   due to Temperton [25]. Duhamel and Vetterli [15] survey a wide range of FFT algorithms. Fast implementation of equation (24) for Gauss and Matlab is discussed in [7].
  </p>
  <h1>
   FFT in Continuous-time Models
  </h1>
  <p block-type="TextInlineMath">
   In the continuous-time limit, the DFT is replaced by the (continuous) Fourier transform: that is, for a contingent claim with payoff
   <math display="inline">
    C_T = f(\ln S_T)
   </math>
   , we wish to find coefficients
   <math display="inline">
    \psi(v)
   </math>
   such that
  </p>
  <p block-type="Equation">
   <math display="block">
    f(x) = \int_{\beta - i\infty}^{\beta + i\infty} \psi(v) e^{vx} dv \qquad (25)
   </math>
  </p>
  <p block-type="TextInlineMath">
   for some real constant
   <math display="inline">
    \beta
   </math>
   [19]. The recipe for obtaining the coefficients
   <math display="inline">
    \psi(v)
   </math>
   is known—it is given by the inverse Fourier transform:
  </p>
  <p block-type="Equation">
   <math display="block">
    \psi(v) = \frac{1}{2\pi i} \int_{-\infty}^{+\infty} f(x) \mathrm{e}^{-vx} \, \mathrm{d}x \tag{26}
   </math>
  </p>
  <p block-type="TextInlineMath">
   For example, the payoff of a European call option with strike price
   <math display="inline">
    e^k
   </math>
   corresponds to
   <math display="inline">
    f(x) = (e^x
   </math>
   <math display="inline">
    e^{k}
   </math>
   &lt;sup&gt;+&lt;/sup&gt;, whereby, simple integration yields
  </p>
  <p block-type="Equation">
   <math display="block">
    \psi(v) = \frac{e^{(1-v)k}}{2\pi i v(v-1)} \text{ for } \text{Re}v &gt; 1 \qquad (27)
   </math>
  </p>
  <p block-type="Text">
   Substituting for
   <math display="inline">
    C_T
   </math>
   from equation (25) the riskneutral pricing formula reads
  </p>
  <p block-type="Equation">
   <math display="block">
    C_{0}(\ln S_{0}) = e^{-rT} \mathbb{E} \left[C_{T}(\ln S_{T})\right]
   </math>
   <br/>
   <math display="block">
    = e^{-rT} \mathbb{E} \left[\int_{\beta - i\infty}^{\beta + i\infty} \psi(v) e^{v \ln S_{T}} dv\right]
   </math>
   <br/>
   <math display="block">
    = e^{-rT} \int_{\beta - i\infty}^{\beta + i\infty} \psi(v) e^{v \ln S_{0}} \mathbb{E} \left[e^{v \ln S_{T}/S_{0}}\right] dv
   </math>
   <br/>
   (28)
  </p>
  <p block-type="TextInlineMath" class="has-continuation">
   In practice, one is mainly interested in models where the risk-neutral characteristic function of log stock return
   <math display="inline">
    \phi(-\mathrm{i}v) := \mathrm{E}[e^{v \ln S_T/S_0}]
   </math>
   is available in the closed form. This is the case in the class of exponential Lévy models with affine stochastic volatility process, discussed in [6] (see also Time-changed Lévy Process). This class contains a large number of popular models allowing for excess kurtosis, stochastic volatility, and leverage effects. It includes, among
  </p>
  <p block-type="Text">
   others, the stochastic volatility models of Heston [18] (see
   <b>
    Heston Model
   </b>
   ), Duffie
   <i>
    et al.
   </i>
   [14], and all exponential Lévy models (cf. [16, 23], see Exponential Lévy Models). For a detailed description of affine processes, see [13, 20].
  </p>
  <p block-type="Text">
   Option pricing, therefore, boils down to the evaluation of integrals of the type
  </p>
  <p block-type="Text">
   <math display="inline">
    C_0(\ln S_0)
   </math>
   <math display="inline">
    = S_0 e^{-rT} \int_{\beta - i\infty}^{\beta + i\infty} \frac{e^{(v-1)(\ln S_0 - k)}}{2\pi v (v-1)} \phi(-\mathrm{i} v) \, \mathrm{d} v
   </math>
   <math display="inline">
    =2S_0e^{-rT}\int_{\beta+i0}^{\beta+i\infty} \mathrm{Re}\left(\frac{e^{(v-1)(\ln S_0-k)}}{2\pi v(v-1)}\phi(-\mathrm{i}v)\right)\,\mathrm{d}v
   </math>
   <math display="inline">
    (29)
   </math>
  </p>
  <p block-type="TextInlineMath">
   where both
   <math display="inline">
    \psi(v)
   </math>
   and
   <math display="inline">
    \phi(v)
   </math>
   are known. To evaluate equation
   <math display="inline">
    (29)
   </math>
   , one truncates the integral at a high value of
   <math display="inline">
    \text{Im}v
   </math>
   and then uses a numerical quadrature to approximate it by a sum; see [22] for a detailed exposition. This yields an expression of the following type:
  </p>
  <p block-type="Equation">
   <math display="block">
    C_{0}(\ln S_{0}) \approx 2\text{Re}\left(S_{0}e^{-rT}\sum_{j=0}^{n-1}w_{j}\frac{e^{(v_{j}-1)(\ln S_{0}-k)}}{2\pi v_{j}(v_{j}-1)}\phi(-\mathrm{i}v_{j})\right)
   </math>
   (30)
  </p>
  <p block-type="Text">
   where the integration weights
   <math display="inline">
    w_i
   </math>
   and abscissas
   <math display="inline">
    v_i
   </math>
   depend on the quadrature rule. It is particularly convenient to use Newton-Cotes rules, which employ equidistantly spaced abscissas. For example, a trapezoidal rule yields
  </p>
  <p block-type="Equation">
   <math display="block">
    v_i = \beta + \mathrm{i}j\triangle v \tag{31}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \text{Im}v_{\text{max}} = (n-1)\triangle v \tag{32}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    w_0 = w_n = \frac{1}{2}\triangle v \tag{33}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    w_1 = w_2 = \dots = w_{n-1} = \triangle v \qquad (34)
   </math>
  </p>
  <p block-type="Text">
   In conclusion, if the characteristic function of log returns is known, one needs to evaluate a single sum
   <math display="inline">
    (30)
   </math>
   to find the option price. Consequently, there is no need to use FFT if one wishes to evaluate the option price for
   <i>
    one fixed
   </i>
   <math display="inline">
    \log
   </math>
   strike
   <math display="inline">
    k
   </math>
   .
  </p>
  <h3>
   FFT Option Pricing with Multiple Strikes
  </h3>
  <p block-type="TextInlineMath">
   The situation is different if we wish to evaluate the option price (30) for many different strikes simultaneously. Let us consider
   <math display="inline">
    m
   </math>
   values of moneyness
   <math display="inline">
    \kappa_l = \ln S_0 - k_l
   </math>
   , ranging from
   <math display="inline">
    \kappa_{\text{max}} - m \triangle \kappa
   </math>
   to
   <math display="inline">
    \kappa_{\text{max}}
   </math>
   with increment
   <math display="inline">
    \triangle \kappa
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    \kappa_l = \kappa_{\text{max}} - l \triangle \kappa \tag{35}
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    l = 0, \dots, m - 1 \tag{36}
   </math>
  </p>
  <p block-type="TextInlineMath">
   The idea of using FFT in this context is due to Carr and Madan [5], who noted that with equidistantly spaced abscissas (31) one can write the option pricing equation (30) for different strike values (35 and 36) as a z-transform with
   <math display="inline">
    z_l = e^{-i\Delta v \Delta \kappa l}
   </math>
   :
  </p>
  <p block-type="Equation">
   <math display="block">
    C_{0l} = 2S_0 e^{(\beta - 1)\kappa_l - rT} \operatorname{Re} \sum_{k=0}^{n-1} e^{i\Delta v \Delta \kappa kl} a_j \qquad (37)
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    a_j = w_j \frac{e^{ij\Delta v \kappa_{\text{max}}} \phi(-\mathrm{i} v_j)}{2\pi v_j (v_j - 1)}
   </math>
   (38)
  </p>
  <p block-type="TextInlineMath">
   Setting
   <math display="inline">
    \triangle v \triangle \kappa = \frac{2\pi}{n}
   </math>
   , Carr and Madan obtained a DFT in equation (37). Chourdakis [11] points out that one can evaluate equation
   <math display="inline">
    (37)
   </math>
   by means of a fractional FFT with
   <math display="inline">
    \triangle v \triangle \kappa \neq \frac{2\pi}{n}
   </math>
   . For the discussion of relative merits of the two strategies, see [7].
  </p>
  <h2>
   Further Reading
  </h2>
  <p block-type="Text">
   Further applications of FFT appear in
   <math display="inline">
    [1-4, 10, 12,
   </math>
   24]. For the latest developments in option pricing using (continuous) Fourier transform, see [6, 8, 9, 19, 21]. Proofs of Propositions 1 and 3 can be found in [7].
  </p>
  <h2>
   Acknowledgments
  </h2>
  <p block-type="Text">
   I am grateful to Peter Forsyth and Damien Lamberton for their helpful comments.
  </p>
  <h1>
   References
  </h1>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     Albanese, C., Jackson, K. &amp; Wiberg, P. (2004). A
     <math display="inline">
      [1]
     </math>
     new Fourier transform algorithm for value at risk, Quantitative Finance 4, 328-338.
    </li>
    <li block-type="ListItem">
     Andersen, L. &amp; Andreasen, J. (2000). Jump diffusion [2] processes: volatility smile fitting and numerical methods
    </li>
   </ul>
  </p>
  <p block-type="Text">
   for option pricing,
   <i>
    Review of Derivatives Research
   </i>
   <b>
    4
   </b>
   (3), 231–261.
  </p>
  <p block-type="ListGroup" class="has-continuation">
   <ul>
    <li block-type="ListItem">
     [3] Andreas, A., Engelmann, B., Schwendner, P. &amp; Wystup, U. (2002). Fast Fourier method for the valuation of options on several correlated currencies, in
     <i>
      Foreign Exchange Risk
     </i>
     , J. Hakala &amp; U. Wystup, eds, Risk Publications.
    </li>
    <li block-type="ListItem">
     [4] Benhamou, E. (2002). Fast Fourier transform for discrete Asian options,
     <i>
      Journal of Computational Finance
     </i>
     <b>
      6
     </b>
     (1), 49–68.
    </li>
    <li block-type="ListItem">
     [5] Carr, P. &amp; Madan, D.B. (1999). Option valuation using the fast Fourier transform,
     <i>
      Journal of Computational Finance
     </i>
     <b>
      2
     </b>
     , 61–73.
    </li>
    <li block-type="ListItem">
     [6] Carr, P. &amp; Wu, L. (2004). Time-changed Levy processes ´ and option pricing,
     <i>
      Journal of Financial Economics
     </i>
     <b>
      71
     </b>
     (1), 113–141.
    </li>
    <li block-type="ListItem">
     [7] Cern ˇ y, A. (2004). Introduction to FFT in finance, ´
     <i>
      Journal of Derivatives
     </i>
     <b>
      12
     </b>
     (1), 73–88.
    </li>
    <li block-type="ListItem">
     [8] Cern ˇ y, A. (2007). Optimal continuous-time hedging ´ with leptokurtic returns,
     <i>
      Mathematical Finance
     </i>
     <b>
      17
     </b>
     (2), 175–203.
    </li>
    <li block-type="ListItem">
     [9] Cern ˇ y, A. &amp; Kallsen, J. (2008). Mean–variance hedging ´ and optimal investment in Heston's model with correlation,
     <i>
      Mathematical Finance
     </i>
     <b>
      18
     </b>
     (3), 473–492.
    </li>
    <li block-type="ListItem">
     [10] Chiarella, C. &amp; El-Hassan, N. (1997). Evaluation of derivative security prices in the Heath-Jarrow-Morton framework as path integrals using fast Fourier transform techniques,
     <i>
      Journal of Financial Engineering
     </i>
     <b>
      6
     </b>
     (2), 121–147.
    </li>
    <li block-type="ListItem">
     [11] Chourdakis, K. (2004). Option pricing using the fractional FFT,
     <i>
      Journal of Computational Finance
     </i>
     <b>
      8
     </b>
     (2), 1–18.
    </li>
    <li block-type="ListItem">
     [12] Dempster, M.A.H. &amp; Hong, S.S.G. (2002). Spread option valuation and the fast Fourier transform, in
     <i>
      Mathematical Finance – Bachelier Congress 2000
     </i>
     , H. Geman, D. Madan, S.R. Pliska &amp; T. Vorst, eds, Springer, pp. 203–220.
    </li>
    <li block-type="ListItem">
     [13] Duffie, D., Filipovic, D. &amp; Schachermayer, W. (2003). ´ Affine processes and applications in finance,
     <i>
      The Annals of Applied Probability
     </i>
     <b>
      13
     </b>
     (3), 984–1053.
    </li>
    <li block-type="ListItem">
     [14] Duffie, D., Pan, J. &amp; Singleton, K. (2000). Transform analysis and asset pricing for affine jump diffusions,
     <i>
      Econometrica
     </i>
     <b>
      68
     </b>
     , 1343–1376.
    </li>
    <li block-type="ListItem">
     [15] Duhamel, P. &amp; Vetterli, M. (1990). Fast Fourier transforms: a tutorial review and a state of the art,
     <i>
      Signal Processing
     </i>
     <b>
      19
     </b>
     , 259–299.
    </li>
   </ul>
  </p>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     [16] Eberlein, E., Keller, U. &amp; Prause, K. (1998). New insights into smile, mispricing and value at risk: the hyperbolic model,
     <i>
      Journal of Business
     </i>
     <b>
      71
     </b>
     (3), 371–405.
    </li>
    <li block-type="ListItem">
     [17] Frigo, M. &amp; Johnson, S.G. (1998). FFTW: an adaptive software architecture for the FFT,
     <i>
      Proceedings of IEEE International Conference on Acoustics, Speech, and Signal Processing
     </i>
     , Seattle, WA, Vol. 3, pp. 1381–1384.
    </li>
    <li block-type="ListItem">
     [18] Heston, S. (1993). A closed-form solution for options with stochastic volatility with applications to bond and currency options,
     <i>
      Review of Financial Studies
     </i>
     <b>
      6
     </b>
     , 327–344.
    </li>
    <li block-type="ListItem">
     [19] Hubalek, F., Kallsen, J. &amp; Krawczyk, L. (2006). Variance-optimal hedging for processes with stationary independent increments,
     <i>
      The Annals of Applied Probability
     </i>
     <b>
      16
     </b>
     , 853–885.
    </li>
    <li block-type="ListItem">
     [20] Kallsen, J. (2006). A didactic note on affine stochastic volatility models, in
     <i>
      From Stochastic Calculus to Mathematical Finance: The Shiryaev Festschrift
     </i>
     , Y. Kabanov, R. Liptser &amp; J. Stoyanov, eds, Springer, Berlin, pp. 343–368.
    </li>
    <li block-type="ListItem">
     [21] Kallsen, J. &amp; Vierthauer, R. (2009). Variance-optimal hedging in affine stochastic volatility models,
     <i>
      Review of Derivatives Research
     </i>
     <b>
      12
     </b>
     (1), 3–27.
    </li>
    <li block-type="ListItem">
     [22] Lee, R.W. (2004). Option pricing by transform methods: extensions, unification and error control,
     <i>
      Journal of Computational Finance
     </i>
     <b>
      7
     </b>
     (3), 1–15.
    </li>
    <li block-type="ListItem">
     [23] Madan, D. &amp; Seneta, E. (1990). The variance gamma model for stock market returns,
     <i>
      Journal of Business
     </i>
     <b>
      63
     </b>
     (4), 511–524.
    </li>
    <li block-type="ListItem">
     [24] Rebonato, R. &amp; Cooper, I. (1998). Coupling backward induction with monte carlo simulations: a fast Fourier transform (FFT) approach,
     <i>
      Applied Mathematical Finance
     </i>
     <b>
      5
     </b>
     (2), 131–141.
    </li>
    <li block-type="ListItem">
     [25] Temperton, C. (1992). A generalized prime factor FFT algorithm for any
     <i>
      n
     </i>
     = 2
     <i>
      <sup>
       p
      </sup>
     </i>
     3
     <i>
      <sup>
       q
      </sup>
     </i>
     5
     <i>
      <sup>
       s
      </sup>
     </i>
     ,
     <i>
      SIAM Journal on Scientific and Statistical Computing
     </i>
     <b>
      13
     </b>
     , 676–686.
    </li>
   </ul>
  </p>
  <h1>
   <b>
    Related Articles
   </b>
  </h1>
  <p block-type="Text">
   <b>
    Exponential Levy Models ´
   </b>
   ;
   <b>
    Fourier Methods in Options Pricing
   </b>
   ;
   <b>
    Wavelet Galerkin Method
   </b>
   .
  </p>
  <p block-type="Text">
   ALESˇ Cˇ ERNY´
  </p>
 </body>
</html>
