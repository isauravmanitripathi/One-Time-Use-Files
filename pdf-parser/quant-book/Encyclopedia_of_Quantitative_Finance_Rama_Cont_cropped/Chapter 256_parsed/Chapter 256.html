<!DOCTYPE html>
<html>
 <head>
  <meta charset="utf-8"/>
 </head>
 <body>
  <h1>
   <b>
    Quadrature Methods
   </b>
  </h1>
  <p block-type="Text">
   Beyond the Black–Scholes equations [6] for European style options and certain other cases, generally with no early exercise, "numerical" techniques involving repetitive calculations are required in order to extract approximate solutions, which can be refined by further calculation to make them comparable in accuracy with analytic solutions. The numerical techniques are then classified as trees [18], various finite-difference methods following from the most basic explicit method [8], Monte Carlo simulation [7], and—introduced only recently—QUAD [4], each of which has been subject of modification and refinement.
  </p>
  <p block-type="Text">
   Quadrature
   <i>
    via
   </i>
   the QUAD method was first presented as a flexible, robust option pricing tool of wide applicability
   <i>
    via
   </i>
   cross-disciplinary work by the research group of Duck (mathematics) and Newton (finance), then at Manchester University [4]. Just as the mathematics of tree, finite-difference and Monte Carlo approaches were known and used in other areas, such as engineering and natural sciences, long before their introduction into finance; basic quadrature goes back centuries and is, in simple conversational terms, the calculation of an area under a graph
   <i>
    via
   </i>
   an approximation. Pictorially, this can be the splitting of an area into a series of shapes, such as rectangles, that approximate the total area and summing their individual areas. Taking smaller shapes produces more accurate results, converging on the correct one. For doing this, the well-known methods are the trapezium rule, Simpson's method, and Gaussian quadrature, and there are others as well. Each has differing properties and is more or less easy to program, but of particular interest is the rate of convergence to a correct solution as the number of calculations is increased in finer and finer approximations.
  </p>
  <p block-type="Text" class="has-continuation">
   A key concept in financial quadrature—sometimes not appreciated—is that the mathematical quadrature component is merely a computational engine to be chosen appropriately to fit into the wider calculations of the particular options problem [4, 5]. Thus, even the very simple trapezium rule can be adequate when elements in wider calculation are less refined. Similarly, Gaussian quadrature only provides useful extra speed over Simpson's rule in pricing problems where unusually heavy calculational
  </p>
  <p block-type="Text">
   demands on the "engine" are requisite. Details of quadrature schemes can be found in [1].
  </p>
  <p block-type="Text">
   It was well known for many years that the majority of options could be written as either a finite or an infinite set of nested (multiple) integrals. Geske and Johnson [20] valued the American put option using a set of multivariate integrals, and Huang
   <i>
    et al.
   </i>
   [25] and Sullivan [33] valued them using univariate integration at discrete observation points followed by Richardson extrapolation. The Geske and Johnson method, however, is computationally very time consuming when more than four nested (i.e., multiple) integrals have to be evaluated. Huang
   <i>
    et al.
   </i>
   used univariate integrals to achieve the same effect, but not more than three observation times were used due to computational complexity. Sullivan [33] also used univariate integrals using a Gaussian quadrature scheme. The first flexible, robust, and widely applicable option pricing tool in quadrature came with QUAD [4]. Its range has been extended to cover the most difficult problems in combination: path dependency, early exercise, and multiple underlyings [5]. In a parallel work, Broadie and Yamamoto [11, 12] have adapted the fast Gauss transform (FGT) technique of Greengard and Strain [21], which, like QUAD, omits time steps between exercise dates, thus vastly reducing the computational load.
  </p>
  <p block-type="Text" class="has-continuation">
   As with trees and finite-difference methods, QUAD works backward in time from the maturity of the option, in contrast to Monte Carlo that calculates forward. In the past, this tended to make the backward-working techniques the methods of choice when there could be early (American-style) exercise but favored Monte Carlo both for path-dependent options and for those with several underlyings, since although Monte Carlo starts by requiring a higher computational load than the other techniques (from averaging a large number of simulations), unlike the other techniques it does not suffer from the "curse of dimensionality", which raises their loads exponentially rather than linearly as dimensions are added. This lack of immediate ability to handle American-style options with Monte Carlo and a desire to tackle problems with both forward and backward elements lead to improvements in all the techniques, with the result that they now compete as alternatives across the spectrum of options types. Since the work of Longstaff and Schwartz [28], in particular, Monte Carlo has been able to handle early exercise (
   <i>
    see
   </i>
   <b>
    Bermudan Options
   </b>
   ). In mathematics,
  </p>
  <p block-type="Text">
   where "high dimension" can mean that a large number of dimensions are of interest, Monte Carlo may become the only technique of concern; however, in finance five dimensions can be considered large. Moreover, quadrature-based methods are so fast to converge that they may only be overtaken in speed by Monte Carlo in dimensions above five (clearly depending on which two quadrature and Monte Carlo techniques are compared; see below for more on this).
  </p>
  <p block-type="Text">
   QUAD is a particularly effective tool because of the way it deals with the two fundamental causes of error in the numerical methods for finance: distribution error and nonlinearity error. The distribution error arises from approximating a continuous distribution with a discrete one and in other methods can be reduced by adding more steps to a lattice or grid to improve the approximation. This, however, adds to the computational load, whereas with QUAD no calculations are needed at time steps between exercise dates which, combined with the well-known high accuracy of quadrature methods in approximating integrals of functions, results in a huge advantage (measured in orders of magnitude). An extreme example is a plain European option which, if valued numerically not analytically, would require just one set of QUAD calculations in moving from maturity to valuation, with no intermediate steps.
  </p>
  <p block-type="Text">
   Nonlinearity error is dealt with by the flexibility in placing calculational nodes so as not to miss nonsmooth changes (the simplest example being the kink in payoff for a plain European option). Nonlinearity error is observed when valuing options using lattice methods (such as binomial and trinomial trees) or grid methods (notably finite-difference techniques). The familiar saw tooth shape observed in plots of the error with varying time steps when pricing options with binomial trees is directly the result of a nonlinearity in the option price for certain values of the underlying [9, 14, 15, 19, 27, 31, 36]. Extrapolation procedures are possible only when nonlinearity error has been removed. For products such as European vanilla and continuous barrier options, the lattice or the grid can be adapted to remove this nonlinearity error, the main advantage of which is to provide smooth, monotonically converging results that can be improved significantly by standard extrapolation procedures. For options containing more and more exotic features, it becomes increasingly difficult, if not impossible, to adjust the lattice or the grid to
  </p>
  <p block-type="Text">
   remove new sources of nonlinearity error: for example, options in which the source of nonlinearity moves with time as in barrier or American-style options.
  </p>
  <p block-type="TextInlineMath">
   The QUAD method improves on lattice and grid methods in two important ways: superior convergence and, most important, far greater flexibility. The convergence of the method is dependent on which underlying quadrature scheme is used; with Simpson's rule the convergence is with 1/
   <i>
    N
   </i>
   4, where
   <i>
    N
   </i>
   is the number of steps, that is,
   <i>
    N
   </i>
   = 1
   <i>
    /h
   </i>
   , with
   <i>
    h
   </i>
   being the quadrature mesh size of steps (contrast 1/
   <i>
    N
   </i>
   <sup>
    1
   </sup>
   <i>
    /
   </i>
   <sup>
    2
   </sup>
   for the Monte Carlo method). This, combined with its flexibility, makes the improvement offered significant for many types of options. Using the QUAD method with one underlying and either one or two discontinuities at any time, the grid can be maneuvered so as to remove all nonlinearity error, leaving only distribution error and providing monotonic, smooth, fast convergence. These results can then be extrapolated, providing remarkably accurate results rapidly.
  </p>
  <p block-type="Text">
   One significant problem with lattice and grid methods is what is dubbed the curse of dimensionality; as more underlying assets are introduced, computation time increases exponentially. The usual alternative is to solve by means of Monte Carlo methods, for which the computational effort increases only linearly as more underlying assets are added. For a single underlying asset, Monte Carlo methods are inferior to lattice and grid methods because of slow convergence, but as more underlying assets are considered, Monte Carlo methods can take over as the preferred technique; however, as we shall see, this is not the case with QUAD, which retains its considerable speed/accuracy advantage across the gamut of practical options problems.
  </p>
  <p block-type="TextInlineMath" class="has-continuation">
   To quantify the trade-off between dimensions and convergence, Broadie and Glasserman [10] express convergence as a function of computational effort or work. Under this measure, for an
   <i>
    n
   </i>
   -underlying asset option pricing problem, lattice or explicit finite-difference methods (
   <i>
    see
   </i>
   <b>
    Finite Difference Methods for Barrier Options
   </b>
   ) have convergence rates of
   <i>
    O
   </i>
   (work
   <sup>
    −
   </sup>
   1
   <i>
    /(n
   </i>
   +1
   <i>
    )
   </i>
   ), the Crank–Nicolson finite-difference method (
   <i>
    see
   </i>
   <b>
    Crank–Nicolson Scheme
   </b>
   ) has
   <i>
    O
   </i>
   (work
   <sup>
    −
   </sup>
   2
   <i>
    /(n
   </i>
   +1
   <i>
    )
   </i>
   ), whereas Monte Carlo methods (
   <i>
    see
   </i>
   <b>
    Monte Carlo Simulation
   </b>
   ), because of the linear increase in effort, exhibit
   <i>
    O
   </i>
   (work
   <sup>
    −
   </sup>
   1
   <i>
    /
   </i>
   2) convergence. Where time stepping is required (e.g., for Bermudan options), under this metric, the QUAD method when using
  </p>
  <p block-type="TextInlineMath">
   unextrapolated Simpson's rule has
   <i>
    O
   </i>
   (work
   <sup>
    −
   </sup>
   4
   <i>
    /(n
   </i>
   +1
   <i>
    )
   </i>
   ) convergence, increasing to
   <i>
    O
   </i>
   (work
   <sup>
    −
   </sup>
   8
   <i>
    /(n
   </i>
   +1
   <i>
    )
   </i>
   ) when extrapolation is employed. Andricopoulos
   <i>
    et al.
   </i>
   [5] have compared QUAD in a deliberately unfavorable circumstance with [28] Monte Carlo on multiple underlyings for American options (where QUAD is naturally slowed by more exercise times, Bermudanstyle, followed by extrapolation) and found that QUAD still has an advantage with five underlyings, thus covering most cases in practical finance.
  </p>
  <h2>
   <b>
    Extending the Method
   </b>
  </h2>
  <p block-type="Text">
   The fast convergence of QUAD is partly due to the careful placing of nodes in the calculations. For example, the payoff conditions at an option's maturity show a break in the direction, and nodes are correctly placed so as not to calculate across the break, which would lead to propagation of errors. This does mean that some appreciation of the "geometry" of solution is necessary in each problem in order to attain the highest accuracy. This is, perhaps, not a great difficulty (and careful placement of nodes for improved accuracy is a general feature of all the lattice and grid methods); nevertheless, it is useful that the degradation of results through programming roughly, without care for node placement, can still give adequate results in a quickly programmed exploratory setup [13]. For convenience, a hybrid QUAD finite-difference approach was used by Law [26] for the case of "arithmetic Asian tail" options—a reminder that methods can be mixed.
  </p>
  <p block-type="Text">
   The foundation work for QUAD was presented in the Black–Scholes framework but this method applies whenever the conditional probability density function is known. This restricts the immediate use of the QUAD technique to the Black–Scholes setup, to Merton's jump-diffusion model (
   <i>
    see
   </i>
   <b>
    Jump-diffusion Models
   </b>
   ), and to certain interest-rate models such as those of Vasicek [34] and Cox
   <i>
    et al.
   </i>
   [17] (
   <i>
    see
   </i>
   <b>
    Term Structure Models
   </b>
   ). Extending the technique to Merton's process is straightforward, but the interestrate models are more subtle and Heap [23] has successfully extended the coverage to interest-rate derivatives including these mean-reverting underlying processes.
  </p>
  <p block-type="Text" class="has-continuation">
   A notable advance was made by O'Sullivan [30], who used the observation that many useful processes that do not have a well-known density function
  </p>
  <p block-type="Text">
   do nonetheless have a well-understood characteristic function. The density function, as the inverse Fourier transform of the characteristic function, can be computed using fast Fourier transform and the output may then be inserted in the QUAD scheme to price derivatives. We refer to this method as
   <i>
    FFT-QUAD
   </i>
   . O'Sullivan's method applies in particular to exponential Levy processes. This made FFT-QUAD an important advance, but it does suffer from drawbacks [22]. First, it requires two integrations even for a derivative on a single underlying process. This brings the complexity of the algorithm to at least
   <i>
    O(N
   </i>
   <sup>
    2
   </sup>
   <i>
    )
   </i>
   , where
   <i>
    N
   </i>
   is the number of grid points used in the numerical integrations; by comparison, the original QUAD had a much better complexity of just
   <i>
    O(N )
   </i>
   for vanilla options. Second, FFT-QUAD cannot be used to price heavily path-dependent options in stochastic volatility frameworks, since it does not keep track of the evolution of the volatility process in moving from one observation point to the next.
  </p>
  <p block-type="Text">
   O'Sullivan's FFT-QUAD was considerably improved by the CONV technique of Lord
   <i>
    et al.
   </i>
   [29] (
   <i>
    see also
   </i>
   <b>
    Fourier Methods in Options Pricing
   </b>
   ). We refer to this method as
   <i>
    CONV-QUAD
   </i>
   [32]. This excellent method uses the observation that the basic pricing integral may usually be regarded as the convolution (strictly speaking, the cross correlation) of the payoff and the density function. The beauty of this insight is that the two integrals of FFT-QUAD may then be replaced by two fast Fourier transforms. This brings the complexity of the algorithm down to
   <i>
    O(N
   </i>
   log
   <i>
    (N ))
   </i>
   and, for example, for Bermudan options (on
   <i>
    M
   </i>
   observation points), the complexity remains at
   <i>
    O(MN
   </i>
   log
   <i>
    (N ))
   </i>
   , which beats even QUAD's
   <i>
    O(MN
   </i>
   <sup>
    2
   </sup>
   <i>
    )
   </i>
   . The CONV method applies in particular to exponential Levy processes (
   <i>
    see
   </i>
   <b>
    Exponential Levy Models ´
   </b>
   ) and hence in particular to CGMY processes (
   <i>
    see
   </i>
   <b>
    Tempered Stable Process
   </b>
   ). Owing to its nearly linear speed, it is clearly the method of choice for a great many processes. CONV-QUAD, however, suffers from the same difficulty of application to stochastic volatility processes: the volatility process is ignored again. Moreover, there is no possibility of treating, say, Heston's processes [24] (
   <i>
    see also
   </i>
   <b>
    Heston Model
   </b>
   ) by a two-dimensional CONV-QUAD; the volatility component is simply not sufficiently well behaved.
  </p>
  <p block-type="Text" class="has-continuation">
   In summary thus far, we have, in various forms of QUAD, a remarkably accurate (fast-converging) technique that covers complex combinations of option
  </p>
  <p block-type="Text">
   characteristics in multiple dimensions. It outperforms other methods in most circumstances, making it the method of choice in situations when this power is needed and is a convenient alternative to trees, finitedifference grids, and Monte Carlo among others. There remains, however, some further development underway in order to complete the universality of QUAD: full coverage of underlying processes, particularly stochastic volatility and Heston's framework [24]. This appears possible
   <i>
    via
   </i>
   the basic QUAD scheme, reducing complexity via CONV-OUAD techniques when possible. When pricing, say, Bermudan options, complexity will grow linearly, not exponentially, with the number of observation points, that is, with
   <math display="inline">
    B
   </math>
   observation points, the overall complexity will be
   <math display="inline">
    O(BM^2N \log(N))
   </math>
   . This complexity is worse than what CONV can produce in other cases, but it is necessary to keep track of an extra process, and some extra penalty is to be expected as CONV-QUAD techniques cannot be used on the volatility component [22].
  </p>
  <h4>
   <b>
    QUAD Mathematics
   </b>
  </h4>
  <p block-type="TextInlineMath">
   We now proceed to a demonstration of the basic technique for QUAD. The original description of the OUAD method can be found in detail in [3] and in overview in [5]. Starting with the well-known [6] partial differential equation for an option with an underlying asset following geometric Brownian motion (see Black-Scholes Formula):
  </p>
  <p block-type="Equation">
   <math display="block">
    \frac{\partial V}{\partial t} + \frac{1}{2}\sigma^2 S^2 \frac{\partial^2 V}{\partial S^2} + (r - D_c)S \frac{\partial V}{\partial S} - rV = 0 \quad (1)
   </math>
  </p>
  <p block-type="TextInlineMath">
   where
   <math display="inline">
    V
   </math>
   is the price of the derivative product and is a function of
   <math display="inline">
    S
   </math>
   , the value of the underlying asset and time,
   <math display="inline">
    t
   </math>
   . The risk-free interest rate is
   <math display="inline">
    r
   </math>
   , the volatility of the underlying asset is
   <math display="inline">
    \sigma
   </math>
   , and the exercise price is
   <math display="inline">
    X. D_c
   </math>
   is a continuous dividend yield. A convenient log transform may be made:
  </p>
  <p block-type="Equation">
   <math display="block">
    x = \log(S) \tag{2}
   </math>
  </p>
  <p block-type="TextInlineMath" class="has-continuation">
   Then suppose that
   <math display="inline">
    y
   </math>
   is the corresponding value of the transform of the underlying at time
   <math display="inline">
    t + \Delta t
   </math>
   , where
   <math display="inline">
    \Delta t
   </math>
   is a time step. It is important to note that
   <math display="inline">
    \Delta t
   </math>
   is not restricted to small time periods; for example, were QUAD has to be applied to a plain European call option (this is not required since we have the
  </p>
  <p block-type="TextInlineMath">
   Black-Scholes analytic solution), then the complete time to expiry would be taken in a single time step,
   <math display="inline">
    \Delta t
   </math>
   . At expiry, the final condition (payoff) becomes
   <math display="inline">
    \max(e^y - X, 0)
   </math>
   . The solution for the value of the option at time
   <math display="inline">
    t
   </math>
   on an underlying asset
   <math display="inline">
    S
   </math>
   is then
  </p>
  <p block-type="Equation">
   <math display="block">
    V(x,t) = A(x) \int_{-\infty}^{\infty} B(x,y)V(y,t+\Delta t) \, \mathrm{d}y \quad (3)
   </math>
  </p>
  <p block-type="Text">
   where
  </p>
  <p block-type="Equation">
   <math display="block">
    A(x) = \frac{1}{\sqrt{2\sigma^2\pi\,\Delta t}} e^{-(kx/2) - (\sigma^2 k^2 \Delta t/8) - r\,\Delta t} \quad (4)
   </math>
  </p>
  <p block-type="Equation">
   <math display="block">
    B(x, y) = e^{-((x-y)^2/(2\sigma^2 \Delta t)) + (ky/2)}
   </math>
   (5)
  </p>
  <p block-type="Equation">
   <math display="block">
    k = \frac{2(r - D)}{\sigma^2} - 1\tag{6}
   </math>
  </p>
  <p block-type="Text">
   for a plain vanilla call, for example, the integrand becomes
  </p>
  <p block-type="Equation">
   <math display="block">
    f(x, y) = B(x, y) \times \max(e^{y} - 1, 0) \tag{7}
   </math>
  </p>
  <p block-type="Text" class="has-continuation">
   This integral is the key. Next, any of the many quadrature methods can be employed as a valuation "engine" for what is a European option with known payoff. The integration covers a single time step,
   <math display="inline">
    \Delta t
   </math>
   . As already noted, this is not of any special use for a plain European option; the (considerable) advantage comes from treating more complex and interesting options problems as equivalent to series of European options. Regions where there is no boundary condition to deal with can be jumped in a single step. Contrast this with other techniques, such as finite difference or trees, in which many intermediate calculations are employed (though there are techniques for thinning the grids/trees). Once more complex option features are incorporated, the choice of quadrature "engine" becomes more important. The speed of convergence comes from a combination of the calculations required for the quadrature "engine" and the calculations arising from particular option features (boundary conditions). A faster engine is needed only in some cases in order to attain the required speed and accuracy. Andricopoulos [3] originally considered the trapezium rule, Simpson's method, and Gaussian quadrature. From the exceedingly simple technique of the trapezium rule, familiar in schoolrooms, through to Gaussian Quadrature, these three are progressively more accurate (fast converging). At the extreme end of fast "engines", the superior convergence of the Gauss-Legendre method of Sullivan [33] used within
  </p>
  <p block-type="Text">
   QUAD has been subject to detailed examination by Chung et al. [16].
  </p>
  <p block-type="TextInlineMath">
   Note that the range of integration is infinite, but this is not a practical problem; the range can be truncated, provided the integrand outside the truncated range is suitably small. Highly accurate calculations are then possible to any level required. A vanilla call option has a discontinuity in the first derivative at expiry, where
   <math display="inline">
    S = X
   </math>
   or
   <math display="inline">
    y = \log(X)
   </math>
   . Integration is needed from
   <math display="inline">
    log(X)
   </math>
   and above, with a frequency of quadrature points and a cutoff to suit the desired accuracy. Extension to options observed discretely
   <i>
    M
   </i>
   times
   <math display="inline">
    (T_1; \ldots; T_M
   </math>
   with the current time
   <math display="inline">
    T_0
   </math>
   and expiry
   <math display="inline">
    T_M
   </math>
   ) is made possible by splitting the option into
   <i>
    M
   </i>
   separate options,
   <math display="inline">
    V_m
   </math>
   . Each option,
   <math display="inline">
    V_m
   </math>
   , runs from
   <math display="inline">
    T_{m-1}
   </math>
   to
   <math display="inline">
    T_m
   </math>
   . The values at expiry (time
   <math display="inline">
    T_M
   </math>
   ) are simply the option payoff. The values of the option at
   <math display="inline">
    T_{m-1}
   </math>
   can be found for all values of y required by the quadrature routine at
   <math display="inline">
    T_M
   </math>
   . American exercise is readily handled by a combination of extra observation times and extrapolation. Any additional operations, such as the imposition of a barrier, can be performed on these values and then these can be used to value the option at time
   <math display="inline">
    T_{m-2}
   </math>
   . The process is continued until the option value is found at the present time,
   <math display="inline">
    T_0
   </math>
   .
  </p>
  <p block-type="TextInlineMath">
   Regarding truncation, for the logarithm of an underlying asset,
   <math display="inline">
    log(S)
   </math>
   , the probability of moving more than five standard deviations in any time period is negligible and truncation to this range typically affects, at worst, only the fifth significant figure of the option price. The probability of moving more than 10 standard deviations is so small that truncating to this range is comparable to machine accuracy on a computer (note that this is important in attaining machine accuracy rather than specifically the choice of quadrature technique supposed in [16]). The choice of range,
   <math display="inline">
    \xi
   </math>
   (the number of standard deviations of the range of integration), is left to the practitioner, but it should be somewhere between these bounds, 5 and 10. The value 7.5 is generally good because it is accurate enough, yet it does not affect extrapolation and does not render the computational effort prohibitively high. For an option valued at time
   <math display="inline">
    T_m
   </math>
   , the range in y, [
   <math display="inline">
    y^{\min}
   </math>
   ;
   <math display="inline">
    y^{\max}
   </math>
   ] used is
  </p>
  <p block-type="Equation">
   <math display="block">
    y^{\min} = x - \xi \sqrt{T_m - T_{m-1}} \tag{8}
   </math>
  </p>
  <p block-type="Text">
   and
  </p>
  <p block-type="Equation">
   <math display="block">
    y^{\min} = x + \xi \sqrt{T_m - T_{m-1}} \tag{9}
   </math>
  </p>
  <p block-type="TextInlineMath">
   If the QUAD grid is constructed to coincide with the discontinuities such as a strike price, barrier, or exercise boundary, then convergence is perfectly smooth and suitable for improvement through extrapolation because only distribution error remains. It is useful because it is so smooth that extrapolated results can often be further extrapolated themselves. This extrapolation is applicable in all cases, including those with early exercise (but see [5], for adaptive quadrature). Extrapolation is straightforward, via a simple Richardson-type procedure. If results converge at a known rate
   <math display="inline">
    (\delta y)^d
   </math>
   , then consider two calculations undertaken with step sizes,
   <math display="inline">
    \delta y_1
   </math>
   and
   <math display="inline">
    \delta y_2
   </math>
   , producing option values
   <math display="inline">
    V_1
   </math>
   and
   <math display="inline">
    V_2
   </math>
   , respectively. An improved value
   <math display="inline">
    V_{\text{ext}}
   </math>
   is given as
  </p>
  <p block-type="Equation">
   <math display="block">
    V_{\text{ext}} = \frac{(\delta y_1)^d V_2 - (\delta y_2)^d V_1}{(\delta y_1)^d - (\delta y_2)^d} \tag{10}
   </math>
  </p>
  <p block-type="TextInlineMath">
   Assuming that the discontinuities are correctly located, the extrapolated trapezium rule results converge as
   <math display="inline">
    (\delta y)^4
   </math>
   , which is
   <math display="inline">
    1/N^4
   </math>
   . For Simpson's rule, the extrapolated results converge as
   <math display="inline">
    (\delta y)^8
   </math>
   , which is
   <math display="inline">
    1/N^8
   </math>
   , a remarkable rate of convergence compared with other methods. For comparison, a trinomial tree converges merely with
   <math display="inline">
    N^{-1}
   </math>
   or in some cases only with
   <math display="inline">
    N^{-1/2}
   </math>
   . Even the more sophisticated finite-difference methods at best converge at the rate of
   <math display="inline">
    (\Delta S^2, \Delta t^2)
   </math>
   , where
   <math display="inline">
    \Delta S
   </math>
   and
   <math display="inline">
    \Delta t
   </math>
   are the step sizes in the S and the
   <math display="inline">
    t
   </math>
   directions, respectively.
  </p>
  <p block-type="TextInlineMath">
   Simpson's rule remains one of the most accurate and popular methods for approximating integrals. For a function of y,
   <math display="inline">
    f(y)
   </math>
   , plotted against t, y divides the desired range,
   <math display="inline">
    [a_1, a_2]
   </math>
   into
   <i>
    n
   </i>
   intervals of a fixed length
   <math display="inline">
    \delta y
   </math>
   such that
   <math display="inline">
    n\delta y = a_2 - a_1
   </math>
   . Then approximate the area under the curve by summing the area of the individual regions. This yields the following expression:
  </p>
  <p block-type="Equation">
   <math display="block">
    \int_{a_1}^{a_2} f(y) \, \mathrm{d}y \approx \frac{\delta y}{6} \left\{ f(a_1) + 4f\left(a_1 + \frac{1}{2}\delta y\right) \right.
   </math>
   <math display="block">
    \left. + 2f(a_1 + \delta y) + 4f\left(a_1 + \frac{3}{2}\delta y\right) \right.
   </math>
   <math display="block">
    \left. + 2f(a_1 + 2\delta y) + \dots + 2f(a_2 - \delta y) \right\}
   </math>
   <math display="block">
    \left. + 4f\left(a_2 - \frac{1}{2}\delta y\right) + f(a_2) \right\} \tag{11}
   </math>
  </p>
  <p block-type="Text" class="has-continuation">
   It is easily shown that, for smooth functions, the error term associated with this method decreases
  </p>
  <p block-type="TextInlineMath">
   at a rate of order
   <i>
    (δy)
   </i>
   <sup>
    4
   </sup>
   and so a doubling of the number of steps reduces the error by a factor of 16. Here, it is useful to reiterate the analogy of quadrature techniques as merely "engines" to be fitted into the bodywork of QUAD. When pricing options for which the overall valuation technique puts other, more stringent, limitations on convergence, very basic quadrature may be appropriate. For example, the trapezium rule is an even simpler quadrature method, slower to converge than Simpson's rule, at a rate of
   <i>
    (δy)
   </i>
   2, but in rare cases its use can save computational time, as in the case of lookback options priced in three dimensions, where the use of more accurate quadrature schemes would be superfluous. QUAD benchmarks may be found in [3, 35].
  </p>
  <h3>
   <b>
    Speed and Accuracy
   </b>
  </h3>
  <p block-type="Text">
   For once-only calculations under no research or business time constraint, options valuations are now usually accessible
   <i>
    via
   </i>
   more than one technique; however, there remain some difficult or high-volume repetitive requirements for fast and accurate answers and for these QUAD competes across all option types. For a once-only calculation, it does not probably matter at all whether the chosen technique delivers acceptable accuracy in 10 ms or 10 min for a moderately simple problem, but this difference becomes compounded with the hardest problems and with large numbers of repeat calculations. Thus, speed and convergence results quoting such differences in research papers are of particular interest; a doubling of computer speed, say, since publication, is of less interest than the relative benchmarking. The original QUAD results were computed on a Pentium III 550 MHz system, using the NAG Fortran 95 v4.0 compiler with optimization [4], later on a 2.4 GHz Pentium computer, approximately four times faster [5]. Even given the current faster computers and projected speed increases for the next several years, the practical convergence/accuracy gains for many options problems remain exceptional, generally measurable in several orders of magnitude. Pricing to penny accuracy with a trinomial tree (mathematically similar to an explicit finite difference) takes hours, if not days, for some options (e.g., a lookback barrier) but they are priced correct to four decimal places in seconds with QUAD on the outdated Pentium III. In the valuation of a three-underlying American call option, QUAD
  </p>
  <p block-type="Text">
   achieves penny accuracy in just over a minute, which is a level of accuracy not achieved by the explicit finite-difference method in over 85 min. For European options on two and three underlyings, QUAD exhibits a huge improvement upon Monte Carlo and finitedifference schemes. For two underlyings, the accuracy after 0.01 s is an order of magnitude better than that with Monte Carlo (the next best method) after 21 s. For three underlyings, QUAD is more accurate after 0.04 s than Monte Carlo is after 35 s. By five underlyings, the results start to become comparable, although QUAD still has the edge in accuracy. The new and popular technique introduced by Figlewski's group at NYU [2, 19], the adaptive mesh model (AMM), bears comparison. This improves lattice and grid methods by setting up more concentrated areas of lattice in areas of greater importance for errors, such as at payoff and on barriers. Another way of thinking of this is as a heavy pruning dense lattices everywhere except in the areas of the greatest importance. Levels of AMM calculation (not explained here) are expressed as AMM1, AMM2, and so on. As an example, for moving barrier options (on a Pentium III), AMM8 with 80 time steps between observations gives root-mean-squared errors of 0.00034 and takes an average time of 8.65 s, and extrapolated QUAD achieves better accuracy in 0.28 s.
  </p>
  <h4>
   <b>
    Acknowledgments
   </b>
  </h4>
  <p block-type="Text">
   I thank Dr Hannu Hark ¨ onen for his mathematical insights ¨ into FFT-QUAD and CONV-QUAD.
  </p>
  <h4>
   <b>
    References
   </b>
  </h4>
  <p block-type="ListGroup" class="has-continuation">
   <ul>
    <li block-type="ListItem">
     [1] Abramowitz, M. &amp; Stegun, I.A. (1965).
     <i>
      Handbook of Mathematical Functions
     </i>
     , Dover, New York.
    </li>
    <li block-type="ListItem">
     [2] Ahn, D.-G., Figlewski, S. &amp; Gao, B. (1999). Pricing discrete barrier options with an adaptive mesh model,
     <i>
      Journal of Derivatives
     </i>
     <b>
      6
     </b>
     , 33–44.
    </li>
    <li block-type="ListItem">
     [3] Andricopoulos, A.D. (2003).
     <i>
      Option Valuation Using Quadrature and other Numerical Methods
     </i>
     . PhD thesis, Manchester University, UK.
    </li>
    <li block-type="ListItem">
     [4] Andricopoulos, A.D., Widdicks, M., Duck, P.W. &amp; Newton, D.P. (2003). Universal option valuation using quadrature methods,
     <i>
      Journal of Financial Economics
     </i>
     <b>
      67
     </b>
     , 447–471. See also Corrigendum, (2004).
     <i>
      Journal of Financial Economics
     </i>
     ,
     <b>
      73
     </b>
     , 603.
    </li>
    <li block-type="ListItem">
     [5] Andricopoulos, A.D., Widdicks, M., Newton, D.P. &amp; Duck, P.W. (2007). Extending quadrature methods to value multi-asset and complex path dependent options,
     <i>
      Journal of Financial Economics
     </i>
     <b>
      83
     </b>
     , 471–499.
    </li>
   </ul>
  </p>
  <p block-type="ListGroup" class="has-continuation">
   <ul>
    <li block-type="ListItem">
     [6] Black, F. &amp; Scholes, M. (1973). The pricing of options and corporate liabilities,
     <i>
      Journal of Political Economy
     </i>
     <b>
      81
     </b>
     , 637–659.
    </li>
    <li block-type="ListItem">
     [7] Boyle, P.P. (1977). Options: a Monte Carlo approach,
     <i>
      Journal of Financial Economics
     </i>
     <b>
      4
     </b>
     , 323–338.
    </li>
    <li block-type="ListItem">
     [8] Brennan, M.J. &amp; Schwartz, E.S. (1977). Convertible bonds: valuation and optimal strategies for call and conversion,
     <i>
      Journal of Finance
     </i>
     <b>
      32
     </b>
     , 1699–1715.
    </li>
    <li block-type="ListItem">
     [9] Broadie, M. &amp; Detemple, J. (1996). American option valuation: new bounds, approximations, and a comparison of existing methods,
     <i>
      Review of Financial Studies
     </i>
     <b>
      9
     </b>
     , 1211–1250.
    </li>
    <li block-type="ListItem">
     [10] Broadie, M. &amp; Glasserman, P. (2004). A stochastic mesh method for pricing high-dimensional American options,
     <i>
      Journal of Computational Finance
     </i>
     <b>
      7
     </b>
     , 35–72.
    </li>
    <li block-type="ListItem">
     [11] Broadie, M. &amp; Yamamoto, Y. (2003). Application of the fast Gauss transform to option pricing,
     <i>
      Management Science
     </i>
     <b>
      49
     </b>
     , 1071–1088.
    </li>
    <li block-type="ListItem">
     [12] Broadie, M. &amp; Yamamoto, Y. (2005). A doubleexponential fast Gauss transform algorithm for pricing discrete path-dependent options,
     <i>
      Operations Research
     </i>
     <b>
      53
     </b>
     , 764–779.
    </li>
    <li block-type="ListItem">
     [13] Broni-Mensah, E.K., Duck, P.W. &amp; Newton, D.P. (2008).
     <i>
      A Simple and Generic Methodology to Suppress Non-linearity Error in Multi-Dimensional Option Pricing
     </i>
     . working paper.
    </li>
    <li block-type="ListItem">
     [14] Cheuk, T.H.F. &amp; Vorst, T.C.F. (1996). Complex barrier options,
     <i>
      Journal of Derivatives
     </i>
     <b>
      4
     </b>
     , 8–22.
    </li>
    <li block-type="ListItem">
     [15] Cheuk, T.H.F. &amp; Vorst, T.C.F. (1997). Currency lookback options and observation frequency: a binomial approach,
     <i>
      Journal of International Money and Finance
     </i>
     <b>
      16
     </b>
     , 173–187.
    </li>
    <li block-type="ListItem">
     [16] Chung, S.L., Ko, K. &amp; Shackleton, M.B. (2005).
     <i>
      Toward Option Values of Near Machine Precision using Gaussian Quadrature
     </i>
     . working paper.
    </li>
    <li block-type="ListItem">
     [17] Cox, J.C., Ingersoll, J.E. &amp; Ross, S.A. (1985). A theory of the term structure of interest rates,
     <i>
      Econometrica
     </i>
     <b>
      53
     </b>
     , 385–408.
    </li>
    <li block-type="ListItem">
     [18] Cox, J.C., Ross, S.A. &amp; Rubinstein, M. (1979). Option pricing: a simplified approach,
     <i>
      Journal of Financial Economics
     </i>
     <b>
      7
     </b>
     , 229–264.
    </li>
    <li block-type="ListItem">
     [19] Figlewski, S. &amp; Gao, B. (1999). The adaptive mesh model: a new approach to efficient option pricing,
     <i>
      Journal of Financial Economics
     </i>
     <b>
      53
     </b>
     , 313–351.
    </li>
    <li block-type="ListItem">
     [20] Geske, R. &amp; Johnson, H.E. (1984). The American put valued analytically,
     <i>
      Journal of Finance
     </i>
     <b>
      39
     </b>
     , 1511–1524.
    </li>
    <li block-type="ListItem">
     [21] Greengard, L. &amp; Strain, J. (1991). The fast Gauss transform,
     <i>
      SIAM Journal on Scientific and Statistical Computing
     </i>
     <b>
      12
     </b>
     , 79–94.
    </li>
    <li block-type="ListItem">
     [22] Hark ¨ onen, H.J. &amp; Newton, D.P. (2009). ¨
     <i>
      Completing the Universality of Option Valuation using Quadrature Methods
     </i>
     . working paper.
    </li>
    <li block-type="ListItem">
     [23] Heap, J. (2008).
     <i>
      Enhanced Techniques For Complex Interest Rate Derivatives
     </i>
     . Ph.D. thesis, Manchester University, UK.
    </li>
   </ul>
  </p>
  <p block-type="ListGroup">
   <ul>
    <li block-type="ListItem">
     [24] Heston, S.L. (1993). A closed-form solution for options with stochastic volatility with applications to bond and currency options,
     <i>
      The Review of Financial Studies
     </i>
     <b>
      6
     </b>
     , 327–343.
    </li>
    <li block-type="ListItem">
     [25] Huang, J., Subrahmanyam, M. &amp; Yu, G. (1996). Pricing and hedging American options: a recursive integration approach,
     <i>
      Review of Financial Studies
     </i>
     <b>
      9
     </b>
     , 277–300.
    </li>
    <li block-type="ListItem">
     [26] Law, S.H. (2009).
     <i>
      On the Modelling, Design and Valuation of Commodity Derivatives
     </i>
     . Submitted Ph.D. thesis, Manchester University, UK.
    </li>
    <li block-type="ListItem">
     [27] Leisen, D.P.J. &amp; Reimer, M. (1996). Binomial models for option valuation: examining and improving convergence,
     <i>
      Applied Mathematical Finance
     </i>
     <b>
      3
     </b>
     , 319–346.
    </li>
    <li block-type="ListItem">
     [28] Longstaff, F.A. &amp; Schwartz, E.S. (2001). Valuing American options by simulation: a simple least-squares approach,
     <i>
      Review of Financial Studies
     </i>
     <b>
      14
     </b>
     , 113–147.
    </li>
    <li block-type="ListItem">
     [29] Lord, R., Fang, F., Bervoets, F. &amp; Oosterlee, K. (2007).
     <i>
      A Fast and Accurate FFT-Based Method for Pricing Early-Exercise Options Under Levy Processes
     </i>
     , http://ssrn.com/abstract=966046.
    </li>
    <li block-type="ListItem">
     [30] O'Sullivan, C. (2005).
     <i>
      Path Dependent Option Pricing under Levy Processes
     </i>
     , http://ssrn.com/abstract=673424.
    </li>
    <li block-type="ListItem">
     [31] Ritchken, P. (1995). On pricing barrier options,
     <i>
      Journal of Derivatives
     </i>
     <b>
      3
     </b>
     , 19–28.
    </li>
    <li block-type="ListItem">
     [32] Staunton, M. (2007). Convolution for Levy, ´
     <i>
      Wilmott Magazine
     </i>
     September, 62–63.
    </li>
    <li block-type="ListItem">
     [33] Sullivan, M.A. (2000). Valuing American put options using Gaussian quadrature,
     <i>
      Review of Financial Studies
     </i>
     <b>
      13
     </b>
     , 75–94.
    </li>
    <li block-type="ListItem">
     [34] Vasicek, O. (1977). An equilibrium characterization of the term structure,
     <i>
      Journal of Financial Economics
     </i>
     <b>
      5
     </b>
     , 177–188.
    </li>
    <li block-type="ListItem">
     [35] Widdicks, M. (2002).
     <i>
      Examination Extension and Creation of Methods for Pricing Options with Early Exercise Features
     </i>
     . PhD thesis, Manchester University, UK.
    </li>
    <li block-type="ListItem">
     [36] Widdicks, M., Andricopoulos, A.D., Newton, D.P. &amp; Duck, P.W. (2002). On the enhanced convergence of lattice methods for option pricing,
     <i>
      Journal of Futures Markets
     </i>
     <b>
      22
     </b>
     , 315–338.
    </li>
   </ul>
  </p>
  <h3>
   <b>
    Related Articles
   </b>
  </h3>
  <p block-type="Text">
   <b>
    Bermudan Options
   </b>
   ;
   <b>
    Finite Difference Methods for Barrier Options
   </b>
   ;
   <b>
    Finite Difference Methods for Early Exercise Options
   </b>
   ;
   <b>
    Fourier Methods in Options Pricing
   </b>
   ;
   <b>
    Fourier Transform
   </b>
   ;
   <b>
    Lattice Methods for Path-dependent Options
   </b>
   ;
   <b>
    Sparse Grids
   </b>
   .
  </p>
  <p block-type="Text">
   DAVID P. NEWTON
  </p>
 </body>
</html>
