# Forward-Backward **Stochastic Differential Equations (SDEs)**

A forward–backward stochastic differential equation (FBSDE) is a system of two Itô-type stochastic differential equations (SDEs) over  $[0, T]$  taking the following form:

$$\begin{cases}\n\mathrm{d}X_{t} = b(t, \omega, X_{t}, Y_{t}, Z_{t})\mathrm{d}t \\
+ \sigma(t, \omega, X_{t}, Y_{t}, Z_{t})\mathrm{d}W_{t}, \quad X_{0} = x; \\
\mathrm{d}Y_{t} = -f(t, \omega, X_{t}, Y_{t}, Z_{t})\mathrm{d}t + Z_{t}\mathrm{d}W_{t}, \\
Y_{T} = g(\omega, X_{T})\n\end{cases} \tag{1}$$

Here  $W$  is a standard Brownian motion defined on a complete probability space  $(\Omega, \mathcal{F}, P)$ , and  $\mathbf{F} \stackrel{\triangle}{=} \{\mathcal{F}_t\}_{0 \le t \le T}$  is the filtration generated by *W* augmented with all the null sets. The coefficients  $b, \sigma, f, g$  are progressively measurable;  $b, \sigma, f$  are Fadapted for fixed  $(x, y, z)$ ; and g is  $\mathcal{F}_T$ -measurable for fixed  $x$ . The first equation is forward because the initial value  $X_0$  is given, while the second one is backward because the terminal condition  $Y_T$  is given. The solution to FBSDE (1) consists of three **F**-adapted processes  $(X, Y, Z)$  that satisfy equation (1) for any  $t$ ,  $P$  almost surely (a.s.), and

$$\|(X, Y, Z)\|^2 \stackrel{\triangle}{=} E\Big\{\sup_{0 \le t \le T} \left[|X_t|^2 + |Y_t|^2\right] \\ + \int_0^T |Z_t|^2 dt\Big\} < \infty \tag{2}$$

BSDEs can be traced back to the 1973 paper by Bismut [7], where a linear BSDE is introduced as an adjoint equation for a stochastic control problem. Bensoussan [6] proved the well posedness of general linear BSDEs by using the martingale representation theorem. The general theory of nonlinear BSDEs, however, originated from the seminal work of Pardoux and Peng [37]. Their motivation was to study the general Pontryagin-type maximum principle for stochastic optimal controls; see, for example, [40]. Independent of the development of this theory, Duffie and Epstein [19, 20] proposed the concept of stochastic recursive utility, and it turns out that

BSDEs provide exactly the right mathematical tool for it.

Peng [41], and Pardoux and Peng [38], then studied *decoupled FBSDEs*, that is, b and  $\sigma$  do not depend on  $(y, z)$ . They discovered the deep relation between Markovian FBSDEs (i.e., FBSDEs with deterministic coefficients) and PDEs, via the so called nonlinear Feynman-Kac formula. Soon after that, people found that such FBSDEs had very natural applications in option pricing theory, and thus extended the Black-Scholes formula to a much more general framework. In particular, the solution triplet  $(X, Y, Z)$  can be interpreted as the underlying asset price, the option price, and the hedging portfolio, respectively. El Karoui et al. [22] further introduced reflected BSDEs, which are appropriate for pricing American options, again, in a general framework. See a survey paper [24] and the section Applications for such applications.

The theory of coupled FBSDEs was originally motivated by Black's consol rate conjecture. Antonelli [1] proved the first well-posedness result, when the time duration  $T$  is small. For arbitrary  $T$ , there are three typical approaches, each with its limit. The most famous one is the *four-step scheme*, proposed by Ma et al. [34]. On the basis of this scheme, Duffie et al. [21] confirmed Black's conjecture. The theory has also been applied to various areas, especially in finance and in stochastic control.

There have been numerous publications on the subject. We refer interested readers to the books [23, 35], and the references therein for the general theory and applications.

# **Decoupled FBSDEs**

Since b and  $\sigma$  do not depend on  $(y, z)$ , one can first solve the forward SDE and then the backward one. The main idea in [37] to solve BSDEs is to apply the Picard iteration, or equivalently, the contraction mapping theorem.

**Theorem 1** ([38]). Assume that b,  $\sigma$  do not depend on  $(y, z)$ ; that  $b, \sigma, f, g$  are uniformly Lipschitz continuous in  $(x, y, z)$ , uniformly on  $(\omega, t)$ ; and that

$$I_{0} \stackrel{\triangle}{=} E \Big\{ \int_{0}^{T} \Big[ |b(t,\cdot,0)|^{2} + |\sigma(t,\cdot,0)|^{2} + |f(t,\cdot,0,0,0)|^{2} \Big] dt + |g(\cdot,0)|^{2} \Big\} < \infty \ (3)$$

Then FBSDE (1) admits a unique solution  $(X, Y, Z)$ , and there exists a constant C, depending only on  $T$ , the dimensions, and the Lipschitz constant, such that  $||(X, Y, Z)||^2 \leq C \Big[|x_0|^2 + I_0\Big]$ .

When  $\dim(Y) = 1$ , we have the following comparison result for the BSDE. For  $i = 1, 2$ , assume  $(b, \sigma, f_i, g_i)$  satisfy the assumptions in Theorem 1 and let  $(X, Y^i, Z^i)$  denote the corresponding solutions to equation (1). If  $f^1 \le f^2$ ,  $g^1 \le g^2$ ,  $P$  a.s., for any  $(t, x, y, z)$ , then,  $Y_t^1 \le Y_t^2$ ,  $\forall t, P$  a.s.; see, for example, [24]. On the basis of this result, Lepeltier and San Martín [31] constructed solutions to BSDEs with non-Lipschitz coefficients. Moreover, Kobylanski [30] and Briand and Hu [10] proved the well posedness of BSDEs whose generator  $f$  has quadratic growth in Z. Such BSDEs are quite useful in practice.

When the coefficients are deterministic, the decoupled FBSDE  $(1)$  becomes

$$\begin{cases}\ndX_t = b(t, X_t)dt + \sigma(t, X_t)dW_t, & X_0 = x; \\
dY_t = -f(t, X_t, Y_t, Z_t)dt + Z_t dW_t, & (4) \\
Y_T = g(X_T)\n\end{cases}$$

In this case, the FBSDE is associated with the following system of parabolic PDEs:

$$\begin{cases}\n u_t^i + \frac{1}{2} \text{tr} \left[ u_{xx}^i \sigma \sigma^*(t, x) \right] + u_x^i b(t, x) \\
 + f^i(t, x, u, u_x \sigma(t, x)) = 0, \\
 i = 1, \cdots, m; \\
 u(T, x) = g(x)\n\end{cases} \tag{5}$$

**Theorem 2** ([38]). Assume b,  $\sigma$ , f, g satisfy all the conditions in Theorem 1.

(i) If PDE (5) has a classical solution  $u \in C^{1,2}$  $([0, T] \times \mathbb{R}^n)$ , then

$$Y_t = u(t, X_t), \quad Z_t = u_x \sigma(t, X_t) \quad (6)$$

(ii) In general, define

$$u(t,x) \stackrel{\triangle}{=} E\{Y_t | X_t = x\} \tag{7}$$

Then u is deterministic and  $Y_t = u(t, X_t)$ . Moreover, when  $m = 1$ , u is the unique viscosity solution to the PDE  $(5)$ .

In this case,  $X$  is a Markov process; then by equation (6) the solution  $(X, Y, Z)$  is Markovian. For this reason we call equation (4) a Markovian FBSDE. We note that in the Black-Scholes model, as we see in the section Applications, the PDE  $(5)$  is linear and one can solve for  $u$  explicitly. Then equation (6) in fact gives us the well known Black-Scholes formula. Moreover, the hedging portfolio  $Z_t \sigma^{-1}(t, X_t)$  is the sensitivity of the option price  $Y_t$  with respect to the underlying asset price  $X_t$ . This is exactly the idea of the  $\Delta$ -hedging. On the other hand, when f is linear in  $(y, z)$ , equation (7) actually is equivalent to the Feynman-Kac formula. In general, when  $m = 1$ , equation (7) provides a probabilistic representation for the viscosity solution to the PDE  $(5)$ , and thus is called a *nonlinear Feynman–Kac formula*. Such a type of representation formula is also available for  $u_x$  [36].

The link between FBSDEs and PDEs opens the door to efficient Monte Carlo methods for highdimensional PDEs and FBSDEs, and thus also for many financial problems. This approach can effectively overcome the curse of dimensionality; see, for example,  $[3-5, 8, 27, 45]$ , and  $[12]$ . There are also some numerical algorithms for non-Markovian BSDEs and coupled FBSDEs; see, for example, [2, 9, 18, 33], and [17].

## Coupled FBSDEs

The theory of coupled FBSDEs is much more complex and is far from complete. There are mainly three approaches for its well posedness, each with its limit. Since the precise statements of the results require complicated notation and technical conditions, we refer readers to the original research papers and focus only on the main ideas here.

Method 1 Contraction Mapping This method works very well for BSDEs and decoupled FBS-DEs. However, to ensure the constructed mapping is a contraction one, for coupled FBSDEs one has to assume some stronger conditions. The first wellposedness result was by Antonelli [1], which has been extended further by Pardoux and Tang [39]. Roughly speaking, besides the standard Lipschitz conditions,  $FBSDE$  (1) is well posed in one of the following three cases: (i) T is small and either  $\sigma_z$  or  $g_x$  is small; (ii)  $X$  is weakly coupled into the BSDE (i.e.,  $g_x$  and  $f_x$  are small) or  $(Y, Z)$  are weakly coupled into the FSDE (i.e.,  $b_y, b_z, \sigma_y, \sigma_z$  are small); or (iii) b is deeply decreasing in x (i.e.,  $[b(\cdot, x_1, \cdot) -$ 

 $b(\cdot, x_2, \cdot)][x_1 - x_2] \le -C|x_1 - x_2|^2$  for some large C) or  $f$  is deeply decreasing in  $y$ . Antonelli [1] also provides a counterexample to show that, under Lipschitz conditions only, equation  $(1)$  may have no solution.

**Method 2 Four-step Scheme** This is the most popular method for coupled FBSDEs with deterministic coefficients, proposed by Ma et al. [34]. The main idea is to use the close relationship between Markovian FBSDEs and PDEs, in the spirit of Theorem 2. Step 1 in [34] deals with the dependence of  $\sigma$  on z, which works only in very limited cases. The more interesting case is that  $\sigma$  does not depend on z. Then the other three steps read as follows:

Step 2. Solve the following PDE with  $u(T, x) =$  $g(x)$ : for  $i = 1, \cdots, m$ ,

$$u_{t}^{i} + \frac{1}{2} \text{tr} \left[ u_{xx}^{i} \sigma \sigma^{*}(t, x, u) \right]$$
  
+  $u_{x}^{i} b(t, x, u, u_{x} \sigma(t, x, u))$   
+  $f^{i}(t, x, u, u_{x} \sigma(t, x, u)) = 0$  (8)

*Step 3.* Solve the following FSDE:

$$X_t = x + \int_0^t b(s, X_s, u(s, X_s), u_x(s, X_s))$$
  
$$\times \sigma(s, X_s, u(s, X_s)))ds$$
  
$$+ \int_0^t \sigma(s, X_s, u(s, X_s))dW_s \qquad (9)$$

Step 4. Set

$$Y_t \stackrel{\triangle}{=} u(t, X_t), Z_t \stackrel{\triangle}{=} u_x(t, X_t)$$
$$\times \sigma(t, X_t, u(t, X_t)) \tag{10}$$

The main result in  $[34]$  is essentially the following theorem.

**Theorem 3** Assume (i)  $b, \sigma, f, g$  are deterministic, uniformly Lipschitz continuous in  $(x, y, z)$ , and  $\sigma$  does not depend on  $z$ ; (ii) PDE (8) has a classical solution u with bounded derivatives. Then FBSDE (1) has a unique solution.

This result has been improved by Delarue [16] and Zhang [46], by weakening the requirement on  $u$  to only uniform Lipschitz continuity in  $x$ . Delarue [16] assumes some sufficient conditions on the deterministic coefficients to ensure such Lipschitz continuity. In particular, one key condition is that the coefficient  $\sigma$  be uniformly nondegenerate. Zhang [46] allows the coefficients to be random and  $\sigma$  to be degenerate, but assumes all processes are one-dimensional along with some special compatibility condition on the coefficients, so that a similarly defined random field  $u(t, \omega, x)$  is uniformly Lipschitz continuous in  $x$ .

**Method 3 Method of Continuation** The idea is that, if an FBSDE is well-posed, then a new FBSDE with slightly modified coefficients is also well-posed. The problem is then to find sufficient conditions so that this modification procedure can go arbitrarily long. This method allows the coefficients to be random and  $\sigma$  to be degenerate. However, it requires some monotonicity conditions; see for example, [29, 42], and [43]. For example, [29] assumes that, for some constant  $\beta > 0$  and for any  $\theta_i = (x_i, y_i, z_i), i =$ 1, 2,

$$\begin{aligned} [b(t,\omega,\theta_1) - b(t,\omega,\theta_2)][y_1 - y_2] \\ + [\sigma(t,\omega,\theta_1) - \sigma(t,\omega,\theta_2)][z_1 - z_2] \\ - [f(t,\omega,\theta_1) - f(t,\omega,\theta_2)][x_1 - x_2] \\ \ge \beta[|x_1 - x_2|^2 + |y_1 - y_2|^2 \\ + |z_1 - z_2|^2] \end{aligned} \tag{11}$$

$$[g(\omega, x_1) - g(\omega, x_2)][x_1 - x_2]$$
  

$$\leq -\beta |x_1 - x_2|^2 \tag{12}$$

# Applications

We now present some typical applications of FBSDEs.

### 1. Option pricing and hedging

Let us consider the standard Black-Scholes model. The financial market consists of two underlying assets, a riskless one  $B_t$  and a risky one  $S_t$ . Assume an investor holds a portfolio  $(x_t, \pi_t)_{0 \le t \le T}$ , with its wealth  $V_t \stackrel{\triangle}{=} x_t B_t + \pi_t S_t$ . We say the portfolio is selffinancing if  $dV_t = x_t dB_t + \pi_t dS_t$ ; that is, the change

of the wealth is solely due to the change of the underlying assets' prices.

Now consider a European call option with terminal payoff  $g(S_T) \stackrel{\triangle}{=} (S_T - K)^+$ . We say a self-financing portfolio  $(x_t, \pi_t)$  is a perfect hedge of the option if  $V_T = g(S_T)$ . Under a no-arbitrage assumption,  $V_t$  is the unique fair option price at  $t$ . Let  $r$  denote the interest rate of B,  $\mu$  the appreciation rate, and  $\sigma$  the volatility of S. Then  $(S, V, \pi)$  satisfy the following linear FBSDE:

$$\begin{cases}\ndS_t = S_t[\mu dt + \sigma dW_t], \quad S_0 = s_0; \\
dV_t = [r(V_t - \pi_t S_t) + \mu \pi_t S_t] dt \\
+ \pi_t S_t \sigma dW_t, \quad V_T = g(S_T)\n\end{cases} \tag{13}$$

If the borrowing interest rate  $R$  is greater than the lending interesting rate  $r$ , then the drift term of dV<sub>t</sub> becomes  $r(V_t - \pi_t S_t)^+ - R(V_t - \pi_t S_t)^- +$  $\mu \pi_t S_t$ , and thus the BSDE becomes nonlinear. The coupled FBSDE gives a nice framework for the large investor problem, where the investment may affect the value of  $S_t$ . Assume  $dS_t = \mu(t, S_t, V_t, \pi_t)dt +$  $\sigma(t, S_t, V_t, \pi_t) dW_t$ . Then the system becomes coupled. We refer to [24] and [15] for more detailed exposure.

## 2. American option and reflected FBSDEs

Consider an American option with generator  $f$ , terminal payoff function  $g$ , and early exercise payoff  $L_t$ . Let X denote the underlying asset price, Y the option price, and  $Z\sigma^{-1}$  the hedging portfolio. Then the American option solves the following reflected FBSDE with an extra component  $K$ , which is continuous and increasing, with  $K_0 = 0$ :

$$\begin{cases}\ndX_t = b(t, \omega, X_t)dt + \sigma(t, \omega, X_t)dW_t, \\
X_0 = x_0; \\
dY_t = -f(t, \omega, X_t, Y_t, Z_t)dt \\
+ Z_t dW_t - dK_t, \quad Y_T = g(\omega, X_T); \\
Y_t \ge L_t; \quad [Y_t - L_t]dK_t = 0\n\end{cases} \tag{14}$$

Here  $K_T - K_t$  can be interpreted as the time value of the option. Moreover, the optimal exercise time is  $\tau \stackrel{\triangle}{=} \inf\{t \geq 0 : Y_t = L_t\} \wedge T$ . See [22] for more details.

In the Markovian case with  $L_t = h(t, X_t)$ , the RFBSDE (14) is associated with the following obstacle problem of PDE with  $u(T, x) = g(x)$ , in the spirit of Theorem 2:

$$\min\left(u - h(t, x), -u_t - \frac{1}{2}\text{tr}\left(u_{xx}\sigma\sigma^*(t, x)\right) - u_x b(t, x) - f(t, x, u, u_x\sigma)\right) = 0 \tag{15}$$

### 3. Some further extensions

The previous two models consider complete markets. El Karoui and Quenez [26] studied superhedging problems in incomplete markets. They have shown that the superhedging price of a contingent claim is the increasing limit of solutions of a sequence of BSDEs. Cvitanić et al. [14] also studied superhedging problems, but in the case that there is a constraint on the portfolio part  $Z$ . It turns out that the superhedging price is the minimum solution to an FBSDE with reflection/constraint on Z. Buckdahn and Hu [11] studied a similar problem, but using coupled FBSDE with reflections.

Another application is the zero-sum Dynkin game. The value process  $Y$  is the solution to a BSDE with double barriers of Y:  $L_t \leq Y_t \leq U_t$ . In this case, besides  $(Y, Z)$ , the solution consists of two increasing processes  $K^+$ ,  $K^-$  satisfying  $[Y_t - L_t]dK_t^+ = [U_t L_t]dK_t^- = 0$ , and an equilibrium of the game is a pair of stopping times:  $\tau_1^* \stackrel{\triangle}{=} \inf\{t: Y_t = L_t\} \land$  $T, \tau_2^* \stackrel{\triangle}{=} \inf\{t: Y_t = U_t\} \wedge T.$  The work in [13, 28] and  $[32]$  is along this line.

#### 4. Black's consol rate conjecture

Let *r* denote the short-rate process and  $Y_t \stackrel{\triangle}{=}$  $E_t\left\{\int_t^\infty \exp\left(-\int_t^s r_l dl\right) \mathrm{d}s\right\}$  be the consol price.

$$dr_t = \mu(r_t, Y_t)dt + \alpha(r_t, Y_t)dW_t \qquad (16)$$

for some deterministic functions  $\mu$ ,  $\alpha$ . The question is whether  $Y$  satisfies certain SDEs. Black conjectured that there exists a function A, depending on  $\mu$  and  $\alpha$ , such that  $dY_t = [r_t Y_t - 1]dt + A(r_t, Y_t)dW_t$ .

The conjecture is confirmed in [21] by using FBSDEs. Assume  $r$  is "hidden Markovian," that is,  $r_t = h(X_t)$  for some deterministic function h and some Markov process  $X$ . Consider the following

FBSDE over infinite horizon:

$$\begin{cases}\ndX_t = b(X_t, Y_t)dt + \sigma(X_t, Y_t)dW_t, \\
X_0 = x; \\
Y_t = [h(X_t)Y_t - 1]dt + Z_t dW_t, \\
Y_t \text{ is bounded a.s. uniformly in } t \in [0, \infty)\n\end{cases}$$

The above FBSDE is associated with the following elliptic PDE

$$\frac{1}{2}\sigma^{2}(x,u)u''(x) + b(x,u)u'(x) - h(x)u(x) + 1 = 0$$
(17)

Assume equation (17) has a bounded classical solution  $u$ . Then the Black's conjecture is true with  $A(x, y) = \sigma(x, y)u'(x).$ 

#### 5. Stochastic control

This is the original motivation to study BSDEs. The classical results in the literature assumed that the diffusion coefficient  $\sigma$  was independent of the control; then the problem was essentially parallel to a deterministic control problem. With the help of BSDEs, one can derive necessary conditions for stochastic control problems in a general framework. To illustrate the idea, we show a very simple example here. We refer readers to [7, 25, 40], and [44] for more details in this aspect.

Assume the state process is

$$X_t = x + \int_0^t \sigma(s, a_s) \mathrm{d}W_s \tag{18}$$

where a is the control in some admissible set  $\mathcal{A}$ . The goal is to find optimal  $a^*$  to maximize the utility (or minimize the cost)  $J(a) \stackrel{\triangle}{=} E\{g(X_T) + \int_0^T h(t, a_t) dt\};$ <br>that is, we want to find  $a^* \in \mathcal{A}$  such that  $J(a^*) \geq$  $J(a)$ , for all  $a \in \mathcal{A}$ .

Define an adjoint equation which is a BSDE:

$$Y_t = g'(X_T) - \int_t^T Z_s \mathrm{d}W_s \tag{19}$$

Then for any  $\Delta a$ , one can show that

$$\nabla J(a,\Delta a) \stackrel{\triangle}{=} \lim_{\varepsilon \to 0} \frac{1}{\varepsilon} [J(a+\varepsilon \Delta a) - J(a)]$$
  
$$= E \Big\{ \int_0^T [\sigma'(t,a_t) Z_t + h'(t,a_t)] \Delta a_t dt \Big\}$$

where  $\sigma'$ , h' are derivatives with respect to a. If  $a^*$  is optimal, then  $\nabla J(a^*, \Delta a) \leq 0$  for any  $\Delta a$ . As a necessary condition, we obtain the stochastic *maximum principle:* 

$$\sigma'(t, a_t^*) Z_t + h'(t, a_t^*) = 0 \tag{20}$$

Under certain technical conditions, we get  $a_t^* =$  $I(t, Z_t)$  for some deterministic function I. Plugging this into equations  $(18)$  and  $(19)$  we obtain a coupled FBSDE.

# References

- Antonelli, F. (1993). Backward-forward stochastic dif- $[1]$ ferential equations, The Annals of Applied Probability 3(3), 777–793.
- [2] Bally, V. (1997). Approximation scheme for solutions of BSDE, in Backward Stochastic Differential Equations (Paris 1995-1996), N. El Karoui & L. Mazliak, eds, Pitman Research Notes in Mathematics Series, Longman, Harlow, Paris, Vol. 364, pp. 177-191.
- [3] Bally, V. & Pagès, G. (2003). Error analysis of the quantization algorithm for obstacle problems, Stochastic Processes and their Applications 106, 1–40.
- [4] Bender, C. & Denk, R. (2007). A forward scheme for backward SDEs, Stochastic Processes and their Applications 117(12), 1793-1823.
- [5] Bender, C. & Zhang, J. (2008). Time discretization and Markovian iteration for coupled FBSDEs, The Annals of Applied Probability **18**(1), 143–177.
- Bensoussan, A. (1983). Stochastic maximum princi-[6] ple for distributed parameter systems, Journal of the Franklin Institute 315(5-6), 387-406.
- [7] Bismut, J.M. (1973). Théorie Probabiliste du Contrôle des Diffusions, Memoirs of the American Mathematical Society, Providence, Rhode Island, Vol. 176.
- [8] Bouchard, B. & Touzi, N. (2004). Discrete-time approximation and Monte-Carlo simulation of backward stochastic differential equations, Stochastic Processes and their Applications 111, 175-206.
- [9] Briand, P., Delyon, B. & Mémin, J. (2001). Donskertype theorem for BSDEs, *Electronics Communications* in Probability  $6$ , 1–14.
- [10] Briand, P. & Hu, Y. (2006). BSDE with quadratic growth and unbounded terminal value, Probability Theory and Related Fields **136**(4), 604–618.
- [11] Buckdahn, R. & Hu, Y. (1998). Hedging contingent claims for a large investor in an incomplete market, *Advances* in Applied Probability  $30(1),$ 239-255