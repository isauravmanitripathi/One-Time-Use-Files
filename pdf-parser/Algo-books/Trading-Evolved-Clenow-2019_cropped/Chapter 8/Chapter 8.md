# **Exchange Traded Funds**

Exchange traded funds, or ETFs, are one of those great finance ideas which were eventually turned into a way to sucker people out of their hard earned cash. Say what you will about bankers, but they are very impressive when it comes to finding creative ways of getting to your hard earned cash.

Many ETFs are great. But you shouldn't assume that some fund is great just because it's packaged as an ETF. Anybody can make an ETF out of almost anything. The term itself has become nearly meaningless.

Roughly speaking, ETFs can be divided into three buckets.

### **The Good**

The best ETFs are passive, low cost index trackers. Transparent, highly liquid instruments which do exactly what their name states. The best example would be the world's most liquid ETF: the SPY. This fund invests its assets as close to the S&P 500 index as possible, using a computerized method to ensure low cost and close tracking. When you buy something like the SPY, you know exactly what you get. You get the index, minus about 10 basis points per year in cost. That's a whole lot better than what the mutual fund industry can offer you.

Roughly 80 to 90% of all mutual funds fail to beat their benchmark. That's widely known these days, but for some reason people still invest in such funds. The primary reason is likely that the banks are advising their clients to buy their own overpriced and underperforming mutual funds. Rather than rolling your dice on a 10 to 20% probability of outperforming the index, you can just buy a low cost index tracker and know exactly what you get.

The SPY has at the moment about 225,000,000,000 dollars under management. Yes, that would be 225 billion bucks. Close to a quarter of a trillion. It's more than twice the size of the second largest ETF and has a very high trading volume. As far as ETFs go, it's really in a category by itself in terms of liquidity. I wish I could say that I get paid for peddling the SPY, since these guys are making more money than a medium sized European nation, but sadly I have yet to see any checks from them.

There are many other ETFs that operate according to the same principles and are highly liquid. These types of ETFs, the ones that passively track a clearly defined index at a low cost and narrow tracking error, are the primary target for systematic trading.

Such ETFs are easily found among those tracking major country indexes, sector indexes and even some bond indexes. The very liquid ones are usually possible to short, while the rest will be very hard to locate in any decent scale.

This is what ETFs were to begin with and that's what most people would associate the term with. What you need to be careful with though, is with ETFs that don't fit the index tracking low cost design.

# **The Bad**

Anybody can turn anything into an ETF. Think about that for a moment. The term does not mean anything except that it's a fund that can be bought and sold via some sort of exchange. It does not mean liquid, it does not mean low cost and it does not mean index tracking. It does not even mean that it must be transparent.

Some ETFs are extremely small and extremely illiquid. There are ETFs out there with assets of less than 5 million. In the ETF space, anything less than a billion is considered tiny. Anything under 100 million is just silly. If you trade anything that small, be very careful

with executions and don't trade too big.

Check the net asset value of an ETF before considering it, and check the daily trading volume. You want to make sure that you can easily go in and out of the fund. If your position is 10% or more of the average daily trading volume, you are far too exposed.

Another issue is that many of the instruments that we normally call ETFs, are not actually ETFs. They are ETNs, Exchange Traded Notes. It may sound close enough, but it's really not.

With an ETF, you theoretically own the underlying shares. The ETF holds a basket of securities for you. If the ETF provider blows up, you should be able to get your part of the underlying shares back. If you have a large enough position, usually 50,000 shares, you can actually ask for the shares at any time.

ETNs on the other hand are in effect structured products. They are debt instruments, where a company promises to pay you based on the performance of an underlying index. That index may be a stock market or it may be absolutely any sort of mathematical formula at all. You don't hold any actual claim to any underlying security, you just hold that promise. How the ETN provider hedges their side to be able to pay you is their business. If they go the way of the dodo, you are just out of luck. You won't be seeing that cash again.

If you think that it's an unlikely prospect for a large bank or financial service provider to take a sudden dirt nap and leave you out to dry, you probably were not around in the business in 2008. This has happened before and this will happen again. Be careful with ETNs.

Then there is the cost side. The term ETF by its very nature conjures an image of low cost and responsibility. But again, anyone can make anything into an ETF. And set their own terms. There is nothing stopping me from setting up a new ETF and charging a two percent management fee. It's probably not going to be an easy sell, but very much possible.

The ETN structure is common when it comes to commodity funds. With such funds, you need to look closely at what they actually are and what they actually do. For a standard index ETF, the fund can just buy the underlying. But you shouldn't expect that a crude oil fund will match the return of physical crude. Think about it. How would that happen? Would the provider go buy the barrels? And put where? How?

No, they would of course buy and roll oil futures. That means that if you want to understand your return profile for an oil ETN, you need to understand futures and the impact that term structure has over time. But you can't be sure that the vehicle will invest only in what its name would imply.

Take the USO for instance, which is really not a bad tracker. As of writing this, it has about 3 billion net assets and a pretty high daily turnover. This should be a great way to track oil, right? Well, that all depends on your definition of great and what you would expect.

A quick look at this fund tells us that they do indeed invest 100% in oil. As of writing this, the USO has exactly 100.0% exposure to March 2017 crude oil futures. Yes, the futures. Of course. As mentioned, they couldn't very well be expected to keep actual barrels of oil in the basement.

But their investments don't stop there. On top of the 100% in crude futures, there are a few more things in the portfolio. First there is 10.4% in Fidelity Institutional Government Portfolio, 7% in the equivalent Goldman product, another 7 in Morgan Stanley's money market product and so on. Why? Well, because they have plenty of free cash. The futures don't require much cash, so rather than keeping this under the mattress, any futures manager would make use of short term money market products to secure the money and hopefully get a small return on it.

This in itself is not really an issue. But I mention is so that you understand that these commodity ETF/ETN products are akin to

futures funds. They have little in common with index trackers.

The issue here is that retail investors might see the name and the description of such a fund, and expect to get a return similar to the underlying spot. That's not likely to happen. Readers familiar with futures and term structures already know why.

We are going to look closer at term structure later on in the futures section, so I won't go too deeply into that for the moment. What is important to understand is that futures are different than spot. The time factor of the futures instruments will over time create a very different return curve than the underlying. That's not the fault of the fund manager. That's reality. You could perhaps fault them for not making such things clearer to investors, but the effect itself is quite unavoidable.

The stated objective of the USO fund is this: "The fund seeks to reflect the performance of the spot price of West Texas Intermediate light, sweet crude oil delivered to Cushing, Oklahoma by investing in a mix of Oil Futures Contracts and Other Oil Interests". The fund was launched in April 2006. Let's see how that objective worked out for them since then.

![](_page_5_Figure_0.jpeg)

*Figure 9*‑*1 USO ETF vs. Spot Oil*

As the chart shows, the tracking is not exactly close. But that's as close as you will get. That does not mean that you should never trade a commodity ETF or ETN, but you do need to be aware of what you are actually buying. The name of a fund is not enough to tell you what is really going on inside it.

The easiest way to check how a fund compares to the underlying benchmark is to just pull up a chart. Since my hidden agenda with this book is to teach you some Python when you least expect it, I will throw a few lines of code at you.

First I checked the product page for the USO to verify which exact benchmark it uses. I then went about locating the data for this benchmark, the West Texas Intermediate, as well as the equivalent data series for the ETF. You should be able to find both for free online, but as free sources keep changing location or suddenly go premium, I took the liberty of storing this data on **[www.followingthetrend.com/trading-evolved/](http://www.followingthetrend.com/python-book/)** where you can

download it.

The next part is simple, if you paid attention in earlier chapters of this book.

```
import pandas as pd
import matplotlib.pyplot as plt
# Read data from csv
df = pd.read_csv('oil_etf_vs_spot.csv', index_col='Date', parse_dates=['Date'])
# Make new figure and set the size.
fig = plt.figure(figsize=(12, 8))
# The first subplot, planning for 3 plots high, 1 plot wide, this being the first.
ax = fig.add_subplot(111)
ax.set_title('Oil ETF vs. Spot')
ax.plot(df['WTI-West-Texas-Intermediate'], linestyle='-', label='Spot', linewidth=3.0,
color='black')
ax.plot(df['USO'], linestyle='--', label='ETF', linewidth=3.0, color = 'grey')
ax.legend()
```

This code assumes that you have downloaded the aforementioned data from my site, and put in the same folder as your Python code. If you got the data elsewhere, or store it elsewhere, just adapt your code to read the corresponding format and location. Executing this code should result in the same output as Figure 9‑1

While term structure of the futures market is a large factor at play here, another thing to watch out for it the cost. The SPY takes less than ten points, less than 0.1% management fee, but there are funds taking a percent or more. Many of those are active. The USO mentioned above has a total expense ratio, or TER of 0.74%.

I might be a little unfair to single out the USO here. It's really not that bad, as far as commodity ETFs go. Try the same comparison for other exchange traded commodity funds, and you will see that they are all the same, or sometimes noticeably worse.

Next we have active ETFs. Active funds are just what they sound like. Somebody is actually trading and making discretionary decisions. Most people would think it's not an ETF if it involves people sitting by the screens and doing manual trading, but it certainly

can be. As long as it's exchange traded. If the strategy is active, the risk picture changes dramatically. You can no longer be sure of what you actually get.

Sometimes there is little choice but to trade the bad ETFs. These are funds that you should be very careful with, but properly understood there may still some use cases for them. Just make really sure that you understand what you are trading.

#### **The Worst**

The final segment of ETFs are the really horrible ones. I would have called the category the ugly, but I'd hate to tarnish a great film with these junk products. The structured products, all dressed up to be sold to retail traders who have no idea what structured products are. The worst offenders are the leveraged and inverse ETFs.

The short ETFs are the most obvious traps. The ProsShares Short S&P500 (SH) for instance, which promises you the inverse performance of the S&P 500 index. In all fairness, it pretty much does. But not in the way that most would expect. The key to understanding these products, because they really are structured products, is that they have a daily rebalance. They are designed to produce approximately the inverse return on any single day. The only way to achieve that is a daily rebalance.

Whenever you deal with any sort of derivative, you always need to think in terms of hedging. If you know how to hedge a derivative, you know how to price it. If you understand that, you understand how the instrument works and what you can really expect.

The way to create an inverse ETF is by using futures or swaps. If the ETF has two billion in assets, which is about what the SH has, they need to put on a short exposure of two billion, using derivatives. This position is then rebalanced daily to ensure that the daily return of the ETF is inverse from the underlying market, any given day.

The effect of this is that you are short volatility. In options terminology, you thought you took a short delta position but ended up with a mostly short gamma position. But that probably sounds like Greek to most readers.

Try an example instead. Assume we have an index which keeps wobbling up and down in a range for a long time. In this example, the index will be moving up and down by exactly the same amount every day, resulting in no long term price progress at all. On the first day, it moves up 3 percent. The second day, it drops 2.91%, putting it back where it started. Now it keeps doing that for some time. One might think that a long ETF on this index, a short ETF and a double short ETF would all show a flat return over time as well. But that's far from reality.

Table 9.1 shows the effect on a short ETF and a double short ETF over just a few days of such back and forth price flips. After seven days, the underlying index is back at exactly 100, while the short ETF is down half a percent, and the double short is down one and a half.

|     |            |            |         |         | 2x      | 2x      |
|-----|------------|------------|---------|---------|---------|---------|
|     | Underlying | Underlying | Inverse | Inverse | Inverse | Inverse |
| Day | %          | NAV        | %       | NAV     | %       | NAV     |
| 1   | 0.00%      | 100        | 0.00%   | 100     | 0.00%   | 100     |
| 2   | 3.00%      | 103.00     | -3.00%  | 97.00   | -6.00%  | 94.00   |
| 3   | -2.91%     | 100.00     | 2.91%   | 99.83   | 5.83%   | 99.48   |
| 4   | 3.00%      | 103.00     | -3.00%  | 96.83   | -6.00%  | 93.51   |
| 5   | -2.91%     | 100.00     | 2.91%   | 99.65   | 5.83%   | 98.95   |
| 6   | 3.00%      | 103.00     | -3.00%  | 96.66   | -6.00%  | 93.02   |
| 7   | -2.91%     | 100.00     | 2.91%   | 99.48   | 5.83%   | 98.44   |

*Table 9.1 Effect of Short ETF*

The effect is even clearer in Figure 9‑2, where the same up and down of 3% per day is repeated 50 days in a row. As the short and double short ETFs are replicating inverse, or double inverse return on any single day, this is the inevitable mathematical effect. If you are long an inverse ETF, you do have an interest in the underlying moving down. But you have an even greater interest in low volatility.

Most of the code required to calculate and graph this phenomenon is already familiar to you from previous sections. I will show you the key parts, and what might be new first, and then put the entire code segment afterwards.

In this example, I wanted to show this phenomenon and how it develops over 50 days. Therefore, I start off by making a **DataFrame** with a numbered index, from zero to 49. Remember from earlier how we can get a range of numbers with the range( ) function.

```
df = pd.DataFrame(index=range(50))
```

Now let's create a new column for the daily percentage change of our theoretical underlying asset. As per Table 9.1, we want every second day to be +3% and every alternate to be -0.2913%, so create a net zero return over time. We find every second in the sample code below by checking the reminder if divided by two. Note how we use lo c again to locate the rows and columns we want to change.

```
# Set odd days to +3%
df.loc[df.index % 2 == 1,'underlying_return'] = 0.03
```

```
# Set even days to -2.913%
df.loc[df.index % 2 == 0,'underlying_return'] = -0.02913
```

Now that we have the daily percent return numbers, we can easily calculate the cumulative product. That is the performance over time, for the underlying, the inverse ETF and the double inverse ETF.

```
# Calculate cumulative series
df['underlying_price'] = (df['underlying_return'] + 1).cumprod()
```

```
# Inverse ETF
df['short_return'] = df['underlying_return'] * -1
df['double_short_return'] = df['underlying_return'] * -2
```

# Double Inverse df['short\_price'] = (df['short\_return'] + 1).cumprod() df['double\_short\_price'] = (df['double\_short\_return'] + 1).cumprod()

The rest of the code simply plots the graphs. Below you'll find the complete code used for this example.

%matplotlib inline import pandas as pd import matplotlib.pyplot as plt df = pd.DataFrame(index=range(50)) # Set odd days to +3% df.loc[df.index % 2 == 1,'underlying\_return'] = 0.03 # Set even days to -2.913% df.loc[df.index % 2 == 0,'underlying\_return'] = -0.02913 # Start at zero df.iloc[0].loc['underlying\_return'] = 0 # Calculate cumulative series df['underlying\_price'] = (df['underlying\_return'] + 1).cumprod() # Inverse ETF df['short\_return'] = df['underlying\_return'] \* -1 df['double\_short\_return'] = df['underlying\_return'] \* -2 # Double Inverse df['short\_price'] = (df['short\_return'] + 1).cumprod() df['double\_short\_price'] = (df['double\_short\_return'] + 1).cumprod() # Make new figure and set the size. fig = plt.figure(figsize=(12, 8)) # The first subplot, planning for 3 plots high, 1 plot wide, this being the first. ax = fig.add\_subplot(111) ax.set\_title('Short ETF Effect') ax.plot(df['underlying\_price'], linestyle='-', label='Spot', linewidth=3.0, color='black') ax.plot(df['short\_price'], linestyle='-', label='Inverse ETF', linewidth=3.0, color = 'grey') ax.plot(df['double\_short\_price'], linestyle='--', label='Double Inverse ETF', linewidth=3.0, color = 'grey') ax.legend()

The output from this code would look as Figure 9‑2. Once you understand this fairly simple mathematical example, you should understand the problem with inverse ETFs, and why you should

almost never trade them.

![](_page_11_Figure_1.jpeg)

*Figure 9*‑*2 Effect of Short ETF*

The obvious problem of course, is that when markets start falling, they also tend to get quite volatile. You may very well find that even during declining markets, the inverse ETFs often also lose value.

This is not an instrument for hedging. This is, at best, an instrument for very short term speculations. You should have a very good reason for ever holding an inverse ETF for more than a day.

The example above is highly theoretical, but you could easily test this on actual market data. You can download a data file from my site, www.followingthetrend.com/trading-evolved/, which contains price series for the index tracker SPY, the inverse ETF SH and the double inverse SDS, all with the same underlying S&P 500 Index.

If you are still unsure about short ETFs, download this data and compare performance from different starting points. Try starting in

different type of markets regime, and see what the effect was over weeks and months.

Here is a simple piece of code to read the data file you can find on my site, recalculate the series to the same starting value, and plot a comparison graph.

```
%matplotlib inline
import pandas as pd
import matplotlib.pyplot as plt
# Function for recalculating series with a common base
def rebased(ts):
  return ts / ts[0]
# Read data from csv
df = pd.read_csv('short_etfs.csv', index_col='Date', parse_dates=['Date'])
# Calculate all series starting from first value.
df = df.apply(rebased)
# Make new figure and set the size.
fig = plt.figure(figsize=(12, 8))
# The first subplot, planning for 3 plots high, 1 plot wide, this being the first.
ax = fig.add_subplot(111)
ax.set_title('Short ETF Effect')
ax.plot(df['SPY'], linestyle='-', label='SPY Index Tracker', linewidth=3.0, color='black')
ax.plot(df['SH'], linestyle='-', label='SH Short ETF', linewidth=3.0, color = 'grey')
ax.plot(df['SDS'], linestyle='--', label='SDS Double Inverse ETF', linewidth=2.0, color = 'grey')
ax.legend()
```

This should produce a graph like the one you see in Figure 9‑3. This is no longer a theoretical example. The performance you see in that figure shows the actual performance of the S&P index tracker and compared to the inverse and double inverse ETF. Yes, the inverse funds spike up during short term market distress, but as you can see, over the course of months and years, the index tracker can lose substantially, with the inverse funds losing at the same time.

Don't touch the inverse trackers unless you fully understand this behavior.

![](_page_13_Figure_0.jpeg)

*Figure 9*‑*3 Inverse S&P 500 ETFs*

## **Shorting Exchange Traded Funds**

Just because your backtester does not complain when you enter a simulated short sell, don't go assuming that it would be possible in reality.

The most liquid ETFs are generally possible to locate and short. With others, it's very slim pickings. Building algorithmic trading models that short ETFs is a dangerous thing. It looks so easy in the backtester. Just enter the order, and there you go.

In reality, a safe assumption is that apart from the really enormously liquid ETFs, you won't be able to short. At least not at the time when you want to short. And of course, even if you get that lucky, the shares are likely to be recalled at the worst possible time.

Shorting is more complicated than it looks on the screens. It's easy to forget at times, since modern trading looks increasingly like a computer game, but there is actually something real happening behind the scenes.

When you short a stock or ETF, someone is actually lending it to you. This is important to understand. Your transaction does not happen in a vacuum. Understanding the mechanics behind shorting is the key to understanding what is realistic and what is not.

In most simulation platforms, you can short anything in any scale at zero cost. This is very far from reality.

First your broker needs to locate the shares. This means that they need to have another client who is happy to hold those shares long term and is willing to lend them for shorting. This usually means an institution who has a long term holding and wants to make a little extra on the side on the lending. You did not think you would get to borrow the shares for free, did you?

Borrowing major ETFs and stocks is usually no problem, even in decent scale. But if you want to short ETFs beyond the very top, massively liquid ones, you will likely find it quite difficult to locate them. Even if you do find them, they might be expensive.

Shorting the SPY is easy. It's just ridiculously liquid and extremely widely owned. You can borrow it reliably and at good rates. But if you want to short something more exotic, like a natural gas ETF for instance, you will either find that there are no lenders available or that you will have to pay so much that it won't be worth it.

The lenders will need to be compensated. They are not lending you the shares because they are such kind human beings. That's rarely how finance works. You will be paying the equivalent of an interest rate on them. How high that is will depend on how difficult the share is to borrow and how important you are to your broker. If you plan to hold your shorts over days, or even weeks and months, this cost can add up and make a serious dent in your strategy. It's a factor that's

very easy to forget about, and one that can potentially kill your strategy returns.

Another often forgotten part about short selling is that the shares can be called back at any time. Yes, even if your strategy is sound, the rug can be pulled from beneath your feet without notice.

It's fair to assume that as a short seller, you are at your most happy when stocks are falling hard. And that also happens to be when the lender of the shares is feeling the most pain. So when is he likely to call back the shares?

You just can't model this factor. There is no historical data on when stocks are recalled, and you can't predict how that might develop in the future. Consider what is going on at the other side of the table, and how they might think. Don't assume that you can short something whenever you like, however you like, and hold for as long as you like. That's not how it works.

This can be easily forgotten when building trading models. Almost all backtesting software will let you short anything at any time, with no funding costs or regards for availability. It can be extremely difficult to properly model the short side of ETFs, or stocks for that matter.